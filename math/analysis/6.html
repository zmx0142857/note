<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <title>ä¸å®šç§¯åˆ†</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" type="text/css" href="../../css/note.css" />
</head>
<body>

<p class="example">
    <b>å€’ä»£æ¢</b>
    ä»¤ `t = 1/x`. äºæ˜¯
    <span class="formula">
        `x t = 1` `rArr x dt + t dx = 0` `rArr dt/t = -dx/x`.
    </span>
</p>

<ol class="example">
	<b>Euler ä»£æ¢</b>
	è®¾ `R(x, y)` æ˜¯æœ‰ç†å‡½æ•°, å¯¹äº `R(x, sqrt(a x^2+b x+c))` çš„ä¸å®šç§¯åˆ†:
	<li><b>Euler ç¬¬ä¸€ä»£æ¢</b>è‹¥ `a gt 0`, ä»¤ `sqrt(a x^2+b x+c) = t + sqrt
		a x` æˆ– `t - sqrt a x`;
	</li>
	<li><b>Euler ç¬¬äºŒä»£æ¢</b>è‹¥ `c gt 0`, ä»¤ `sqrt(a x^2+b x+c)
		= x t + sqrt c` æˆ– `x t - sqrt c`;
	</li>
	<li><b>Euler ç¬¬ä¸‰ä»£æ¢</b>è‹¥ `Delta = b^2-4a c gt 0`, è®¾ `a x^2+b x+c`
		çš„ä¸¤å®æ ¹ä¸º `alpha, beta`, ä½œæ¢å…ƒ `sqrt(a x^2+b x+c) = t(x-alpha)`
		æˆ– `t(x-beta)`;
	</li>
	å°±å¯å°†è¢«ç§¯å‡½æ•°æœ‰ç†åŒ–.
</ol>

<h2>æ— ç†å‡½æ•°ç§¯åˆ†</h2>

<p class="example">`I = int sqrt(a^2 - x^2) dx`.</p>

<p class="solution">
	ä¸€ç§æ–¹æ³•æ˜¯æ˜¯ä½œä¸‰è§’ä»£æ¢ `x = a sin t`.
	ä¹Ÿå¯ä»¥å°†åŸå¼æ‹†å¼€, ç¬¬ä¸€é¡¹åšåˆ†å­æœ‰ç†åŒ–, ç¬¬äºŒé¡¹åˆ†éƒ¨ç§¯åˆ†:
	<span class="formula">
		`I = 1/2 int sqrt(a^2 - x^2) dx
			+ 1/2 int sqrt(a^2 - x^2) dx`
		`= ( 1/2 int (a^2 text(d)x) / sqrt(a^2-x^2)
			- 1/2 int (x^2 text(d)x) / sqrt(a^2-x^2) )`
			`+ ( 1/2 x sqrt(a^2 - x^2)
			+ 1/2 int (x^2 text(d)x)/sqrt(a^2 - x^2) )`
		`= a^2/2 arcsin{:x/a:} + x/2 sqrt(a^2 - x^2) + C`.
	</span>
	è¿™ä¸ªç§¯åˆ†çš„å‡ ä½•æ„ä¹‰æ˜¯, â€œä»å››åˆ†ä¹‹ä¸€åœ†ä¸­å‡å»åŠä¸ªå¼“å½¢,
	ä½™ä¸‹çš„é¢ç§¯ç­‰äºä¸€ä¸ªæ‰‡å½¢çš„é¢ç§¯åŠ ä¸€ä¸ªç›´è§’ä¸‰è§’å½¢çš„é¢ç§¯â€.  ç±»ä¼¼åœ°å¯ä»¥ç®—å‡º
	<span class="formula">
		` int sqrt(a^2+x^2) dx
		= a^2/2 ln (x + sqrt(a^2+x^2)) + x/2 sqrt(a^2+x^2) + C`.
	</span>
</p>

<p class="example">`int sqrt(1+x^4) / (x^3) dx`.</p>

<p class="solution">
	ä¾ç„¶æ˜¯åˆ†å­æœ‰ç†åŒ–.
	ä»¤ `t = x^2`, åˆ™ `dt = 2x dx`.
	åŸå¼ç­‰äº
	<span class="formula">
		` 1/2 int sqrt(1 + t^2)/t^2 dt
		= 1/2 int 1/(t^2 sqrt(1+t^2)) dt
		  + 1/2 int 1/sqrt(1+t^2) dt`.
	</span>
	ä»¤ `t = sinh u`, åˆ™ `dt = cosh u "d"u`,
	ä»è€Œç¬¬ä¸€é¡¹ç­‰äº
	<span class="formula">
		` 1/2 int ("d"u)/(sinh^2 u)
		= - cosh u/(2 sinh u) + C_1
		= -sqrt(1+t^2) / (2t) + C_1`.
	</span>
	ç¬¬äºŒé¡¹ç§¯åˆ†çš„ç»“æœæ˜¯ `1/2 ln (t + sqrt(1+t^2)) + C_2`.
	æ‰€ä»¥åŸå¼ç­‰äº
	<span class="formula">
		`1/2 ln (x^2 + sqrt(1+x^4)) - sqrt(1+x^4) / (2x^2) + C`.
	</span>
</p>

<p class="example">
	`int sqrt((a+x)/(a-x)) dx`.
</p>

<p class="solution">
	å¸¸è§„æ€è·¯æ˜¯ä½œä»£æ¢ `t = sqrt((a+x)/(a-x))` å°†è¢«ç§¯å‡½æ•°æœ‰ç†åŒ–, è®¡ç®—é‡è¾ƒå¤§.
	æ¯”è¾ƒç®€å•çš„åšæ³•æ˜¯
	<span class="formula">
		åŸå¼ `= int (a+x)/sqrt(a^2-x^2) dx`
		`= a arcsin {:x/a:} - sqrt(a^2-x^2) + C`.
	</span>
</p>

<h2>åˆ†éƒ¨ç§¯åˆ† (Integrate by part, IBP)</h2>

<p class="example">
	`int x^2 "e"^(3x) dx`.
</p>

<p class="solution">
	è¿ç»­ä½¿ç”¨åˆ†éƒ¨ç§¯åˆ†: ä¸åœåœ°å¾®åˆ†å¤šé¡¹å¼é¡¹, ç§¯åˆ†æŒ‡æ•°é¡¹, è€Œä¸”éš”é¡¹æ”¹å˜ç¬¦å·:
	<span class="formula">
		åŸå¼ `= (x^2) (1/3 "e"^(3x)) - (2x) (1/9"e"^(3x)) + (2)
		(1/27"e"^(3x)) + C`
		`= "e"^(3x)(1/3 x^2 - (2x)/9 + 2/27) + C`.
	</span>
</p>

<p class="example">
	`int x^n/(n!) "e"^x dx = "e"^x sum_(k=0)^n (-1)^(n-k) x^k/(k!) + C`.
</p>

<p class="solution">ç”¨åˆ†éƒ¨ç§¯åˆ†åŠå½’çº³æ³•è¯æ˜ä¹‹.</p>

<p class="example">
	`int x cos x dx`.
</p>

<p class="solution">
	è¿ç»­ä½¿ç”¨åˆ†éƒ¨ç§¯åˆ†: ä¸åœåœ°å¾®åˆ†å¤šé¡¹å¼é¡¹, ç§¯åˆ†ä¸‰è§’é¡¹, è€Œä¸”éš”é¡¹æ”¹å˜ç¬¦å·:
	<span class="formula">
		åŸå¼ `= (x) (sin x) - (1)(-cos x) + C`
		`= x sin x + cos x + C`.
	</span>
</p>

<p class="example">`int x^2 sin^3 x dx`.</p>

<p class="solution">
	(ç¹ç) åŸå¼ç­‰äº
	<span class="formula">
		` int x^2 sin x dx - int x^2 sin x cos^2 x dx`
		`= - int x^2 "d" cos x + 1/3 int x^2 "d" cos^3 x`
		`= - x^2 cos x + 2 int x cos x dx
			+ 1/3 x^2 cos^3 x - 2/3 int x cos^3 x dx`
		`= - x^2 cos x + 2 int x cos x dx + 1/3 x^2 cos^3 x
			- 2/3 int x cos x dx + 2/3 int x cos x sin^2 x dx`
		`= - x^2 cos x + 4/3 x sin x + 4/3 cos x + 1/3 x^2 cos^3 x
			+ 2/9 int x "d" sin^3 x`
		`= - x^2 cos x + 4/3 x sin x + 4/3 cos x + 1/3 x^2 cos^3 x
			+ 2/9 x sin^3 x - 2/9 int sin^3 x dx`.
	</span>
	å› ä¸º
	<span class="formula">
		`  int sin^3 x dx = int (cos^2 x - 1) "d" cos x`
		`= 1/3 cos^3 x - cos x + C`,
	</span>
	æ‰€ä»¥åŸå¼ç­‰äº
	<span class="formula">
		`- x^2 cos x + 4/3 x sin x + 14/9 cos x + 1/3 x^2 cos^3 x
		 + 2/9 x sin^3 x - 2/27 cos^3 x + C`.
	</span>
</p>

<p class="solution">
	(å…ˆå°†ä¸‰è§’å‡½æ•°åš Fourier å±•å¼€)
	<span class="formula">
		 åŸå¼ `= int x^2/4 (3 sin x - sin 3x) dx`
		 `= 3/4 (- x^2 cos x + 2x sin x + 2 cos x)`
		 `-1/4 (- x^2/3 cos 3x + (2x)/9 sin 3x + 2/27 cos 3x) + C`.
	</span>
</p>

<p class="example">
	`int x ln x dx`.
</p>

<p class="solution">
	è¿ç»­ä½¿ç”¨åˆ†éƒ¨ç§¯åˆ†, ä½†æ˜¯éœ€è¦å°å¿ƒåœ°å†™å‡ºæ¯ä¸€é¡¹:
	<span class="formula">
		åŸå¼ `= x^2/2 ln x - int x^2/2 "d" ln x`
		`= x^2/2 ln x - 1/2 int x dx`
		`= x^2/2 ln x - x^2/4 + C`.
	</span>
</p>

<p class="example">
	`int x arctan x dx`.
</p>

<p class="solution">
	è¿ç»­ä½¿ç”¨åˆ†éƒ¨ç§¯åˆ†, ä½†æ˜¯éœ€è¦å°å¿ƒåœ°å†™å‡ºæ¯ä¸€é¡¹:
	<span class="formula">
		åŸå¼ `= x^2/2 arctan x - int x^2/2 "d" arctan x`
		`= x^2/2 arctan x - 1/2 int (1+x^2-1)/(1+x^2) dx`
		`= x^2/2 arctan x - x/2 + 1/2 arctan x + C`.
	</span>
</p>

<p class="example">`I = int "e"^(ax) cos bx dx`.</p>

<p class="solution">
	åˆ†åˆ«å¯¹æŒ‡æ•°é¡¹å’Œä¸‰è§’é¡¹ä½¿ç”¨åˆ†éƒ¨ç§¯åˆ†ç„¶åç›¸æ¶ˆ:
	<span class="formula">
		` (a^2+b^2)I`
		`= a^2 int "e"^(ax) cos bx dx + b^2 int "e"^(ax) cos bx dx`
		`= a int cos bx "d" "e"^(ax) + b int "e"^(ax) "d" sin bx`
		`= a "e"^(ax) cos bx + ab int "e"^(ax) sin bx dx
			+ b "e"^(ax) sin bx - ab int "e"^(ax) sin bx dx`
		`= a "e"^(ax) cos bx + b "e"^(ax) sin bx + C_0`.
	</span>
	æ‰€ä»¥
	<span class="formula">
		`I = "e"^(ax)/(a^2+b^2) (a cos bx + b sin bx) + C`.
	</span>
</p>

<p class="solution">
	è®¡ç®—
	<span class="formula">
		`int "e"^((a+b"i")x) dx`
		`= "e"^((a+b"i")x)/(a+b"i") + C`
		`= (a-b"i")/(a^2+b^2) "e"^((a+b"i")x) + C`.
	</span>
	åˆ†åˆ«å–å®éƒ¨è™šéƒ¨å¾—åˆ°
	<span class="formula">
		`int "e"^(a x) cos b x dx`
		`= "e"^(a x)/(a^2+b^2) (a cos b x + b sin b x) + C`,<br/>
		`int "e"^(a x) sin b x dx`
		`= "e"^(a x)/(a^2+b^2) (a sin b x - b cos b x ) + C`.
	</span>
</p>

<p class="example" id="exp-int-sin-n-x">
	æ±‚ `I_n = int sin^n x dx`, `J_n = int cos^n x dx`
	çš„é€’æ¨å…¬å¼.
</p>

<p class="solution">
	`n in ZZ\\{0}` æ—¶,
	<span class="formula">
		`I_n = int sin^n x dx`
		`= -int sin^(n-1) x "d"(cos x)`
		`= -sin^(n-1) x cos x + (n-1)int cos^2 x sin^(n-2) x dx`
		`= -sin^(n-1) x cos x + (n-1)int (1-sin^2 x) sin^(n-2) x dx`
		`= -sin^(n-1) x cos x + (n-1) (I_(n-2) - I_n)`.
	</span>
	äºæ˜¯
	<span class="formula">
		`I_n = (n-1)/n I_(n-2) -1/n sin^(n-1) x cos x`.
	</span>
	å– `n = -n` å¾—
	<span class="formula">
		`I_(-n-2) = n/(n+1) I_(-n) - (cos x)/((n+1) sin^(n+1) x)`.
	</span>
	ç±»ä¼¼å¯å¾—
	<span class="formula">
		`J_n = (n-1)/n J_(n-2) + 1/n cos^(n-1) x sin x`,<br/>
		`J_(-n-2) = n/(n+1) J_(-n) + (sin x)/((n+1) cos^(n+1) x)`.
	</span>
	å…¶ä¸­
	<span class="formula">
		`I_0 = J_0 = x + C`,<br/>
		`I_1 = - cos x + C`, `quad J_1 = sin x + C`,<br/>
		`I_(-1) = ln|csc x - cot x| + C`,
		`quad J_(-1) = ln|sec x + tan x| + C`,<br/>
		`I_(-2) = - cot x + C`, `quad J_(-2) = tan x + C`.
	</span>
</p>

<p class="example" id="exp-possion-integral">
	æ±‚ `I_n = int "e"^(-x^2) x^n dx` çš„é€’æ¨å…¬å¼.
</p>

<p class="solution">
	<span class="formula">
		`I_1 = int "e"^(-x^2) x dx`
		`= 1/2 int "e"^(-x^2) "d"(x^2)`
		`= -1/2 "e"^(-x^2) + C`,
	</span>
	æ‰€ä»¥
	<span class="formula">
		`I_n = int x^(n-1) "d"(-1/2 "e"^(-x^2))`
		`= -1/2 "e"^(-x^2) x^(n-1) + (n-1)/2 int "e"^(-x^2) x^(n-2) dx`
		`= -1/2 "e"^(-x^2) x^(n-1) + (n-1)/2 I_(n-2)`.
	</span>
</p>


<h2>æœ‰ç†å‡½æ•°ç§¯åˆ†</h2>

<p class="example">`I = int x/(x+1)^3 dx`.</p>

<p class="solution">
	å¸¸è§„åšæ³•æ˜¯ä»¤ `t = x+1`, ä¹Ÿå¯ä»¥ç›´æ¥å°† `x+1` è§†ä¸ºæ•´ä½“:
	<span class="formula">
		`I = int (x+1)/(x+1)^3 dx - int (dx)/(x+1)^3`
		`= -1/(x+1) + 1/(2(x+1)^2) + C`.
	</span>
</p>

<ol class="example">
	<li>`I_n = int dx / (x^2 + a)^n`;</li>
	<li>`int dx / (ax^2 + b)^2`.</li>
</ol>

<ol class="solution">
	<li>
		<span class="formula">
			`I_(n-1) =	int dx / (x^2 + a)^(n-1)`
			`= x/(x^2+a)^(n-1) - int x "d"(x^2+a)^(1-n)`
			`= x/(x^2+a)^(n-1) + 2(n-1) int (x^2+a-a)/(x^2+a)^n dx`
			`= x/(x^2+a)^(n-1) + (2n-2)( I_(n-1) - a I_n )`.
		</span>
		æ•… `(2n-2)aI_n = x/(x^2+a)^(n-1) + (2n-3)I_(n-1)`.
	</li>
	<li>åœ¨ä¸Šé¢˜ä¸­å– `n = 2` å¾—
		<span class="formula">
			` (2b)/a int dx / (x^2 + b/a)^2
			= x/(x^2 + b/a) + int dx / (x^2 + b/a)`.
		</span>
		äºæ˜¯
		<span class="formula">
			` 2b int dx /(ax^2 + b)^2
			= x/(ax^2 + b) + int dx / (ax^2 + b)`.
		</span>
	</li>
</ol>

<p class="example">
  æ±‚ `int dx/(1+x+x^2)^2`.
</p>

<p class="solution">
  è®° `I_n = int x^n/(1+x+x^2)^2 dx`, äºæ˜¯
  <span class="formula">
    `I_0 + I_1 + I_2 = int dx/(1+x+x^2) := J`,<br/>
    `J = x/cdots + int (x(2x+1))/cdots^2 dx`
    `= x/cdots + I_1 + 2 I_2`,<br/>
    `2 I_1 + I_0 = int (2x+1)/cdots^2 dx := K`.
  </span>
  è§£å¾— `3 I_0 = 2J - K + (2x)/cdots`, å…¶ä¸­
  <span class="formula">
    `J = int dx/((x+1/2)^2 + 3/4)`
    `= 2/sqrt 3 arctan{:(2x+1)/sqrt 3:}`,
    `quad K = -1/cdots`.
  </span>
</p>

<p class="example">
    æ±‚ä¸å®šç§¯åˆ† `int dx/(1+x^n)`, å…¶ä¸­ `n = 3, 4, 5, 6`.
</p>

<ol class="solution">
    <li>`n = 3`, åŸå¼ç­‰äº
        <span class="formula">
            `1/3 int(1/(1+x) + (2-x)/(1-x+x^2)) dx`
            `= 1/3 int dx/(1+x) -1/6 int (2x-1)/(x^2-x+1) dx + 1/2 int
            dx/(x^2-x+1)`
            `= 1/6 ln |1+x|^2/|x^2-x+1| + 1/(sqrt3)
            arctan{:(2x-1)/(sqrt3):} + C`.
        </span>
    </li>
    <li>`n = 4`, åŸå¼ç­‰äº
        <span class="formula">
            `1/2 int (1+x^2)/(1+x^4) dx + 1/2 int (1-x^2)/(1+x^4) dx`
            `= 1/2 int (1+1/x^2)/(x^2+1/x^2) dx
            - 1/2 int (1-1/x^2)/(x^2+1/x^2) dx`
            `= 1/2 int ("d"(x-1/x))/((x-1/x)^2+2) dx
            - 1/2 int ("d"(x+1/x))/((x+1/x)^2-2) dx`
            `= 1/(2sqrt2) arctan{:(x-1/x)/2:}
            -1/(4sqrt2) ln|(x+1/x-sqrt2)/(x+1/x+sqrt2)| + C`.
        </span>
    </li>
    <li>`n = 6`, åŸå¼ç­‰äº
        <span class="formula">
            `1/3 int dx/(x^2+1) + 1/3 (2-x^2)/(x^4-x^2+1) dx`
            `= 1/3 arctan x
            + 1/3 * 1/2 int (1+x^2)/(x^4-x^2+1) dx
            + 1/3 * 3/2 int (1-x^2)/(x^4-x^2+1) dx`
            `= 1/3 arctan x + 1/6 arctan(x-1/x) - 1/(4sqrt3)
            ln |(x+1/x-sqrt3)/(x+1/x+sqrt3)| + C`,
        </span>
        å…¶ä¸­
        <span class="formula">
            `int (1+x^2)/(x^4-x^2+1) dx`
            `= int ("d"(x-1/x))/((x-1/x)^2+1) dx`
            `= arctan (x-1/x)`,<br/>
            `int (1-x^2)/(x^4-x^2+1) dx`
            `= -int ("d"(x+1/x))/((x+1/x)^2-3)`
            `= -1/(2sqrt3) ln |(x+1/x-sqrt3)/(x+1/x+sqrt3)| + C`.
        </span>
    </li>
    <li>`n = 5`, ç”¨è½¯ä»¶å¾—åˆ°ç­”æ¡ˆ
      <span class="formula">
        `1/5 ln(1+x)`
        `+ (sqrt5-1)/(sqrt5 sqrt(10-2sqrt5)) arctan{:(4x-1-sqrt5)/sqrt(10-2sqrt5):}`
        `+ (sqrt5+1)/(sqrt5 sqrt(10+2sqrt5)) arctan{:(4x-1+sqrt5)/sqrt(10+2sqrt5):}`
        `- (3+sqrt5)/(10(1+sqrt5)) ln(2x^2+2-(1+sqrt5)x)`
        `- (3-sqrt5)/(10(1-sqrt5)) ln(2x^2+2-(1-sqrt5)x) + C`.
      </span>
      ä»€ä¹ˆ, ä½ æƒ³æ‰‹ç®—? æˆ‘æ˜¯ä¸æƒ³ğŸ¥€.
    </li>
</ol>

<h3>éƒ¨åˆ†åˆ†å¼åˆ†è§£</h3>

<p class="example">
  åˆ†è§£ `(5x-4)/((x-2)(x+1)) = A/(x-2) + B/(x+1)`.
</p>

<p class="solution">
  è®¡ç®—åˆ†å­:
  <span class="formula">
    `5x-4 = (x+1)A + (x-2)B`.
  </span>
  å¸¸è§„åšæ³•æ˜¯æ¯”è¾ƒä¸Šå¼ä¸¤ç«¯å„æ¬¡é¡¹ç³»æ•°, å¾—å‡ºç›¸åº”çš„çº¿æ€§ä»£æ•°æ–¹ç¨‹ç»„.
  ç°åœ¨ä½¿ç”¨é›¶ç‚¹ä»£å…¥æ³•. åˆ†åˆ«ä»¤ `x = -1, 2`, ä»£å…¥ä¸Šå¼:
  <span class="formula">
    `-9 = -3B rArr B = 3`, `quad`
    `6 = 3A rArr A = 2`.
  </span>
  äº‹å®ä¸Šæˆ‘ä»¬å¾—åˆ°
  <span class="formula">
    `A = {:(5x-4)/(x+1)|_(x=2) = 2`,
    `quad B = {:(5x-4)/(x-2)|_(x=-1) = 3`.
  </span>
</p>

<p>	ä¸€èˆ¬åœ°, æˆ‘ä»¬æœ‰å¦‚ä¸‹å®šç†:</p>

<p class="theorem" id="the-rat-decom">
  è®¾ `p(x), q(x)` ä¸ºå¤šé¡¹å¼. è‹¥ `a` æ˜¯ `q(x)` çš„ `r` é‡æ ¹, è®¾
  `q(x) = (x-a)^r q_1(x)`, å…¶ä¸­ `q_1(a) != 0`.
  å®¹æ˜“çŸ¥é“å‡½æ•° `f(x) = p(x) // q_1(x)` åœ¨ `x = a` å¤„å…¨çº¯,
  å°†å®ƒåœ¨è¿™ä¸€ç‚¹ Taylor å±•å¼€å¾—
  <span class="formula">
    `f(x) = sum_(n ge 0) A_n (x-a)^n`,
    `quad A_n = (f^((n))(a))/(n!)`.
  </span>
  äºæ˜¯æœ‰ç†åˆ†å¼ `p(x) // q(x)` å…·æœ‰åˆ†è§£å¼
  <span class="formula">
    `(p(x))/(q(x)) = (f(x))/(x-a)^r`
    `= sum_(0 le n lt r) (f^((n))(a))/(n!)
    (x-a)^(n-r) + **/(q_1(x))`,
  </span>
  ç‰¹åˆ«å½“ `r = 1` æ—¶æœ‰
  <span class="formula">
    `(p(x))/(q(x)) = (f(a)) / (x-a) + **/(q_1(x))`.
  </span>
  `r = 2` æ—¶æœ‰
  <span class="formula">
    `(p(x))/(q(x)) = (f'(a)) / (x-a) + (f(a))/(x-a)^2 + **/(q_1(x))`.
  </span>
  å¦‚æœæç‚¹çš„é˜¶æ•°åœ¨ 2 é˜¶ä»¥ä¸Š (`r gt 2`)ï¼Œå»ºè®®ä½¿ç”¨å¹‚çº§æ•°é™¤æ³•è¿›è¡Œ Taylor
  å±•å¼€ï¼Œé¿å…è®¡ç®—å¤æ‚çš„é«˜é˜¶å¯¼æ•°.
</p>

<p class="example">
  åˆ†è§£ `(2x^2)/(x^2-1)^2 = A/(x+1) + B/(x+1)^2 + C/(x-1) + D/(x-1)^2`.
</p>

<p class="solution">
  å…ˆåœ¨ `x=-1` å¤„å±•å¼€,
  ä»¤ `f(x) = (2x^2)/(x-1)^2`, äºæ˜¯
  <span class="formula">
    `A = f'(-1)`
    `= {:(4x(x-1)^2 - 4(x-1)x^2)/(x-1)^4|_(x=-1) = -1/2`,
    `quad B = f(-1) = 1/2`.
  </span>
  å†è€ƒè™‘ `x=1` å¤„, ä»¤ `g(x) = (2x^2)/(x+1)^2`, æœ‰
  <span class="formula">
    `C = g'(1)`
    `= {:(4x(x+1)^2 - 4(x+1)x^2)/(x+1)^4|_(x=1) = 1/2`,
    `quad D = g(1) = 1/2`.
  </span>
</p>

<p class="example">
	åˆ†è§£ `16/((x+3)^3(x-1)) = A_0/(x+3)^3 + A_1/(x+3)^2 + A_2 /(x+3)
	+ B/(x-1)`.
</p>

<ol class="solution">
	æ˜“çŸ¥ `B = {:16/(x+3)^3|_(x=1) = 1/4`.
	ä¸ºäº†æ±‚å‡º `A_0, A_1, A_2`, åªéœ€è®¡ç®—å‡½æ•° `f(x) = 16//(x-1)` åœ¨ `x = -3`
	å¤„çš„ Taylor å±•å¼€. ä¸‹é¢ç”¨ä¸‰ç§æ–¹æ³•æ¥æ±‚.
	<li>å¹‚çº§æ•°é™¤æ³•.
		ä½œå˜æ¢ `y = x+3`, é—®é¢˜åŒ–ä¸ºæ±‚ `16//(y-4)` åœ¨åŸç‚¹çš„ Taylor å±•å¼€.
		åˆ—è¡¨ä½œé™¤æ³•, è¡¨æ ¼ç¬¬ä¸€åˆ—æ˜¯é™¤å¼çš„ `-4 + y` çš„å„æ¬¡é¡¹ç³»æ•°,
		ç¬¬ä¸€è¡Œæ˜¯å•† `-4 - y - y^2/4` çš„å„æ¬¡é¡¹ç³»æ•°.
		è¡¨ä¸­æ¯ä¸€å•å…ƒçš„æ•°æ˜¯ç¬¬ä¸€åˆ—ä¸ç¬¬ä¸€è¡Œä¸­ç›¸åº”æ•°å­—çš„ä¹˜ç§¯.
		<table>
			<tr>
				<td></td> <td>-4</td> <td>-1</td> <td>-1/4</td>
			</tr>
			<tr>
				<td>-4</td> <td>16</td> <td>4</td> <td>1</td>
			</tr>
			<tr>
				<td>1</td> <td>-4</td> <td>-1</td> <td></td>
			</tr>
		</table>
		ä½œé™¤æ³•æ—¶, åº”å½“ä¿è¯æ¯ä¸€å¯¹è§’çº¿ä¸Šæ•°å­—ä¹‹å’Œç­‰äºè¢«é™¤å¼ `16
		+ 0 y + 0 y^2` çš„ç›¸åº”ç³»æ•°:
		<span class="formula">
			`16 = 16`, `quad 4 + (-4) = 0`, `quad 1 + (-1) = 0`.
		</span>
		å› æ­¤, `A_0 = -4, A_1 = -1, A_2 = -1/4`.
	</li>
	<li>ç›´æ¥æ±‚ `n` é˜¶å¯¼æ•°:
		<span class="formula">
			`(f^((n))(x))/(n!) = -16/(1-x)^(n+1)`.
		</span>
		äºæ˜¯
		<span class="formula">
			`A_n = (f^((n))(-3))/(n!) = -16/4^(n+1) = -4^(1-n)`,
			`quad n = 0, 1, 2`.
		</span>
	</li>
	<li>åˆ©ç”¨å…¬å¼ `(1-t)^-1 = sum_(n ge 0) t^n`,
		<span class="formula">
			`f(x) = 16/(x-1)`
			`= 16/(x+3-4)`
			`= (-4)/(1-(x+3)/4)`
			`= -4 sum_(n ge 0) ((x+3)/4)^n`.
		</span>
		äºæ˜¯
		<span class="formula">
			`A_n = -4/4^n = -4^(1-n)`, `quad n = 0, 1, 2`.
		</span>
	</li>
</ol>

<p class="example">
    `1/(1+-x^n)` åœ¨ `CC` ä¸Šçš„çš„æœ‰ç†åˆ†å¼åˆ†è§£ä¸º
    <span class="formula">
        `1/(1+-x^n) = -1/n sum_r r/(x-r)`,
    </span>
    å…¶ä¸­ `r` å–éåˆ†æ¯çš„ `n` ä¸ªæ ¹.
    å› æ­¤ `int dx/(1+-x^n) = -1/n sum_r r ln (x-r) + C`.
</p>

<p class="proof">
    åªè¯ `1//(1+x^n)` çš„æƒ…å½¢.
    è®° `omega = "e"^(pi"i"//n)`, åˆ™ `omega^n = -1`,
    ä¸” `x^n+1` çš„ `n` ä¸ªæ ¹ä¸º
    <span class="formula">
        `r_k = omega^(2k+1)`, `quad k = 0, 1, cdots, n-1`.
    </span>
    ç”±<a class="ref" href="#the-rat-decom"></a>,
    <span class="formula">
        `1/(1+x^n) = sum_(0 le k lt n) A_k/(x-r_k)`,
    </span>
    å…¶ä¸­
    <span class="formula">
        `A_k = prod_(0 le j lt n; j != k) (r_k-r_j)^-1`
        `= prod (omega^(2k+1) - omega^(2j+1))^-1`
        `= omega^((2k+1) (1-n)) prod (1-omega^(2(j-k)))^-1`
        `= -omega^(2k+1) prod_(0 lt j lt n) (1-omega^(2j))^-1`
        `= -r_k/n`.
    </span>
    æœ€åä¸€æ­¥åˆ©ç”¨äº†æ’ç­‰å¼ `prod_s (1-s) = n`, å…¶ä¸­ `s` å–é `x^n-1` é™¤äº†
    1 ä»¥å¤–çš„æ‰€æœ‰æ ¹.
</p>

<p class="theorem">
  <b>å¥¥æ–¯ç‰¹æ´›æ ¼æ‹‰å¾·æ–¯åŸºå®šç† (å¥¥æ°å®šç†)</b>
  [æ¥è‡ª <a href="https://zhuanlan.zhihu.com/p/238073746">çŒæˆ·åº§ã®æ•°å­¦</a>]
  è®¾ `p(x)//q(x)` ä¸ºå®ç³»æ•°æœ‰ç†çœŸåˆ†å¼, åˆ™
  <span class="formula">
    `int (p(x))/(q(x)) dx`
    `= (p_1(x))/(q_1(x)) + int (p_2(x))/(q_2(x)) dx`,
  </span>
  å…¶ä¸­ `q_1 = gcd(q, q')`, `q = q_1 q_2`. å› æ­¤ `q_2` çš„å› å¼å‡ä¸ºä¸€é‡. ä¾‹å¦‚
  `x-a` æ˜¯ `q` çš„ `m` é‡å› å¼, åˆ™å®ƒåœ¨ `q_1`
  çš„é‡æ•°ä¸º `m-1`, åœ¨ `q_2` çš„é‡æ•°ä¸º `1`.
  ç­‰å·å³è¾¹ç¬¬ä¸€é¡¹ç§°ä¸ºç§¯åˆ† `int p(x)//q(x) dx` çš„<b>æœ‰ç†éƒ¨åˆ†</b>,
  ç¬¬äºŒé¡¹ä»ä¸ºæœ‰ç†çœŸåˆ†å¼çš„ç§¯åˆ†, å®ƒæ˜¯è¶…è¶Šå‡½æ•°, ç§°ä¸º<b>è¶…è¶Šéƒ¨åˆ†</b>.
</p>

<p class="proof">
  è€ƒè™‘ `p(x)//q(x)` çš„éƒ¨åˆ†åˆ†å¼åˆ†è§£:
  <span class="formula">
    `(p(x))/(q(x))`
    `= sum_j sum_k a_(j k)/(x-x_j)^k`
    `+ sum_j sum_k (b_(j k) x + c_(j k))/(x^2+p_(j k) x + q_(j k))^k`.
  </span>
  å¦‚æœåˆ†æ¯å‡ä¸ºä¸€é‡å› å¼, åˆ™
  <span class="formula">
    `int dx/(x-x_j) = ln|x-x_j| + C`,<br>
    `int (b x + c)/(x^2 + p x + q) dx`
    `= b/2 ln (x^2 + p x + q) + (2c-p b)/sqrt(4q-p^2) arctan{:(2x+p)/sqrt(4q-p^2):} + C`
  </span>
  å‡ä¸ºè¶…è¶Šå‡½æ•°.
  åä¹‹è‹¥åˆ†æ¯çš„é‡æ•° `k gt 1`, åˆ™
  <span class="formula">
    `int dx/(x-x_j)^k = 1/(1-k) 1/(x-x_j)^(k-1) + C`,<br>
    `int (b x + c)/(x^2 + p x + q)^k dx`
    `==^(u=x+p//2) b int (u "d"u)/(u^2 + a^2)^k`
    `+ (c - p b//2) int ("d"u)/(u^2+a^2)^k`.
    `= b/(2(1-k)) 1/(u^2+a^2)^(k-1)`
    `+ (c - p b//2) I_k`.
  </span>
  å…¶ä¸­
  <span class="formula">
    `I_k = int ("d"u)/(u^2+a^2)^k`,<br>
    `I_(k+1) = 1/(2k a^2) u/(u^2+a^2)^k + (2k-1)/(2k a) I_k`.
  </span>
  äºæ˜¯ `I_k = R_1(x) + A_k I_1`, å…¶ä¸­ `R_1(x)` ä¸ºæœ‰ç†å‡½æ•°, `A_k` æ˜¯å¸¸æ•°,
  `I_1 = int ("d"u)/(u^2+a^2)` æ˜¯è¶…è¶Šå‡½æ•°.
  ç»¼ä¸ŠçŸ¥ `int p(x)//q(x) dx` çš„è¶…è¶Šéƒ¨åˆ†, åˆ†æ¯çš„é‡æ•°å‡ä¸º 1.
  è€Œä¸”, æœ‰ç†éƒ¨åˆ†çš„åˆ†æ¯, å…¶é‡æ•°æ¯”ç§¯åˆ†å‰é™ä½äº†ä¸€æ¬¡ (ä» `k` æ¬¡å˜æˆ `k-1` æ¬¡).
  å°†æœ‰ç†éƒ¨åˆ†å’Œè¶…è¶Šéƒ¨åˆ†åˆ†åˆ«é€šåˆ†, å¯çŸ¥å¥¥æ°å…¬å¼æˆç«‹, ä¸”æœ‰ `q = q_1 q_2`.
</p>

<p class="remark">
  ç”±äº `q_1 = gcd(q, q')`, å¯è®° `q' = q_1 h`.
  å¯¹å¥¥æ°å…¬å¼å³è¾¹çš„æœ‰ç†éƒ¨åˆ†æ±‚å¯¼å¾—
  <span class="formula">
    `"d"/dx p_1/q_1`
    `= "d"/dx (p_1 q_2)/q`
    `= ((p_1 q_2)' q - q' p_1 q_2)/q^2`
    `= ((p_1 q_2)' - h p_1 q_2)/q`.
  </span>
  äºæ˜¯åˆ†æ¯ä¸º `q`, è€Œä¸æ˜¯æ¯” `q` æ¬¡æ•°é«˜çš„å¤šé¡¹å¼, å’Œç§¯åˆ†å‰çš„å‡½æ•° `p//q` ç›¸ç¬¦.
</p>

<p class="example">
  æ±‚ `int (x dx)/((x-1)^2(x+1)^3)`
</p>

<p class="solution">
  å¾…å®šç³»æ•°
  <span class="formula">
    `x/((x-1)^2(x+1)^3) = ((A x^2+B x+C)/((x-1)(x+1)^2))' + (D x+E)/((x-1)(x+1))`,
  </span>
  ç­‰å·å³è¾¹çš„ä¸¤é¡¹ä¸­, ç¬¬ä¸€é¡¹å·²ç»åœ¨ç§¯åˆ†å·å¤–, ç¬¬äºŒé¡¹çš„ç§¯åˆ†ç›¸æ¯”åŸå¼å·²ç»å¤§å¤§ç®€åŒ–.
</p>

<h3>ä¸‰è§’/æŒ‡æ•°å‡½æ•°çš„æœ‰ç†å¼</h3>

<p class="example">
	`int R("e"^x) dx`, `R` ä¸ºæœ‰ç†å‡½æ•°.
</p>

<p class="solution">
	ä»¤ `t = "e"^x`, åˆ™ `x = ln t`, `dx = dt/t`.
	<span class="formula">
		åŸå¼ `= int (R(t))/t dt`.
	</span>
</p>

<p class="example">
	`int R(tan x) dx`, `R` ä¸ºæœ‰ç†å‡½æ•°.
</p>

<p class="solution">
	ä»¤ `t = tan x`, åˆ™ `x = arctan t`, `dx = dt/(1+t^2)`.
	<span class="formula">
		åŸå¼ `= int (R(t))/(1+t^2) dt`.
	</span>
</p>

<p class="example">
	`int P(sin x, cos x) dx`, `P` ä¸ºå¤šé¡¹å¼.
</p>

<p class="solution">
	å‚çœ‹ <a href="../misc/2.html" target="_blank">Chebyshev å¤šé¡¹å¼çš„åå‘è¡¨ç¤º</a>.
	å°† `P(sin x, cos x)` åš Fourier å±•å¼€, å†ç§¯åˆ†.
	é€šé¡¹ `sin^m x cos^n x` å…ˆåˆ©ç”¨ `sin^k x cos^k x = ((sin 2x)/2)^k`
	å°†å…¶å±•å¼€, å†ç”±ç§¯åŒ–å’Œå·®å…¬å¼
	<span class="formula">
		`2 sin n x cos m x = sin(n+m)x + sin(n-m)x`,<br/>
		`2 cos n x cos m x = cos(n-m)x + cos(n+m)x`,<br/>
		`2 sin n x sin m x = cos(n-m)x - cos(n+m)x`.
	</span>
	æŠŠä¸¤ä¸ªå±•å¼ç›¸ä¹˜. ä¾‹å¦‚
  <span class="formula">
    `sin^4 x cos^7 x`
    `= ((sin 2x)/2)^4 cos^3 x`
    `= 1/128 (3 - 4 cos 4x + cos 8x) 1/4 (3 cos x + cos 3x)`
    `= 1/512 (9 cos x + 3 cos 3x - 6(cos 3x + cos 5x):}`
    `- 2(cos x + cos 7x) + 3/2(cos 7x + cos 9x)`
    `+ {:1/2(cos 5x + cos 11x))`
    `= 1/1024 (14 cos x -6 cos 3x -11 cos 5x:}`
    `- {:cos 7x + 3 cos 9x + cos 11x)`.
  </span>
</p>

<p class="example">
	`int R(sin x, cos x) dx`, `R` ä¸ºæœ‰ç†å‡½æ•°.
</p>

<p class="solution">
	(ä¸‡èƒ½ä»£æ¢) ä»¤ `t = tan{:x/2:}`, åˆ™ `x = 2 arctan t`, `dx = (2
	dt)/(1+t^2)`, `sin x = (2t)/(1+t^2)`, `tan x = (2t)/(1-t^2)`,
	`cos x = (sin x)/(tan x) = (1-t^2)/(1+t^2)`.
</p>

<h2>ä¸å…·æœ‰åˆç­‰åŸå‡½æ•°çš„å‡½æ•°</h2>

<ul>
	<li>(è§ Poission ç§¯åˆ†) `"e"^(-x^2)`;</li>
	<li>(è§ Dirichlet ç§¯åˆ†) `(sin x)/x`;</li>
	<li>`"e"^x/x`, `1/(ln x)`, `1/sqrt(1+x^4)`;</li>
	<li>æ¤­åœ†å‡½æ•° `sqrt(1-a^2 cos^2 x)`, `0 lt a lt 1`.</li>
</ul>

<script src="../../js/note.js?type=math"></script>
</body>
</html>

