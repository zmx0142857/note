<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <title>函数方程</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" type="text/css" href="../../css/note.css" />
</head>
<body>

<h2>线性函数</h2>

<p class="theorem">
  <b>线性函数 (正比例函数)</b>
  <span class="formula">
    `f(k x) = k f(x)`, `quad AA k, x in RR`
  </span>
  的解是 `f(x) = c x`, 其中 `c = f(1)`.
</p>

<p class="proof">
  令 `y = k x` 得 `f(y) = k f(x) = k x f(1) = y f(1)`.
</p>

<p class="corollary">
  <b>反比例函数</b>
  <span class="formula">
    `f(k x) = k^-1 f(x)`, `quad AA k, x != 0`
  </span>
  的解是 `f(x) = c/x`, 其中 `c = f(1)`.
</p>

<p class="proof">
  令 `g(x) = f(1/x)`, 则 `g(1/(k x)) = 1/k g(1/x)`.
  解得 `g` 为线性函数 `c x`, 因此 `f(x) = g(1/x) = c/x`.
</p>

<h2>Cauchy 方程</h2>

<p class="theorem">
	<b>Cauchy 方程</b>
	<span class="formula">
		`f(x+y) = f(x) + f(y)`.
	</span>
	满足此方程的函数称为<b>加性函数</b>.
	设 `f: RR to RR` 满足 Cauchy 方程, 则
	<span class="formula">
		`f(q x) = q f(x)`, `quad AA q in QQ`, `x in RR`.
		<span class="label" id="for-f(qx)=qf(x)"></span>
	</span>
	上式取 `x = 1` 知, Cauchy 方程在 `QQ` 上的解是线性函数 `f(x) = c x`,
	其中 `c = f(1)`.
</p>

<ol class="proof">
	<li>令 `x = y = 0` 得 `f(0) = 0`.
		再令 `y = -x` 得 `f` 是奇函数.
		因此我们只需证明
		<a class="ref" href="#for-f(qx)=qf(x)"></a> 式对 `q gt 0` 成立.
	</li>
	<li>先证 `f(n x) = n f(x)`, `n in ZZ^+, x in RR`.
		`n = 1` 时显然成立. 设结论对正整数 `n` 成立, 则
		<span class="formula">
			`f((n+1)x)`
			`= f(n x) + f(x)`
			`= n f(x) + f(x)`
			`= (n+1) f(x)`.
		</span>
		于是结论对所有正整数 `n` 成立.
	</li>
	<li>在 2 的结论中用 `x/n` 代替 `x`, 又得到 `f(x/n) = (f(x))/n`.
		设 `q = m/n`, `m, n` 是正整数, 则
		<span class="formula">
			`f(q x) = f(m x/n) = m f(x/n) = m/n f(x) = q f(x)`.
		</span>
	</li>
</ol>

<ol class="theorem">
  <b>`RR` 上的 Cauchy 方程</b>
	设 `f` 在 `RR` 上满足 Cauchy 方程, 但它不是线性函数 `y = c x`,
  则其图像 `{(x, f(x)}` 是 `RR^2` 的稠密子集. 反过来, 只要 `f`
  具有稍微好一点的性质, 如下面的任一条成立, 都能推出 `f` 为线性函数:
	<li>在某一点连续;</li>
	<li>在某一开区间上单调;</li>
	<li>在某一开区间上有上界或有下界.</li>
</ol>

<ol class="proof">
  <li>[来自 <a href="https://www.zhihu.com/question/61919178/answer/194142949" target="_blank">知乎</a>]
    由 `f` 不是线性函数知道, `bm u = (x, f(x))`,
    `bm v = (y, f(y))` 构成 `RR^2` 的基.
    从而平面上任意一点都可以被下面的点列逼近:
    <span class="formula">
      `p_i bm u + q_i bm v`
      `= (p_i x + q_i y, f(p_i x + q_i y))`,
      `quad p_i, q_i in QQ`.
    </span>
	</li>
  <li>反之, 由于单调函数除可数个点外处处连续,
    很容易找到一个使 `f` 连续的点;
    若 `f` 在某一点连续, 则 `f` 在这一点的某邻域上有界;
    若 `f` 在某个开区间上有上界或有下界,
    这蕴含 `f` 的图像不在 `RR^2` 上稠密.
  </li>
</ol>

<ol class="example">
	<b>Cauchy 方程的不连续解</b>
  <li>定义
    <span class="formula">
      `f: QQ(sqrt2) to QQ(sqrt2)`<br/>
      `a+b sqrt 2 |-> b+a sqrt 2`,
    </span>
    其中 `a, b` 是有理数.
    `f` 满足 Cauchy 方程, 但 `f(1) = sqrt 2`, `f(sqrt2) = 1`,
    因此 `f` 不是线性函数.
  </li>
  <li>将 `RR` 视为 `QQ` 上的线性空间, 如果承认选择公理, 则存在一个
    <b>Hamel 基</b> `H sube RR`, 满足对任意 `x in RR` 都存在正整数 `n` 和
    `x_1, cdots, x_n in H` 和 `k_1, cdots, k_n in QQ` 使得
    <span class="formula">
      `x = sum k_i x_i`.
    </span>
    任取 `h in H`, 将 `x in R` 按 Hamel 基展开后 `h` 的系数记为
    `f(x)`, 则 `f(x)` 是 Cauchy 方程的不连续解
    (注意连续函数的值域是 `RR` 上的区间, 而 `f(x)` 的值域 `sube QQ`.
    又 `f(x)` 不恒为零, 所以它的值域不是区间).
  </li>
</ol>

<ol class="example">
	设 `f` 是连续函数, 在 `RR` 上解函数方程
	<li>`f(x) f(y) = f(x+y)`;</li>
	<li>`f(x) f(y) = f(x y)`; 满足此方程的函数称为积性函数;</li>
	在 `RR^+` 上解函数方程
	<li>`f(x) + f(y) = f(x y)`;</li>
</ol>

<ol class="solution enum">
	<li>
	<ol>
	<li>`f(x) = f(x/2) f(x/2) ge 0` 是非负函数.</li>
	<li>若 `u` 是 `f` 的零点, 则
		对任意 `x in RR`, `f(x) = f(u + x - u)`
		`= f(u) f(x-u) = 0`, 即 `f(x) -= 0`.
	</li>
	<li>下设 `f` 无零点, 由 (1) 知 `f` 恒正.
		于是 `g(x) = ln f(x)` 适合 Cauchy 方程, 显然 `g` 也是连续函数,
		记 `f(1) = a`, 则 `g(1) = ln a`, 我们有 `g(x) = x ln a`, 于是
		<span class="formula">
			`f(x) = "e"^(g(x)) = "e"^(x ln a) = a^x`.
		</span>
		综上有 `f(x) = a^x`, `a = f(1) ge 0`.
	</li>
	</ol>
	</li>

	<li>
	<ol>
	<li>取 `y = 0` 得 `f(x) f(0) = f(0)`. 若 `f(0) != 0`, 则有
		`f(x) -= 1`.
	</li>
	<li>下设 `f(0) = 0`. 取 `y = 1` 得 `f(x) f(1) = f(x)`. 若 `f(1) != 1`,
		则有 `f(x) -= 0`.
	</li>
	<li>下设 `f(0) = 0`, 且 `f(1) = 1`, 我们来证 `0` 是 `f` 的唯一零点.
		否则设 `f(u) = 0`, `u != 0`, 则 `AA x in RR`,
		<span class="formula">
			`f(x) = f(x/u u) = f(x/u) f(u) = 0`,
		</span>
		与 `f(1) = 1` 矛盾.
	</li>
	<li>下证 `f(x^n) = f(x)^n`, `n` 是整数. `n = 1` 时显然成立.
		设结论对正整数 `n` 成立, 则
		<span class="formula">
			`f(x^(n+1)) = f(x^n) f(x) = f(x)^n f(x) = f(x)^(n+1)`.
		</span>
		故结论对所有正整数 `n` 成立. 又
		<span class="formula">
			`f(x^-1) f(x) = f(1) = 1`,
		</span>
		类似可证结论对所有负整数也成立.
	</li>
	<li>下证 `f(x^q) = f(x)^q`, `q in QQ`, `x in RR^+`.
		在 (2) 的结论中用 `root n x` 代替 `x`, 又得到 `f(root n x) = root
		n (f(x))`. 设 `q = m/n`, `m` 是整数, `n` 是正整数, 则
		<span class="formula">
			`f(x^q) = f((x^(1/n))^m) = f(x^(1/n))^m = f(x)^(m/n)
			= f(x)^q`.
		</span>
	</li>
	</ol>
	</li>

	<li>
	<ol>
	<li>取 `x = y = 1` 知 `f(1) = 0`. 令 `g(x) = "e"^(f(x))`, 则
		`g` 是积性函数.
	</li>
	</ol>
	</li>
</ol>

<p class="remark">
  假设 `f` 可微且 `f(x + y) = f(x) f(y)`, 可以这样导出它的微分方程:
  两边积分,
  <span class="formula">
    `int_0^1 f(x+y) dy = f(x) int_0^1 f(y) dy`,
  </span>
  对 `x` 求导,
  <span class="formula">
    `int_0^1 f'(x+y) dy = f'(x) int_0^1 f(y) dy`.
  </span>
  于是
  <span class="formula">
    `f'(x) = (f(x+1) - f(x))/(int_0^1 f(y) dy)`
    `= (f(1) - f(0))/(int_0^1 f(y) dy) f(x)`
    `= c f(x)`.
  </span>
</p>

<h2>函数迭代与不动点</h2>

<ol class="theorem">
  设 `f: RR to RR`,
  <li>若 `p` 是 `f @ f` 的不动点, 则它要么是 `f` 的不动点, 要么是 `f` 的周期 2 点.
    所谓周期 2 点是指存在 `x != y` 使得 `f(x) = y`, `f(y) = x`.
  </li>
  <li>
    若 `p` 是 `f @ f` 的唯一不动点, 则它也是 `f` 的唯一不动点.
  </li>
  <li>若 `p` 是 `f` 的不动点, `f` 可导, 则 `(f f)'(p) ge 0`.</li>
</ol>

<ol class="proof">
  <li>显然 `f` 的不动点必为 `f @ f` 的不动点. 现在设 `p` 不是 `f` 的不动点, 记 `q := f(p)`,
    则 `f(q) = f f(p) = p`, 即 `p`, `q` 是 `f` 的周期 2 点.
  </li>
  <li>
    由已知 `f f(p) = p`, 于是 `f f(f(p)) = f(f f(p)) = f(p)`,
    即 `f(p)` 也是 `f @ f` 的不动点. 由唯一性得 `f(p) = p`, 即 `p` 是 `f`
    的不动点. 又 `f` 的不动点必为 `f @ f` 的不动点, 所以 `p` 是 `f` 的唯一不动点.
  </li>
  <li>这是因为 `(f f)'(p) = f'(p) f'(f(p))`
    `= f'(p)^2`.
  </li>
</ol>

<ol class="example">
  <li>令 `f(x) = 1/(1-x)`, 则 `f^3(x) -= x`.  这个性质是由特征方程 `x^2 - x + 1 = 0` 决定的.</li>
  <li>设 `f(x) = x/(1+|x|)`, 则 `f^n(x) = x/(1+n|x|)`.</li>
  <li>`[1, x; 0, 1]^n = [1, n x; 0, 1]`.</li>
</ol>

<p class="example">
  [来自群友 Lavender]
  考虑 `RR to RR` 的函数方程 `f f(x) = -x^3 + x^2 + 1`.
  问: 是否存在处处可导的解? 是否存在处处连续的解?
</p>

<ol class="proof">
  两种情况都无解, 理由如下:
  <li>[来自 Lavender] 易知 `f f(1) = 1` 是 `f @ f` 的唯一不动点, 则它也是 `f` 的唯一不动点.
    由前述定理知 `(f f)'(1) ge 0`, 与下面的事实矛盾:
    <span class="formula">
      `(f f)'(1) = [-3x^2 + 2x]_(x=1) = -1`.
    </span>
  </li>
  <li>[来自 玩家喵] 注意到 `f f(x)` 在不动点附近严格单调减,
    所以在这一区间 `f(x)` 是单射:
    <span class="formula">
      `f(x) = f(y)`
      `rArr f f(x) = f f(y)`
      `rArr x = y`.
    </span>
    但 `f` 连续, 根据介值定理, 它在这一区间单调.
    不论它是单增还是单减, 复合函数 `f @ f` 必是单调增的, 矛盾.
  </li>
</ol>

<p class="example">
  [<a href="https://oeis.org/A003605" target="_blank">来自 OEIS</a>,
  British Mathematical Olympiad 1992, Problem 5]
  设 `f(1)`, `f(2)`, `f(3)...` 是一个严格单调递增的正整数列, 满足 `f(f(x)) = 3x`, 求 `f(1992)`.
</p>

<ol class="solution">
  观察:
  <li>
    若 `f` 有不动点 `p`, 则 `f f(p) = p`, 与已知 `f f(p) = 3 p` 矛盾;
    因此 `f` 没有不动点.
    又由 `f` 严格单增知道对任意 `x` 有 `f(x) ge x`, 但 `f` 没有不动点, 故
    <span class="box">`f(x) gt x`.</span>
  </li>
  <li><span class="box">`f(3x) = f f f(x) = 3 f(x)`.</span></li>
  <li>现在考虑 `f(1)` 的值.  由 1. 知道 `f(1) gt 1`,
    又 `3 = f(f(1)) gt f(1)`, 所以 `f(1) = 2`.
  </li>
  <li>由 2, `f(3) = 3 f(1) = 6`, 但 `f(f(2)) = 6`, 由于 `f` 是单射, 推出 `f(2) = 3`.
    继续计算
    <span class="formula">
      `1 to 2 to 3 to 6 to 9 to 18 ...`
    </span>
    容易看出
    <span class="formula">
      `f^(2n)(1) = 3^n`,
      `quad f^(2n+1)(1) = 2*3^n`.
    </span>
  </li>
  <li>
    下证公式
    <span class="formula">
      <span class="box">
      `f(3^k + j) = 2*3^k + j`,
      `quad k ge 0`,
      `quad 0 le j le 3^k`.
      </span>
    </span>
    其中 `j = 0` 和 `j = 3^k` 的情形已经成立, 即:
    <span class="formula">
      `f(3^k) = 2*3^k`,
      `quad f(2*3^k) = 3^(k+1)`.
    </span>
    注意两个等式中, 自变量的差值是 `3^k`, 函数值的差也是 `3^k`.
    然而 `f` 严格单调, 从而公式必须对任意 `0 le j le 3^k` 成立.
  </li>
  <li>
    由 5. 立即得到 `f(2*3^k + j)`
    `= f f(3^k+j)`
    `= 3^(k+1) + 3j`,
    于是 `f(1992) = f(2*3^6+534)`
    `= 3^7+3 xx 534 = 3789`.
  </li>
</p>

<script src="../../js/note.js?type=math"></script>
</body>
</html>
