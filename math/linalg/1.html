<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <title>矩阵</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" type="text/css" href="../../css/note.css" />
</head>
<body>

<h2>矩阵的定义及其运算</h2>

<h3>矩阵的线性运算, 矩阵的乘法</h3>

<!--
<p class="remark">
	一个记号. 设 `n` 为正整数, 记集合
	<span class="formula">
		`[n] = {1, 2, cdots, n}`.
	</span>
</p>
-->

<p class="definition">
	令 `bbb P` 为一数域, `bbb P` 上 `m` 行 `n` 列矩阵的全体记为 `bbb P^(m
	xx n)`, `bbb P` 称为矩阵的<b>基础数域</b>.
	如果 `m xx n` 矩阵 `bm A = (a_(i j))` 和 `bm B = (b_(i j))` 满足
	<span class="formula">
		`a_(i j) = b_(i j)`, `quad i = 1, cdots, m,` `quad j = 1, cdots, n`,
	</span>
	则称它们<b>相等</b>, 记为 `bm A = bm B`.
</p>

<ol class="definition">
	<b>矩阵的线性运算</b>
	设 `c in bbb P`, `bm A = (a_(i j))_(m xx n)`,
	`bm B = (b_(i j))_(m xx n)`.
	<li>数乘.
		定义 `c bm A := (c_(i j))_(m xx n)`, 其中
		<span class="formula">
			`c_(i j) = c a_(i j)`, `quad i = 1, cdots, m,` `quad j = 1, cdots, n`.
		</span>
		即矩阵与 `c` 数乘, 相当于把每一元素都乘以 `c`.
	</li>
	<li>加法.
		定义 `bm (A+B) := (s_(i j))_(m xx n)`, 其中
		<span class="formula">
			`s_(i j) = a_(i j) + b_(i j)`, `quad i = 1, cdots, m,` `quad j = 1, cdots, n`.
		</span>
		即两矩阵相加, 相当于把对应元素相加.
	</li>
</ol>

<p class="definition">
	<b>矩阵乘法</b>
	令 `bm A = (a_(i j))_(m xx r)`, `bm B = (b_(i j))_(r xx n)`.
	定义 `bm (A B) := (c_(i j))_(m xx n)`, 其中
	<span class="formula">
		`c_(i j) = sum_(k=1)^r a_(i k) b_(k j)`,
		`quad i = 1, cdots, m,` `quad j = 1, cdots, n`.
	</span>
	这一乘法法则称为 "左行乘右列", 即矩阵 `bm (A B)` 的 `i j` 元由
	`bm A` 的第 `i` 行与 `bm B` 的第 `j` 列作向量的一般内积得到:
  <span class="formula">
  `{:
    {::},
    [, b_(1 j), ;
     vdots, vdots, vdots;
     , b_(r j), ;
    ];
    [, cdots, ;
    a_(i 1), cdots, a_(i r);
    , cdots, ;
    ],
    [*, *, *;
     *, c_(i j), *;
     *, *, *;
    ]
  :}`
  </span>
</p>

<p class="remark">
	为何这样定义矩阵乘法呢, 考虑两个线性函数组
	<span class="formula">
    `y_k = sum_(j=1)^n b_(k j) x_j`, `quad k = 1, cdots, r`,<br>
		`z_i = sum_(k=1)^r a_(i k) y_k`, `quad i = 1, cdots, m`.
	</span>
  代入得
	<span class="formula">
		`z_i = sum_(k=1)^r a_(i k) sum_(j=1)^n b_(k j) x_j`
		`= sum_(j=1)^n x_j sum_(k=1)^r a_(i k) b_(k j)`
		`= sum_(j=1)^n c_(i j) x_j`.
	</span>
	从而, 矩阵乘法反映了线性函数组的复合.
</p>

<ol class="example">
	<li>元素全为零的矩阵称为<b>零矩阵</b>, 记为 `bm O`.
		矩阵加上零矩阵, 结果不变. 矩阵左乘或右乘零矩阵, 结果为零矩阵.
	</li>
	<li>矩阵 `bm A` 与 `-1` 数乘的结果记为 `-bm A`. 显然
		`bm A + (-bm A) = bm O`. 从而矩阵的减法定义为
		`bm (A-B) := bm A + (-bm B)`.
	</li>
	<li>`n xx n` 矩阵称为 `n` 阶<b>方阵</b>;
		矩阵的 `i = j` 的 `i j` 元组成它的<b>主对角线</b>:
		<span class="formula">
			`{a_(i j) | i = j}`.
		</span>
		`n` 阶方阵的 `i + j = n+1` 的 `i j` 元组成它的<b>副对角线</b>:
		<span class="formula">
			`{a_(i j) | i + j = n}`.
		</span>
	</li>
	<li>如果方阵的所有满足 `i lt j` 的 `i j` 元均为零,
		则称它为 `n` 阶<b>下三角矩阵</b>;
		如果方阵的所有满足 `i gt j` 的 `i j` 元均为零,
		则称它为 `n` 阶<b>上三角矩阵</b>;
		如果上 (下三角矩阵的主对角线元素全为 0, 则称它为<b>严格上 (下)
		三角矩阵</b>;
		如果上 (下) 三角矩阵的主对角线元素全为 1, 则称它为<b>单位上 (下)
		三角矩阵</b>.
		显然, (严格, 单位) 上 (下) 三角矩阵的乘积仍为 (严格, 单位) 上
		(下) 三角矩阵.
		如果我们只关心三角形矩阵的主对角元, 则上三角矩阵可以简记为
		<span class="formula">
			`bm U_(a_i)`
			`= bm U(a_1, a_2, cdots, a_r)`
			`= [
				a_1, , , **;
				, a_2, , ;
				, ,ddots, ;
				, , ,a_r;
			]`.
		</span>
		下三角矩阵类似记为 `bm L_(a_i)`.
	</li>
	<li>如果方阵的主对角线以外的元素均等于零, 即矩阵形如
		<span class="formula">
		`[
			d_1, , , ;
			,d_2, , ;
			, ,ddots, ;
			, , ,d_n;
		]`,
		</span>
		则称它为 `n` 阶<b>对角矩阵</b>, 记为 `"diag"(d_1, cdots, d_n)`
		或 `bm D_(d_k)`.
		对角矩阵既是上三角矩阵, 也是下三角矩阵;
		对角矩阵相乘, 结果还是对角矩阵.
		矩阵左乘 `bm D_(d_k)`, 相当于第 `i` 行每个元素都乘以 `d_i`;
		矩阵右乘 `bm D_(d_k)`, 相当于第 `j` 列每个元素都乘以 `d_j`.
	</li>
	<li>如果方阵的副对角线以外的元素均等于零, 即矩阵形如
		<span class="formula">
		`[
			, , ,d_1;
			, ,d_2, ;
			,&#8944;, , ;
			d_n, , , ;
		]`
		</span>
		则称它为 `n` 阶<b>副对角矩阵</b>.
		记 `bm K` 是副对角线元全为 1 的副对角矩阵, 则任意矩阵 `bm A`
		左乘 `bm K`, 结果是将 `bm A` 的各行倒序排列; 右乘 `bm K`,
		结果是将 `bm A` 的各列倒序排列.
	</li>
	<li>如果 `n` 阶对角阵的每个对角元都等于 `1`, 则称它为 `n`
		阶<b>单位矩阵</b>, 记为 `bm I_n` 或 `bm E_n`, 或者省略下标,
		简记为 `bm I` 或 `bm E`.
		如果引入 Kronecker `delta` 函数
		<span class="formula">
			`delta_(i j) = { 1, if i = j; 0, if i != j; :}`
		</span>
		则单位阵的 `i j` 元就是 `delta_(i j)`.
		矩阵左乘或右乘单位矩阵, 结果都不变.
	</li>
	<li>如果 `n` 阶对角阵的每个对角元都等于常数 `c`, 即矩阵等于 `c bm I`,
		则称它为 `n` 阶<b>数量矩阵</b>或<b>纯量矩阵</b>.
		矩阵左乘或右乘 `c bm I`, 结果相当于与 `c` 作数乘.
	</li>
</ol>

<ol class="property">
	假设下面各式中的加法与乘法都可以进行, 即矩阵具有合适的行, 列数.
	<li>加法交换律. `bm (A + B) = bm (B + A)`.</li>
	<li>加法结合律. `bm ((A+B)+C) = bm (A+(B+C))`.</li>
	<li>乘法结合律. `bm ((A B)C) = bm (A(B C))`.</li>
	<li>乘法对加法的分配律. `bm (A(B+C)) = bm (A B + A C)`,
		`bm ((B+C)A) = bm (B A + C A)`.
	</li>
	<li>数乘的穿越. `c(bm(A B)) = (c bm A)bm B = bm A(c bm B)`.</li>
	<li>数乘的结合律. `(c d)bm A = c(d bm A)`.</li>
	<li>数乘的单位元. `1 bm A = bm A`.</li>
	<li>数乘的分配律. `c(bm A + bm B) = c bm A + c bm B`,
		`(c + d)bm A = c bm A + d bm A`.
	</li>
</ol>

<p class="remark">
	矩阵乘法一般不成立交换律, 如 `bm A, bm B` 分别是 `m xx n`, `n xx m`
	矩阵, 则 `bm (A B)` 是 `m` 阶方阵, 而 `bm (B A)` 是 `n` 阶方阵,
	因此两个矩阵的乘法可交换的必要条件是 `m = n`.
	即使有 `m = n`, `bm (A B) = bm (B A)` 也未必成立. 令
	<span class="formula">
		`bm A = [1,0;0,0]`,
		`quad bm B = [0,1;0,0]`,
	</span>
	则 `bm (A B) = bm B`, `bm (B A) = bm O`.<br/>
	不过, 方阵与数量矩阵 (特别地, 单位阵, 零矩阵) 的乘法可以交换.
	两个对角矩阵的乘法可以交换 (事实上, 能与对角矩阵交换的只有对角矩阵).
	方阵与自身, 与其伴随矩阵 (第二章), 或者与其逆矩阵 (见下文)
	的乘法可以交换.
</p>

<h3>矩阵的转置</h3>

<p class="definition">
	令 `bm A = (a_(i j))_(m xx n)`, 定义 `bm A` 的<b>转置</b>
	`bm A^T (或 bm A') := (t_(i j))_(n xx m)`, 其中
	<span class="formula">
		`t_(i j) = a_(j i)`, `quad i in [n], j in [m]`.
	</span>
	矩阵的转置即 "行变列, 列变行". 形象地说, 转置就是将矩阵沿主对角线翻转.
</p>

<p class="example">
  令
  <span class="formula">
    `bm A :=  [
      不,怕,困,难;
      挑,战,困,难;
      战,胜,困,难;
    ]`,
  </span>
  则
  <span class="formula">
    `bm A^T = [
      不,挑,战;
      怕,战,胜;
      困,困,困;
      难,难,难;
    ]`.
  </span>
</p>

<ol class="property">
	<li>`(bm A^T)^T = bm A`.</li>
	<li>`(c bm A)^T = c bm A^T`.</li>
	<li>`(bm A + bm B)^T = bm A^T+ bm B^T`.</li>
	<li>`(bm (A B))^T = bm B^T bm A^T`.</li>
</ol>

<ol class="example">
	<li>(严格, 单位) 上, 下三角矩阵互为转置.</li>
	<li>如果方阵 `bm A` 满足 `bm A^T = bm A`, 则称它为<b>对称矩阵</b>;
		如果方阵 `bm A` 满足 `bm A^T = -bm A`, 则称它为<b>反对称矩阵</b>.
		如同任一函数可分解为偶函数与奇函数之和:
		<span class="formula">
			`f(x) = (f(x) + f(-x))/2 + (f(x) - f(-x))/2`,
		</span>
		任一方阵也可分解为对称矩阵与反对称矩阵之和:
		<span class="formula">
			`bm A = (bm A + bm A^T)/2 + (bm A - bm A^T)/2`.
		</span>
	</li>
	<li>把其他位置都为零, 而第 `j` 个下标处等于 `1` 的单位列向量记作
		<span class="formula">
			`bm epsi_j := (overbrace(0,cdots,0,1)^j ,0,cdots,0)^T`;
		</span>
		其他位置都为零, 而第 `i` 行 `j` 列处等于 `1` 的矩阵记作
		<span class="formula">
			`bm E_(i j) = (overbrace(bb 0,cdots,bb 0,bm epsi_i)^j,bb
			0,cdots, bb 0)`.
		</span>
		分别用 `bm alpha_i`, `bm A_j` 记矩阵 `bm A` 的第 `i` 行和第 `j`
		列, 有
		<span class="formula">
			`bm (A epsi)_j = bm A_j`,
			`quad bm epsi_i^T bm A = bm alpha_i`,
			<br/>
			`bm epsi_i^T bm epsi_j = delta_(i j)`,
			`quad bm epsi_j bm epsi_i^T = bm E_(i j)`.
		</span>
	</li>
</ol>

<h3>矩阵的逆</h3>

<p class="definition">
	令 `bm A, bm B` 是 `n` 阶方阵, 如果 `bm (A B) = bm I`, 则称 `bm A` 是
	`bm B` 的左逆, `bm B` 是 `bm A` 的右逆. 如果 `bm B` 同时是 `bm A`
	的左逆和右逆, 即 `bm (A B) = bm (B A) = bm I`, 则称 `bm B` 是 `bm A`
	的<b>逆矩阵</b>.
	如果 `bm A` 的逆矩阵存在, 则称它是<b>可逆</b>的.
	如果 `bm A` 可逆, 则它的逆矩阵必惟一, 记作 `bm A^-1`.
</p>

<p class="proof">
	设 `bm B, bm C` 都是 `bm A` 的逆. 则
	<span class="formula">
		`bm B = bm (B I) = bm (B(A C))`
		`= bm ((B A)C) = bm (I C) = bm C`.
	</span>
	因此逆矩阵必惟一.
</p>

<p class="remark">
	利用行列式的知识可以证明,
	如果 `bm A` 的左逆存在, 则它也是 `bm A` 的右逆, 反之亦然.
	因此只要 `bm (A B) = bm I`, 就可以断言 `bm A, bm B` 都可逆,
	且它们互逆.<br/>
	事实上, 由 `bm (A B) = bm I` 有 `|bm A||bm B| = 1`,
	从而 `|bm A| != 0`, 即 `bm A` 可逆. 记 `bm A` 的逆为 `bm A^-1`, 于是
	<span class="formula">
		`bm B = bm (I B) = bm (A^-1 A B)`
		`= bm (A^-1 I) = bm A^-1`.
	</span>
</p>

<ol class="property">
	设 `bm A`, `bm B` 是 `n` 阶可逆方阵. `c in bbb P`, `c != 0`,
	则下面各矩阵也可逆, 它们的逆写在等号右边.
	<li>`(bm A^-1)^-1 = bm A`.</li>
	<li>`(bm(A B))^-1 = bm B^-1 bm A^-1`.</li>
	<li>`(bm A^T)^-1 = (bm A^-1)^T`.</li>
	<li>`(c bm A)^-1 = c^-1 bm A^-1`.</li>
</ol>

<h2>矩阵的初等变换</h2>

<ol class="definition">
	规定矩阵的三种行初等变换:
	<li>将矩阵第 `i` 行的每个元素都乘以非零常数 `c`, 记作 `[i(c)]`;</li>
	<li>将矩阵第 `j` 行的 `k` 倍加到第 `i` 行上, 记作 `[i+j(k)]`;</li>
	<li>将矩阵第 `i`, `j` 行交换位置, 记作 `[i,j]`.</li>
	类似可规定三种列初等变换, 分别记为 `{i(c)}`, `{i+j(k)}`, `{i,j}`.<br/>
	将三种行 (列) 初等变换分别作用于 `n` 阶单位矩阵, 得到
	第一类初等矩阵:
	<span class="formula">
		`[bm I_(i-1), , ;
		  ,c, ;
		  , ,bm I_(n-i)]`
		  `= (epsi_1, cdots, epsi_(i-1), c epsi_i, epsi_(i+1), cdots,
		  epsi_n)`.
	</span>
	第二类初等矩阵:
	<span class="formula">
		`[bm I_(i-1), , , , ;
		  ,1,cdots,k, ;
		  , ,ddots,vdots, ;
		  , , ,1, ;
		  , , , ,bm I_(n-j)]`
		  `= (epsi_1, cdots, epsi_(j-1), k epsi_i + epsi_j, epsi_(j+1),
		  cdots, epsi_n)`.
	</span>
	和第三类初等矩阵:
	<span class="formula">
		`[bm I_(i-1), , , , ;
		  ,0,cdots,1, ;
		  ,vdots,bm I_(j-i-1),vdots, ;
		  ,1,cdots,0, ;
		  , , , ,bm I_(n-j)]`
		  `= (epsi_1, cdots, epsi_(i-1), epsi_j, epsi_(i+1), cdots,
		  epsi_(j-1), epsi_i, epsi_(j+1), cdots, epsi_n)`.
	</span>
	容易计算验证, 用第 `i` 类初等矩阵左 (右) 乘一矩阵 `bm A`,
	相当于对 `bm A` 施以第 `i` 类初等行 (列) 变换, `i = 1,2,3`.
	初等矩阵都是可逆的, 它们的逆分别是同一类的初等矩阵.
</ol>

<p class="example">
  每行每列恰有一个元素为 1, 其他元素为 0 的方阵称为<b>置换矩阵</b>,
  它表示 `[1..n]` 的一个置换.
  置换矩阵是若干个第三类初等矩阵的乘积.
</p>

<p class="definition">
	如果 `m xx n` 矩阵 `bm A` 可经有限次初等变换化为 `bm B`,
	则称 `bm A, bm B` <b>等价</b>, 记为 `bm A ~ bm B`.
	矩阵的等价是一种等价关系.
</p>

<p class="corollary">
	`m xx n` 阶矩阵 `bm A, bm B` 等价当且仅当存在 `m` 阶初等矩阵
	`{bm P_i}_(i=1)^s` 和 `n` 阶初等矩阵 `{bm Q_j}_(j=1)^t`, 使得
	<span class="formula">
		`bm B = bm P_s cdots bm P_2 bm P_1 bm A bm Q_1 bm Q_2 cdots bm
		Q_t`.
	</span>
</p>

<p class="theorem">
	任意 `m xx n` 矩阵等价于如下形状的矩阵
	<span class="formula">
		`bm overset ~ A = [bm I_r, bm O; bm O, bm O]_(m xx n)`,
	</span>
	称为 `bm A` 的<b>等价标准形</b>, 其中 `0 le r le min{m,n}`.
</p>

<p class="example">
	任意方阵可分解为一可逆矩阵与一对称矩阵的乘积.
</p>

<p class="proof">
	设 `bm A = bm(P overset ~ A Q)`, 其中 `bm P, bm Q` 可逆, `bm overset
	~A` 是 `bm A` 的等价标准形, 显然 `bm overset ~ A` 对称. 于是
	`bm A = bm (P(Q^T)^-1 Q^T overset ~ A Q)`, 其中 `bm(P(Q^T)^-1)` 可逆,
	`bm (Q^T overset ~ A Q)` 对称.
</p>

<h2>矩阵运算进阶</h2>

<h3>正交矩阵</h3>

<p class="definition">
	设 `bm A = (a_(i j))_(m xx n)`, 则 `bm bar A = (bar a_(i j))_(m
	xx n)` 称为 `bm A` 的<b>复共轭矩阵</b>, `bm A^H = bm bar A^T` 称为
	`bm A` 的<b>复共轭转置矩阵</b>. 复共轭转置是转置概念的推广.<br/>
	如果 `bm A in CC^(n xx n)`, `bm A^H = bm A`, 则称 `bm A` 是
	<b>Hermite 矩阵 (Hermitian matrix)</b>. Hermite
	矩阵是对称矩阵概念的推广.
</p>

<ol class="definition">
	<li>满足 `bm A^H bm A = bm A bm A^H` 的复方阵 `bm A`
		称为<b>正规矩阵</b>, 满足 `bm(A^T A) = bm(A A^T)` 的实方阵 `bm A`
		称为<b>实正规矩阵</b>.
	</li>
	<li>称满足 `bm(T^T T) = bm I` 的实方阵 `bm T`
		为<b>正交矩阵 (orthgonal matrix)</b>.
		正交矩阵的第 `i` 行与第 `j` 行的向量内积等于
		`delta_(i j)`.
	</li>
	<li>称满足 `bm U^H bm U = bm I` 的复方阵 `bm U` 为<b>酉矩阵</b>.
		酉矩阵是正交矩阵概念的推广.
	</li>
</ol>

<ol class="example">
	<li>
		<span class="formula">
			`[cos theta,-sin theta;sin theta,cos theta]`
		</span>
		是正交矩阵.
		用这个矩阵左乘一个平面向量, 结果恰好将该向量逆时针旋转 `theta` 角.
	</li>
	<li>对称矩阵
		<span class="formula">
			`bm A = [
				1,1,1,1;
				1,1,-1,-1;
				1,-1,1,-1;
				1,-1,-1,1;
			]`
		</span>
		满足 `bm A^2 = 4 bm I`, 因此 `1/2 bm A` 是正交矩阵.
	</li>
	<li>反对称矩阵
		<span class="formula">
			`bm B = [
				a,b,c,d;
				-b,a,-d,c;
				-c,d,a,-b;
				-d,-c,b,a;
			]`
		</span>
		满足 `bm(B^T B) = (a^2+b^2+c^2+d^2) bm I`, 因此
		`(a^2+b^2+c^2+d^2)^(-1/2) bm B` 是正交矩阵.
	</li>
	<li>设 `bm alpha` 是单位列向量, 满足 `bm(alpha^T alpha) = 1`,
		则 `bm I - 2 bm(alpha alpha^T)` 是对称的正交矩阵,
		称为 <b>Householder 矩阵</b>.
	</li>
</ol>

<h3>合同与相似</h3>

<ol class="definition">
  设 `bm A, bm B` 为方阵,
  <li>如果存在可逆矩阵 `bm T` 使得 `bm B = bm(T^T A T)`,
    则称矩阵 `bm A, bm B` <b>合同</b>或<b>相合</b>.
    合同是一等价关系.
    与对称矩阵合同的矩阵仍对称.
    称方阵 `bm A` <b>正定</b>, 如果它合同于单位矩阵 `bm I`.
    正定矩阵是对称的, 可逆的.
    我们将在<a href="9.html">二次型的章节</a>进一步讨论正定矩阵.
  </li>
  <li>如果存在可逆矩阵 `bm T` 使得 `bm B = bm(T^-1 A T)`,
    则称矩阵 `bm A, bm B` <b>相似</b>.
    相似是一等价关系.
    与数量矩阵 `c bm I` 相似的矩阵只有它自己,
    特别地, 与单位矩阵 (零矩阵) 相似的矩阵只有自己.
    若 `bm T` 是正交矩阵, 则称 `bm A, bm B` <b>正交相似</b>.
    正交相似的两个矩阵既合同, 又相似.
    我们将在<a href="7.html">第七章</a>单独讨论矩阵的相似标准形.
  </li>
  今后我们将花很大篇幅讨论矩阵的合同标准形和相似标准形, 力求将矩阵化为
  (分块) 对角形.
</ol>

<h3>方阵的迹</h3>

<p class="definition">
  设 `bm A = (a_(i j))_(n xx n)`, 定义 `bm A`
  的<b>迹</b>为它的主对角线上的元素之和, 记为
  <span class="formula">
    `"tr"bm A := sum_(i=1)^n a_(i i)`.
  </span>
  方阵的迹满足
  <span class="formula">
    `"tr"(c bm A) = c "tr"bm A`,
    `quad "tr"(bm(A+B)) = "tr"bm A + "tr" bm B`,<br/>
    `"tr"(bm A^T) = "tr"bm A`.
  </span>
  其中前两条指出, 方阵的迹是线性函数 (第五章).
  不论 `bm(A B)`, `bm(B A)` 是否可交换, 它们的迹总是相等
  (甚至当它们的尺寸不相等时也是如此):
  <span class="formula">
    `"tr"(bm (A B)) = "tr"(bm (B A)) = sum_(i j) a_(i j) b_(j i)`,<br>
    特别 `"tr"(bm(A^T A)) = sum_(i j) a_(i j)^2`.
  </span>
  任意 `n` 阶方阵可以写成一个迹为零的矩阵与一个数量矩阵之和:
  记 `1/n "tr" bm A = t`.
  <span class="formula">
    `bm A = (bm A - t bm I) + t bm I`.
  </span>
</p>

<p class="example">
	可以验证, `bm A^H bm A` 是 `n` 阶实对称矩阵,
	且 `"tr"(bm A^H bm A)` 等于 `bm A` 的每个元素的模的平方和, 即
	<span class="formula">
		`"tr"(bm A^H bm A) = sum_(i=1)^m sum_(j=1)^n |a_(i j)|^2`.
	</span>
	从而 `bm A = bm O` 当且仅当 `"tr"(bm A^H bm A) = 0`.
</p>

<h3>方阵的幂与多项式</h3>

<p class="definition">
	<b>方阵的幂</b>
	设 `bm A` 是方阵, `n` 为正整数, 则
	<span class="formula">
		`bm A^0 := bm I`, `quad bm A^n := bm (A A)^(n-1)`.
	</span>
	幂运算满足
	<span class="formula">
		`bm A^m bm A^n = bm A^(m+n)`,
		`quad (bm A^m)^n = bm A^(m n)`.
	</span>
	显然 `bm A^m`, `bm A^n` 是可交换的.
	当 `bm A, bm B` 可交换时,
	<span class="formula">
		`bm A^n bm B^n = (bm (A B))^n`.
	</span>
</p>

<p class="example">
	设 `bm A = (a_(i j))_(n xx n)` 的主对角线的下一条对角线 `i-j = 1`
	上的元素全为 1, 其下方元素全为 0, 即
	<span class="formula">
		`a_(i j) = {
			1, if i-j = 1;
			0, if i-j gt 1;
		:}`,<br/>
		`bm A = [
			**, cdots, cdots,**;
			1,ddots, ,vdots;
			, ddots, ddots, vdots;
			, , 1, **;
		]`
	</span>
	计算可知, 对任意正整数 `k`, `bm A^k = (a_(i j)^((k)))_(n xx n)` 满足
	<span class="formula">
		`a_(i j)^((k)) = {
			1, if i-j = k;
			0, if i-j gt k;
		:}`
	</span>
	即每升高一次幂, 全为 1 的那条对角线就下移一个位置. 特别地,
	<span class="formula">
		`(delta_(i,j+1))^k = (delta_(i,j+k))`.
	</span>
</p>

<ol class="proof">
	`k = 1` 时结论显然成立, 假设结论对 `k-1` 成立, 则
	<span class="formula">
		`a_(i j)^((k)) = sum_(l=1)^n a_(i l)^((k-1)) a_(l j)`
	</span>
	<li>`i-j = k` 时: 若 `i-l lt k-1`, 则 `l-j = (i-j)-(i-l) gt 1`,
	`a_(l j) = 0`; 若 `i-l = k-1`, 则 `l-j = 1`,
	`a_(i l)^((k-1)) a_(l j) = 1`; 若 `i-l gt k-1`,
	则 `a_(i l) =  0`. 从而 `a_(i j)^((k)) = 1`.
	</li>
	<li>`i-j gt k` 时: 若 `i-l le k-1`, 则 `l-j = (i-j)-(i-l) gt 1`,
	`a_(l j) = 0`; 若 `i-l gt k-1`, 则 `a_(i l) = 0`;
	从而 `a_(i j)^((k)) = 0`.
	</li>
</ol>

<p class="definition">
	<b>方阵的多项式</b>
	令 `f(x) = sum_(k=0)^m c_k x^k`, `a_m != 0` 为一多项式,
	`bm A = (a_(i j))_(n xx n)`, 则 `f(bm A) = sum_(k=0)^n c_k bm A^k`
	有意义, 且
	<span class="formula">
		`f(bm A) = (f(a_(i j)))_(n xx n)`.
	</span>
	设 `bm A, bm T` 为方阵, `f, g` 为多项式, 且下面的各运算有意义, 则
	<span class="formula">
		`f(bm(T^-1 A T)) = bm T^-1 f(bm A) bm T`,
		`quad f(bm A^T) = f(bm A)^T`,
		`quad f(bm A)g(bm A) = g(bm A)f(bm A)`.
	</span>
	关于分块上, 下三角矩阵和分块对角矩阵有
	<span class="formula">
		`f(bm U_(bm A_k)) = bm U_(f(bm A_k))`,
		`quad f(bm L_(bm A_k)) = bm L_(f(bm A_k))`,
		`quad f(bm D_(bm A_k)) = bm D_(f(bm A_k))`.
	</span>
</p>

<p class="example">
	设 `bm A` 是 `k` 阶单位上三角矩阵, 则 `bm A = bm(I+B)`,
	其中 `bm B` 是 `k` 阶严格上三角矩阵. 由于 `bm B^k = bm O`,
	有
	<span class="formula">
		`bm A^n = bm((I+B))^n`
		`= bm I + n bm B + (n(n-1))/2 bm B^2 + cdots`
		`+ (n;k-1) bm B^(k-1)`.
	</span>
</p>

<p class="example">
	设 `bm A` 是方阵. 由等式
	<span class="formula">
		`bm I - bm A^n = bm((I-A)) sum_(k=0)^(n-1) bm A^k`
	</span>
	知道, 若 `bm A^n = bm O` (如, `bm A` 是 `n` 阶严格上三角矩阵),
	则 `bm I - bm A` 可逆,
	<span class="formula">
		`bm((I-A))^-1 = sum_(k=0)^(n-1) bm A^k`.
	</span>
</p>

<h3>方阵逆的一些结论</h3>

<ol class="example">
	<li>分块对角矩阵的逆. 假设每个 `bm A_k` 都可逆, 则
		<span class="formula">
			`[
				bm A_1, , , ;
				,bm A_2, , ;
				, ,ddots, ;
				, , ,bm A_n;
			]^-1`
			`= [
				bm A_1^-1, , , ;
				,bm A_2^-1, , ;
				, ,ddots, ;
				, , ,bm A_n^-1;
			]`.
		</span>
	</li>
	<li>分块副对角矩阵的逆. 假设每个 `bm A_k` 都可逆, 则
		<span class="formula">
			`[
				, , ,bm A_1;
				, ,bm A_2, ;
				,&#8944;, , ;
				bm A_n, , , ;
			]^-1`
			`= [
				, , ,bm A_n^-1;
				, ,&#8944;, ;
				,bm A_2^-1, , ;
				bm A_1^-1, , , ;
			]`.
		</span>
	</li>
</ol>

<p class="example">
	设 `bm A, bm B` 是 `n` 阶方阵, `bm A, bm B, bm A + bm B` 都可逆, 则
	<span class="formula">
		`bm A^-1 + bm B^-1 = bm B^-1(bm B+bm A)bm A^-1`
		`= bm A^-1(bm B+bm A)bm B^-1`.
	</span>
	容易看出 `bm A^-1 + bm B^-1` 也可逆.
</p>

<ol class="example">
	设 `bm A, bm B` 是 `n` 阶方阵, 且 `bm (A+B) = bm (A B)`, 则
	<li>`bm((A-I)(B-I)) = bm I`, 所以 `bm(A-I)`, `bm(B-I)` 互逆;</li>
	<li>将 `bm((A-I)(B-I)) = bm((B-I)(A-I))` 展开并比较等式两边得,
		`bm A, bm B` 可交换;
	</li>
	<li>若 `bm A`, `bm B`, `bm(A+B)` 三者中有一个可逆, 则另外两个也可逆.
	</li>
</ol>

<p class="proof">
	只证 3. 若 `bm(A+B)` 可逆, 则
	<span class="formula">
		`bm((A+B))^-1 bm(A B)`
		`= bm((A+B))^-1 bm(B A)`
		`= bm((A+B))^-1 bm((A+B)) = bm I`.
	</span>
	因此 `bm A`, `bm B` 都可逆.<br/>
	若 `bm A` 可逆, 则
	<span class="formula">
		`bm A^-1(bm A-bm I)bm B`
		`= bm A^-1(bm(A B)-bm B)`
		`= bm (A^-1 A) = bm I`.
	</span>
	因此 `bm B` 可逆. 从而 `bm(A+B) = bm(A B)` 可逆.<br/>
	最后若 `bm B` 可逆, 类似可证 `bm A`, `bm(A+B)` 可逆.
</p>

<p class="example">
	设 `bm I + bm(A B)` 可逆, 证明 `bm I + bm(B A)` 也可逆.
</p>

<p class="proof">
	设 `bm X = (bm I + bm(A B))^-1`, 则
	<span class="formula">
		`bm(B X A)(bm I + bm(B A))`
		`= bm(B X)(bm I + bm(A B))bm A`
		`= bm(B A)`,<br/>
		`(bm I + bm(B A))bm(B X A)`
		`= bm B(bm I + bm(A B))bm(X A)`
		`= bm(B A)`.
	</span>
	故 `bm I - bm(B X A) = (bm I + bm(B A))^-1`.
</p>

<p class="remark">
	从形式上计算:
	<span class="formula">
		`(bm I + bm(B A))^-1`
		`= bm I + sum_(i=1)^oo bm((-B A))^i`
		`= bm I - bm B(sum_(i=0)^oo bm((-A B))^i) bm A`
		`= bm I - bm B(bm I + bm(A B))^-1 bm A`.
	</span>
</p>

<p class="example">
	设
	<span class="formula">
	`bm A = [
		0,1,cdots,1;
		1,0,cdots,1;
		vdots,vdots,,vdots;
		1,1,cdots,0;
	]_(n xx n)`,
	</span>
	求 `bm A^-1`.
</p>

<p class="solution">
	记 `bm B` 是元素全为 `1` 的 `n` 阶矩阵, 则 `bm B^2 = n bm B`.
	于是
	<span class="formula">
		`(bm B-bm I)(bm B-(n-1)bm I)`
		`= bm B^2 - n bm B + (n-1) bm I`
		`= (n-1)bm I`,<br/>
		`bm A^-1 = bm((B-I))^-1 = 1/(n-1) bm B - bm I`.
	</span>
</p>

<p class="example">
	设 `bm alpha, bm beta` 是 `n` 元列向量,
	`bm(alpha^T beta) = bm(beta^T alpha) = c`, 则对任意正整数 `k`,
	<span class="formula">
		`bm((alpha beta^T))^k = bm alpha bm((beta^T alpha))^(k-1) bm beta^T`
		`= c^(k-1) bm(alpha beta^T)`.
	</span>
	设 `bm I` 是 `n` 阶单位阵, 考虑 `bm I + x bm(alpha beta^T)` 的逆.
	计算
	<span class="formula">
		`(bm I + x bm(alpha beta^T))(bm I + y bm(alpha beta^T))`
		`= bm I + (x+y)bm(alpha beta^T) + c x y bm(alpha beta^T)`.
	</span>
	所以 `bm I + x bm (alpha beta^T)` 可逆当且仅当存在 `y` 使得
	`x+y+c x y = 0`, 即 `x = 0` 或 `1+c x != 0`.
	此时它的逆就是 `bm I + y bm (alpha beta^T)`.<br/>
	取 `c = 1`, `x = -1` 可知, `bm I - bm(alpha beta^T)` 不可逆.
	事实上 `(bm I - bm (alpha beta^T))^2 = bm I - bm(alpha beta^T)`,
	它是幂等矩阵, 但可逆的幂等矩阵只有单位阵, 所以它不可逆.
</p>

<p class="example">
  [来自 ζ(me)=0]
  设方阵 `bm A` 满足 `bm A^2 = 2 bm A`, 讨论以下矩阵是否可逆:
  <span class="formula">
    `bm A-bm I`, `bm A+2bm I`, `bm A - 2bm I`.
  </span>
</p>

<ol class="solution">
  <li>`(bm A-bm I)^2 = bm A^2 - 2bm A + bm I = bm I`, 因此 `bm A - bm I`
    的逆就是自己;
  </li>
  <li>设 `(bm A+2bm I)(x bm A + y bm I) = bm I`,
    于是 `bm I = x bm A^2 + (2x+y) bm A + 2y bm I`
    `= (4x+y) bm A + 2y bm I`. 取 `y = 1/2`, `x = -1/8` 即可.
  </li>
  <li>2 的方法在这里失效:
    `(bm A - 2 bm I)(x bm A + y bm I)`
    `x bm A^2 + (y-2x) bm A -2y bm I`
    `= y (bm A - 2 bm I)`. 事实上, 由 `bm A^2 = 2 bm A` 知道 `bm A`
    的零化多项式是 `x^2 - 2x`, 因此 `bm A` 可能的特征值是 0 和 2.
    当 `bm A` 有特征值 2 时, `|bm A - 2 bm I| = 0`, 不可逆;
    当 `bm A` 的特征值全为 0, 比如 `bm A = bm O` 或 `[0, 1; 0, 0]` 时,
    `bm A - 2 bm I` 可逆.
  </li>
</ol>

<h2>几类特殊矩阵*</h2>

<h3>幂零矩阵</h3>

<p class="definition">
  如果存在正整数 `k` 使得 `bm A^k = bm O`, 则称 `bm A` 为<b>幂零矩阵 (nilpotent matrix)</b>.
</p>

<p class="example">
  `n` 阶矩阵 `bm A` 是幂零矩阵当且仅当它有 `n` 个零特征值.
</p>

<p class="proof">
  `rArr`: `bm A^k = bm O` 的特征值是 `bm A` 的特征值的 `k` 次方, 但 `bm O` 的特征值全为零, 所以 `bm A` 的特征值也全为零.
  <br>
  `lArr`: 由 `bm A` 有 `n` 个零特征值知道它的特征多项式是 `x^n`. 因此由 Cayley-Hamilton 定理得到 `bm A^n = bm O`.
</p>

<p class="example">
  [来自群友 SmartPig]
  设 `bm A` 为 `n` 阶幂零矩阵,
  证明: `bm A != bm O` 时, 它至多有 `n-1` 个线性无关的特征向量.
</p>

<p class="proof">
  首先, 幂零矩阵的特征值必为 0.
  如果 `bm A` 有 `n` 个线性无关的特征向量, 则它可对角化, 换言之 `bm A` 相似于 `bm O`.
  然而 `bm O` 只和自己相似, 这推出 `bm A = bm O`, 矛盾.
</p>

<p class="example">
  若 `bm A^n = bm O`, 则 `bm (I-A)` 可逆,
  <span class="formula">
    `(bm(I-A))^-1`
    `= sum_(k=0)^(n-1) bm A^k`.
  </span>
</p>

<h3>幂等矩阵</h3>

<ol class="example">
  <b>幂等矩阵 (idempotent matrix) 或投影矩阵 (projection matrix)</b> 是指满足 `bm A^2 = bm A` 的方阵.
  <li>零矩阵、单位矩阵是幂等矩阵. 某行全为 1 而其他行全为 0 的矩阵是幂等矩阵.
    可逆幂等矩阵必为单位矩阵.
  </li>
  <li>设 `bm A` 是幂等矩阵, 则 `bm A^T`, `bm A^H`, `bm A^ast`, `bm P^-1 bm (A P)`,
    `bm A^k`, `bm I - bm A` 都是幂等矩阵.
  </li>
  <li>
    幂等矩阵的特征值不是 1 就是 0.
    幂等矩阵的最小多项式为 `x^2 - x`, 且无重根;
    因此幂等矩阵总是可以对角化, 且相似于
    <span class="formula">
      `"diag"(1, cdots, 1, 0, cdots, 0)`.
    </span> 
  </li>
  <li>相似矩阵的迹与秩均不变, 因此幂等矩阵的迹等于秩: `"tr"(bm A) = "rank"(bm A)`.</li>
</ol>

<ol class="example" id="exp-proj-map">
  <b>投影变换的性质</b>
  设 `cc A in L(V)` 是幂等线性变换 (投影变换), 则
  <li>`V = "Ker" cc A o+ "Im" cc A`.</li>
  <li>`"Ker"(bb I - cc A) = "Im" cc A`,
    或等价地, `cc A bm v = bm v` `iff bm v in "Im"cc A`.
    <br>
    这告诉我们, 投影变换保持 `"Im" cc A` 中的向量不变, 而将 `"Ker" cc A` 中的向量映为零.
  </li>
  <li>反之, 若 `V = V_1 o+ V_2`, 则存在唯一的投影变换 `P` 使得 `V_1 = "Ker"P`, `V_2 = "Im"P`.</li>
</ol>

<ol class="proof">
  <li>
    这是因为任意 `bm v in V` 可以写成 `(bm v - cc A bm v) + cc A bm v`.
    假如 `cc A bm v in "Ker" cc A nn "Im" cc A`, 则 `cc A bm v = cc A^2 bm v = 0`,
    这证明了 `"Ker" cc A nn "Im" cc A = {0}`.
  </li>
  <li>
    由 1. 知任意 `bm v in V` 有唯一分解 `bm v = (bm v - cc A bm v) + cc A bm v`, 立即得到结论.
  </li>
  <li>分别取 `V_1` 和 `V_2` 的基底 `{bm u_i}` 和 `{bm v_i}`, 它们合起来组成了 `V` 的基底.
    受 2. 的启发, 令 `P(bm u_i) = 0`, `P(bm v_i) = bm v_i`, 则 `P` 就是满足条件的投影变换.
    若还有一个投影变换 `Q` 的像与核与 `P` 相等, 则 `Q` 也把 `V_1`
    中的向量映为零, `V_2` 中的向量保持不变, 因此 `P = Q`.
  </li>
</ol>

<p class="remark">
  <b>投影变换的几何解释</b>
  投影变换 `cc A` 限制在 `"Im" cc A` 上是恒等映射, 限制在 `"Ker" cc A` 上是零映射.
  从矩阵的角度看, 相似标准形 `"diag"(1, cdots, 1, 0, cdots, 0)` 中对角线 1 的部分对应 `cc A` 的像,
  0 的部分对应 `cc A` 的核.
  可以将 `"Im" cc A` 想象成三维欧氏空间的平面 (投影屏幕), `"Ker" cc A`
  是在原点与平面相交的直线 (投影方向).
  于是 `cc A` 的作用相当于把空间中的一点沿直线方向投影到平面上.
  `bb I - cc A` 也是一个投影变换, 它是空间中一点到 `"Ker" cc A` 的投影, 与 `cc A` 正好互补.
</p>

<ol class="example">
  若 `bm A, bm B` 是同阶幂等矩阵, 则
  <li>`bm A + bm B` 为幂等矩阵当且仅当 `bm (A B) = bm (B A) = bm O`.
    此时有
    <span class="formula">
      `"Im"(bm(A+B)) = "Im"bm A o+ "Im"bm B`,<br>
      `"Ker"(bm(A+B)) = "Ker"bm A nn "Ker" bm B`.
    </span>
  </li>
  <li>`bm A - bm B` 为幂等矩阵当且仅当 `bm (A B) = bm (B A) = bm B`.
    此时有
    <span class="formula">
      `"Im"(bm(A-B)) = "Im"bm A nn "Ker"bm B`,<br>
      `"Ker"(bm(A-B)) = "Ker"bm A o+ "Im"bm B`.
    </span>
  </li>
  <li>作为 2. 的推论, 若 `bm A` 为幂等矩阵, 则 `bm(I-A)` 也是幂等矩阵.  且
    <span class="formula">
      `"Im"(bm(I-A)) = "Ker"bm A`,
      `quad "Ker"(bm(I-A)) = "Im"bm A`.
    </span>
  </li>
</ol>

<p class="proof">
  只证 1. 先设 `bm((A+B))^2 = bm A + bm B`, 于是
  <span class="formula">
    `bm A + bm B`
    `= bm A^2 + bm(A B + B A) + bm B^2`
    `= bm A + bm(A B + B A) + bm B`.
  </span>
  比较得 `bm(A B) = -bm(B A)`.
  于是
  <span class="formula">
    `bm(A B) = bm(A A B)`
    `= bm(A (-B A)) = -bm((A B)A)`
    `= bm(B A A) = bm(B A)`.
  </span>
  但 `bm(A B) = -bm(B A)`, 于是 `bm(A B) = bm(B A) = bm O`.
  反面的证明是容易的.
  <br>
  像的等式:
  显然 `"Im"(bm(A+B)) = "Im"bm A + "Im"bm B`.
  若 `bm(A x) = bm(B y)`, 则 `bm(A x) = bm(A A x)` `= bm (A B y) = bm(O y) = 0`.
  因此这是直和.
  <br>
  核的等式: 显然右 `sube` 左. 任取 `bm x in "Ker"(bm(A+B))`, 则
  <span class="formula">
    `bm (A x)`
    `= bm (A x) - (bm(A+B)) bm x`
    `= bm (A^2 x) - (bm(A+B))^2 bm x`
    `= -bm (B^2) bm x`
    `= bm B (-bm x)`.
  </span>
  等式左端 `in "Im" bm A`, 右端 `in "Im" bm B`, 因此它们都等于 `0`, 即 `bm x in "Ker"bm A nn "Ker" bm B`.
</p>

<p class="example">
  [来自群友 SmartPig]
  对 `n` 阶矩阵 `bm A, bm B` 有
  <span class="formula">
    `"Ker"bm A = "Ker"bm B`
    `iff bm(A B) = bm A`,
    `bm(B A) = bm B`.
  </span>
</p>

<ol class="proof">
  <li>"`rArr`":
    因为 `V = "Ker"bm B o+ "Im"bm B`,
    可以任取 `bm (x+y) in V`, 其中 `bm x in "Ker"bm A = "Ker"bm B`, `bm y in "Im"bm B`.
    于是 `bm(A x) = bm(B x) = 0`, `bm(B y) = bm y`.  因此
    <span class="formula align">
      `(bm(A B - A)) (bm(x+y))`<br>
      `= bm(A B x) - bm(A x) + bm(A B y) - bm(A y)`<br>
      `= 0 - 0 + bm (A y) - bm(A y)`<br>
      `= 0`.
    </span>
    这推出 `bm(A B) = bm A`. 同理 `bm(B A) = bm B`.
  </li>
  <li>
    "`lArr`":
    若 `bm(B A) = bm B`, `bm(A x) = 0`, 则
    <span class="formula">
      `bm(B x)` `= bm(B A x)` `= 0`,
    </span>
    这推出 `"Ker"bm A sube "Ker"bm B`. 同理 `"Ker" bm B sube "Ker"bm A`, 所以它们相等.
  </li>
  <hr>
  [来自群友 机械唯物主义]
  1. 的另一种证法:
  <span class="formula align">
    `bm A^2 = bm A`<br>
    `iff bm A(bm(A-I)) = bm O`<br>
    `iff "Im"(bm(A-I)) sube "Ker"bm A`<br>
    `iff "Im"(bm(A-I)) sube "Ker"bm B`<br>
    `iff bm B(bm(A-I)) = bm O`<br>
    `iff bm (B A) = bm A`.
  </span>
</ol>

<p class="example">
  [来自群友 SmartPig]
  `n` 阶矩阵 `bm A, bm B` 满足
  <span class="formula">
    `"rank"(bm A + bm B) = "rank"bm A + "rank"bm B`,<br>
    `(bm A + bm B)^2 = bm A + bm B`.
  </span>
  证明 `bm A^2 = bm A`, `bm B^2 = bm B`.
</p>

<p class="proof">
  [来自群友 TrivialPig]
  首先 `"Im"(bm(A+B)) le "Im"bm A + "Im"bm B`, 又由已知
  <span class="formula">
    `"dim Im"(bm(A+B)) = "dim Im"bm A + "dim Im"bm B`,
  </span>
  这推出 `"Im"(bm(A+B)) = "Im"bm A o+ "Im"bm B`.
  <br>
  取 `"Im"bm A` 和 `"Im"bm B` 的基底, 则两个基底合起来组成了 `"Im"(bm(A+B))`
  的基底. 在这组基底下, `bm A, bm B` 分别相似于
  <span class="formula">
    `[bm A_1; bm O]`,
    `quad [bm O; bm B_1]`.
  </span>
  但由于 `bm(A+B)` 是幂等矩阵, 它限制在 `"Im"(bm(A+B))` 上是恒等变换, 这推出两个矩阵之和
  <span class="formula">
    `[bm A_1; bm O]`
    `+ [bm O; bm B_1]`
    `= [bm A_1; bm B_1]`
    `= bm I`.
  </span>
  于是 `bm A` 相似于 `"diag"(1, cdots, 1, 0, cdots, 0)`, `bm B` 相似于
  `"diag"(0, cdots, 0, 1, cdots, 1)`, 正说明它们是幂等矩阵.
</p>

<p class="proof">
  [来自群友 澄]
  与前一种证法相同, 推出 `"Im"(bm(A+B)) = "Im"bm A o+ "Im"bm B`.
  接下来, 由已知
  <span class="formula">
    `bm A(bm(A+B)) + bm B(bm(A+B)) = bm(A+B)`,
  </span>
  因此由直和分解得到
  <span class="formula">
    `bm A(bm(A+B)) = bm A`,<br>
    `bm B(bm(A+B)) = bm B`.
  </span>
  由直和分解还能进一步得到: 对任意 `bm x, bm y in V`, 存在 `bm z in V` 使得
  <span class="formula">
    `bm(A x) + bm(B y) = (bm(A+B)) bm z`,<br>
    且 `bm(A x) = bm(A z)`, `bm(B y) = bm(B z)`.
  </span>
  左乘 `bm A` 得到
  <span class="formula">
    `bm A^2 bm x + bm(A B y)`
    `= bm A(bm(A+B)) bm z`
    `= bm(A z)`
    `= bm(A x)`.
  </span>
  特别取 `bm y = 0` 有 `bm A^2 bm x = bm (A x)`, 即 `bm A^2 = bm A`.
</p>

<h3>对合矩阵</h3>

<p class="definition">
  <b>对合矩阵</b> 是指满足 `bm A^2 = bm I` 的方阵.
  例如, 副对角线上全为 1, 其他全为 0 的矩阵是对合矩阵, 它代表 `[1..n]` 的倒序排列.
  对合矩阵的逆就是自己.
  对合矩阵的特征值只能取 `+-1`.
</p>

<p class="remark">
  或许, 对合矩阵是矩阵家族中的「二次元」.
</p>

<p class="example">
  [来自群友 问情明心]
  设 `n` 阶复矩阵 `bm X` 满足 `bm X^m = bm I_n`, 求 `bm X`.
</p>

<p class="solution">
  `bm X` 有零化多项式 `x^m - 1`. 因此它的最小多项式是 `x^m - 1` 的因式, 从而是无重根的.
  根据矩阵可对角化的等价条件, `bm X` 可以对角化, 且相似于
  <span class="formula">
    `"diag"(x_1, cdots, x_n)`,
  </span>
  其中每个对角元素都是 `m` 次单位根, 即 `x_i^m = 1`, `i = 1, cdots, n`.
</p>

<ol class="example">
  <b>几类矩阵可交换的结论</b>
  <li>设 `bm A, bm B` 是同阶对称矩阵, 则 `bm(A B) = bm(B A) iff bm(A B)` 是对称矩阵.</li>
  <li>设 `bm A, bm B` 是同阶对合矩阵, 则 `bm(A B) = bm(B A) iff bm(A B)` 是对合矩阵.</li>
  <li>设 `bm A, bm B` 是同阶幂等矩阵, 则 `bm(A B) = bm(B A) rArr bm(A B)` 是幂等矩阵.</li>
</ol>

<ol class="proof">
  3 个小问的正面证明都是容易的, 我们只讨论反面 (`lArr`):
  <li>设 `bm((A B))^T = bm(A B)`, 即
    <span class="formula">
      `bm((A B))^T = bm((B^T A^T))^T = bm((B A))^T`,
    </span>
    即 `bm(A B) = bm(B A)`.
  </li>
  <li>设 `bm(A B A B) = bm I`,
    于是
    <span class="formula">
      `bm B^-1 = bm(A B A)`, `bm A^-1 = bm(B A B)`.
    </span>
    因为 `bm A^2 = bm B^2 = bm I`, 有
    <span class="formula">
      `bm(A B A B) = bm A^2 bm B^2`,
    </span>
    左边同乘以 `bm A^-1`, 右边同乘以 `bm B^-1` 就得到 `bm(B A) = bm(A B)`.
  </li>
  <li>
    反面不成立, 反例是 `bm A = [1, 1; 0, 0]`, `bm B = [1, 0; 0, 0]`.
    我们有 `bm (A B) = bm B`, `bm (B A) = bm A`.
  </li>
</ol>

<h3>反对称矩阵</h3>

<p class="example">
  设 `bm A in bbb F^(n xx n)`, `"char" bbb F != 2`, 则
  <span class="formula">
    `bm A` 反对称 `iff AA bm x in bbb F^n`, `bm x^(sf T) bm (A x) = 0`.
  </span>
</p>

<ol class="proof">
  <li>
    `rArr`: 设 `bm A` 反对称, 则
    <span class="formula">
      `bm x^(sf T) bm A bm x`
      `= (bm (A x))^(sf T) bm x`
      `= -bm x^(sf T) bm A bm x`.
    </span>
    注意 `"char" bbb F != 2`, 移项再除以 2 就得到结论.
  </li>
  <li>
    `lArr`:
    在等式 `bm x^(sf T) bm (A x) = 0` 中,
    先取 `bm x = bm e_i` 知 `A_(i i) = 0`,
    再取 `bm x = bm e_i + bm e_j` 知 `A_(i j) + A_(j i) = 0`,
    因此 `bm A` 是反对称矩阵.
  </li>
</ol>

<ol class="example">
  设 `bm A` 是 `n` 阶实反对称矩阵, 则
  <li>`bm A` 的特征值是零, 或成对共轭的纯虚数.</li>
  <li>
    作为 2. 的推论: `|bm A|` 是一个非负实数.
    特别当 `n` 为奇数时 `bm A` 必有零特征值, `|bm A| = 0`.
    此外, 若 `bm B` 实正定, `bm A` 实反对称, 则 `|bm A + bm B| gt 0`.
  </li>
  <li>设 `bm A` 的全部非零特征值是 `+-"i" b_k`, `k = 1, cdots, r`, 则 `"rank"(bm A) = 2 r`,
    且 `bm A` 正交相似于
    <span class="formula">
      `"diag"(bm B_1, cdots, bm B_r, 0, cdots, 0)`.
    </span>
    其中 `bm B_k = [, b_k; -b_k, ]`.
  </li>
</ol>

<ol class="proof">
  <li>设 `bm A bm x = lambda bm x`, 两边左乘 `bm x` 的共轭转置得
    <span class="formula">
      `bar (bm x)^(sf T) bm (A x)`
      `= lambda bar (bm x)^(sf T) bm x`
      `= lambda |bm x|^2`.
    </span>
    上式两边取共轭转置,
    <span class="formula">
      `bar lambda |bm x|^2`
      `= bar (bm (A x))^(sf T) bm x`
      `= -bar (bm x)^(sf T) bm (A x)`.
    </span>
    比较两式, 同时消去 `|bm x|^2 != 0` 得到 `bar lambda = -lambda`, 因此 `lambda` 是纯虚数.
  </li>
  <li>
    首先因为 `bm I + bm A` 的特征值形如 `1 +- "i"b_k`, 全部相乘就得到 `|bm I + bm A| gt 0`.
    然后由于 `bm B` 正定可设 `bm I = bm P^(sf T) bm (B P)`, 则
    <span class="formula">
      `bm P^(sf T) (bm A + bm B) bm P`
      `= bm P^(sf T) bm (A P) + bm I`.
    </span>
    其中 `bm P^(sf T) bm (A P)` 实反对称, 因此上式右边的行列式为正, 约去 `|bm P|^2` 就得到
    `|bm A + bm B| gt 0`.
  </li>
</ol>

<script>
var asciimath = {
  define: [
    [/\^T/g, '^(sf T)'],
    [/\^H/g, '^(sf H)'],
  ]
}
</script>
<script src="../../js/note.js?type=math"></script>
</body>
</html>
