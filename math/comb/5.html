<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <title>ç¦»æ•£å¾®ç§¯åˆ†ä¸ç‰¹æ®Šè®¡æ•°åºåˆ—</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" type="text/css" href="../../css/note.css" />
</head>
<body>

<h2>ç¦»æ•£å¾®ç§¯åˆ†</h2>

<h3>å·®åˆ†</h3>

<p class="definition">
	è®¾ `x_n` (`n ge 0`) æ˜¯ä¸€ä¸ªæ•°åˆ—. å®šä¹‰ `x_n` çš„<b>å·®åˆ†</b>ä¸º
	<span class="formula">
		`Delta x_n = x_(n+1) - x_n`,
	</span>
	å…¶ä¸­ `Delta` ç§°ä¸ºå·®åˆ†ç®—å­.
	å®šä¹‰ `x_n` æ˜¯è‡ªå·±çš„é›¶é˜¶å·®åˆ†: `x_n = Delta^0 x_n`.
	ä¸€èˆ¬åœ°, å¯¹ä»»æ„æ­£æ•´æ•° `k`, `x_n` çš„ `k` é˜¶å·®åˆ†é€’å½’å®šä¹‰ä¸º
	<span class="formula">
		`Delta^k x_n = Delta( Delta^(k-1) x_n)`.
	</span>
	å·®åˆ†å¯ä»¥ç±»æ¯”äºå¾®åˆ†è¿ç®—.
</p>

<p class="remark">
	ä¸Šé¢å®šä¹‰çš„å·®åˆ†åˆå«å‘å‰å·®åˆ†. è¿˜å¯ä»¥å®šä¹‰å‘åå·®åˆ†ä¸ä¸­å¿ƒå·®åˆ†
	<span class="formula">
		`grad x_n = x_n - x_(n-1)`,
		`quad delta x_n = x_(n+1/2) - x_(n-1/2)`.
	</span>
	ä¸‹æ–‡æˆ‘ä»¬åªè®¨è®ºå‘å‰å·®åˆ†.
</p>

<p class="example">
	åˆ©ç”¨å·®åˆ†è¡¨è®¡ç®— `x_n = 2 n^2 + 3 n + 1` çš„å„é˜¶å·®åˆ†.
</p>

<div class="p solution">
	å°† `x_0, x_1, x_2, cdots` åˆ—äºç¬¬ä¸€è¡Œ,
	`Delta x_0, Delta x_1, cdots` åˆ—äºç¬¬äºŒè¡Œ,
	ä¾æ­¤ç±»æ¨, æ¯ä¸ªå·®åˆ†å€¼å†™åœ¨è¢«å‡æ•°ä¸å‡æ•°çš„ä¸‹é¢:
	<pre>
1   6   15  28  45  66  91  ..
  5   9   13  17  21  25  ..
    4   4   4   4   4   ..
	  0   0   0   0   ..
	</pre>
	ä» 3 é˜¶å·®åˆ†å¼€å§‹, æ¯ä¸€è¡Œéƒ½æ˜¯é›¶.
</div>

<p class="solution">
  ä½¿ç”¨ç»„åˆæ•°è¿›è¡Œç¬¦å·è®¡ç®—. å°† `x_n` æ”¹å†™ä¸º
  <span class="formula">
    `x_n = 4(n;2) + 5(n;1) + (n;0)`,
  </span>
  ä»è€Œ
  <span class="formula">
    `Delta x_n = 4(n;1) + 5(n;0)`,<br>
    `Delta^2 x_n = 4(n;0)`,<br>
    `Delta^3 x_n = 0`.
  </span>
</p>

<p>	å¦‚åŒå¾®ç§¯åˆ†ä¸­æˆ‘ä»¬æœ‰ä¸€å¼ å¸¸ç”¨å‡½æ•°çš„å¯¼æ•°è¡¨ä¸€æ ·, æˆ‘ä»¬æ¥æ¨å¯¼ä¸€äº›å¸¸è§æ•°åˆ—çš„å·®åˆ†.</p>

<p class="proposition">
	<b>æŒ‡æ•°å‡½æ•°çš„å·®åˆ†å…¬å¼</b>
	ç›´æ¥è®¡ç®—,
	<span class="formula">
		`Delta 2^n = 2^n`,
        `quad Delta a^n = a^n (a-1)`,
        `quad Delta^k a^n = a^n (a-1)^k`.
	</span>
	`2^n` çš„å·®åˆ†æ˜¯å®ƒè‡ªå·±, è¿™ä¸€æ€§è´¨å¯¹åº”äºå¾®ç§¯åˆ†ä¸­çš„ `"e"^x`.
	å¦‚æœè®° `H_n = sum_(k=1)^n 1/k`, åˆ™
	<span class="formula">
		`Delta H_n = 1/(n+1)`,
	</span>
	è¿™ä¸€æ€§è´¨å¯¹åº”äºå¾®ç§¯åˆ†ä¸­çš„ `ln x`.
</p>

<p class="definition">
  <b>ä¸‹é™å¹‚ä¸ä¸Šå‡å¹‚</b>
  è®¾ `k` ä¸ºéè´Ÿæ•´æ•°,
  <span class="formula">
    `n^(ul k) = prod_(0 le i lt k) (n-i) = n(n-1) cdots (n-k+1)`,<br/>
    `n^(bar k) = prod_(0 le i lt k) (n+i) = n(n+1) cdots (n+k-1)`.
  </span>
  ä¸‹é™å¹‚ä¸äºŒé¡¹å¼ç³»æ•°åªç›¸å·®ç³»æ•° `k!`:
  <span class="formula">
    `n^(ul k)/(k!) = (n;k)`.
  </span>
  ä¸‹é¢è€ƒè™‘è´ŸæŒ‡æ•°çš„ä¸‹é™å¹‚.  è®¾ `k` ä¸ºæ­£æ•´æ•°, å®šä¹‰
  <span class="formula">
    `n^(ul(-k)) = prod_(1 le i le k) (n+i)^-1`
    `= 1/((n+1)(n+2) cdots (n+k))`.
  </span>
  ç‰¹åˆ«åœ° `n^(ul(-1)) = 1/(n+1)`.
</p>

<p class="proposition">
  <b>ä¸‹é™å¹‚çš„å·®åˆ†å…¬å¼</b>
  `k` ä¸ºéè´Ÿæ•´æ•°æ—¶, ç”± Pascal å…¬å¼ `(n+1; k) = (n; k) + (n; k-1)` çŸ¥
  <span class="formula">
    `Delta (n;k) = (n; k-1)`.
  </span>
  å†™æˆä¸‹é™å¹‚å½¢å¼å°±æ˜¯
  <span class="formula">
    `Delta n^(ul k) = k n^(ul(k-1))`.
  </span>
  å¯ä»¥éªŒè¯ä¸Šå¼å¯¹äºè´ŸæŒ‡æ•°ä¸‹é™å¹‚ä»æˆç«‹. å› æ­¤, ä¸‹é™å¹‚çš„å·®åˆ†ä»æ˜¯ä¸€ä¸ªä¸‹é™å¹‚,
  è¿™å¯¹åº”äºå¾®åˆ†å­¦çš„å…¬å¼ `"d"/dx x^n = n x^(n-1)`.
  ç„¶è€Œ `n^k` æ²¡æœ‰ç®€å•çš„å·®åˆ†å…¬å¼, æ‰€ä»¥åœ¨ç¦»æ•£æ•°å­¦çš„ä¸–ç•Œé‡Œ,
  ç”¨ä¸‹é™å¹‚ä»£æ›¿æ™®é€šçš„å¹‚, å¾€å¾€èƒ½ç®€åŒ–è®¡ç®—.
</p>

<table>
  <caption>å¸¸è§å‡½æ•°çš„å·®åˆ†</caption>
  <tr>
    <td>`f(n)`</td>
    <td>`Delta f(n)`</td>
    <td>`f(n)`</td>
    <td>`Delta f(n)`</td>
  </tr>
  <tr>
    <td>`2^n`</td>
    <td>`2^n`</td>
    <td>`a^n`</td>
    <td>`a^n(a-1)`</td>
  </tr>
  <tr>
    <td>`(n;k)`</td>
    <td>`(n;k-1)`</td>
    <td>`n^(ul k)`</td>
    <td>`k n^(ul(k-1))`</td>
  </tr>
  <tr>
    <td>`H_n`</td>
    <td>`n^(ul(-1))`</td>
  </tr>
</table>

<h3>æ±‚å’Œ</h3>

<ol class="proposition">
  <li>å¦‚åŒç§¯åˆ†ä¸å¾®åˆ†ä¸€æ ·, <b>æ±‚å’Œä¸å·®åˆ†å…·æœ‰çº¿æ€§æ€§</b>:
    <span class="formula">
      `sum (a x_n + b y_n) = a sum x_n + b sum y_n`,
      `quad Delta (a x_n + b y_n) = a Delta x_n + b Delta y_n`.
    </span>
  </li>
  <li>å¦‚åŒç§¯åˆ†ä¸å¾®åˆ†äº’é€†ä¸€æ ·, <b>æ±‚å’Œä¸å·®åˆ†äº’ä¸ºé€†è¿ç®—</b>:
    <span class="formula">
      `sum_(0 le k lt n) Delta x_k = [x_k]_0^n = x_n - x_0`,
      `quad Delta sum_(0 le k lt n) x_k = x_n`.
    </span>
    ç‰¹åˆ«å½“ `x_0 = 0` æ—¶, ä¸¤å¼ç»“æœç›¸ç­‰.
  </li>
  <li>
    <b>åˆ†éƒ¨æ±‚å’Œå…¬å¼ (Abel å˜æ¢)</b>
    å› ä¸º
    <span class="formula">
      `Delta (x_k y_k) = x_(k+1) y_(k+1) - x_k y_(k+1) + x_k y_(k+1)
      - x_k y_k`
      `= y_(k+1) Delta x_k + x_k Delta y_k`,
    </span>
    æ‰€ä»¥
    <span class="formula">
      `sum_(0 le k lt n) x_k Delta y_k`
      `= [x_k y_k]_0^n - sum_(0 le k lt n) y_(k+1) Delta x_k`.
    </span>
    åˆ†éƒ¨æ±‚å’Œçš„å‡ ä½•æ„ä¹‰è§ä¸‹å›¾: å·¦ä¸Šé˜¶æ¢¯å½¢ (è“) = å¤§çŸ©å½¢ - å·¦ä¸‹å°çŸ©å½¢ (é»„) - å³ä¸‹é˜¶æ¢¯å½¢ (çº¢).
  </li>
</ol>

<div class="img md">
  <img src="../img/sum-by-part.svg">
</div>

<p>ç±»ä¼¼å¯è¯
  <span class="formula">
    `sum_(k=0)^(n-m) x_k (y_(k+m) - y_k)`
    `= [x_k y_k]_0^n - sum_(k=0)^(n-m) y_(k+m) (x_(k+m)-x_k)`.
  </span>
</p>

<p class="example">
  æ±‚ `sum k 2^k`, å…¶ä¸­æ±‚å’ŒèŒƒå›´æ˜¯ `0 le k lt n`.
</p>

<p class="solution">
  <span class="formula">
    `sum k 2^k = sum k Delta 2^k = [k 2^k]_0^n - sum 2^(k+1) Delta k`
    `= n 2^n - 2 sum Delta 2^k = n 2^n - 2 [2^k]_0^n`
    `= n 2^n - 2(2^n - 1)`.
  </span>
</p>

<p class="example">
  æ±‚ `sum H_k`, æ±‚å’ŒèŒƒå›´æ˜¯ `0 le k lt n`.
</p>

<p class="solution">
  <span class="formula">
    `sum H_k = sum H_k Delta k = [k H_k]_0^n - sum (k+1) Delta H_k`
    `= n(H_n - 1)`.
  </span>
</p>

<p class="example">
  [æ¥è‡ª æˆ‘æ˜¯çš„çš„æ˜¯æˆ‘]
  <span class="formula">
    `sum_(k=1)^n (H(k))/k = 1/2(H_n^2 + H_n^((2)))`,
  </span>
  å…¶ä¸­ `H_n^((r)) = sum_(k=1)^n 1/k^r` æ˜¯<b>å¹¿ä¹‰è°ƒå’Œæ•°</b>.
</p>

<p class="proof">
  `n = 0` æ—¶ç­‰å¼æ˜¾ç„¶æˆç«‹;
  å³è¾¹å·®åˆ†å¾—
  <span class="formula">
    `1/2[H_n^2 - H_(n-1)^2 + H_n^((2)) - H_(n-1)^((2))]`
    `= 1/2[1/n(2H_(n-1) + 1/n) + 1/n^2]`
    `= (H_n)/n`,
  </span>
  ç­‰äºå·¦è¾¹çš„å·®åˆ†; ç­‰å¼å¾—è¯.
</p>

<p class="solution">
  è®°å·¦è¾¹ä¸º `S`, äºæ˜¯
  <span class="formula align">
    `S = [H_k H_(k-1)]_1^(n+1) - sum_(k=1)^n H_k/(k+1)`<br>
    `= H_(n+1) H_n - sum_(k=1)^n H_k/(k+1)`<br>
    `= H_n^2 - sum_(k=1)^(n-1) H_k/(k+1)`<br>
    `= H_n^2 + sum_(k=1)^(n-1) 1/(k+1)^2 - sum_(k=1)^(n-1) H_(k+1)/(k+1)`<br>
    `= H_n^2 + H_n^((2)) - S`.<br>
  </span>
</p>

<p class="example">
  ä¸€èˆ¬åœ°, å¯¹ä»»æ„æ­£æ•´æ•° `a, b`, è¿ç”¨åˆ†éƒ¨æ±‚å’Œå¾—
  <span class="formula">
    `sum_(k=1)^n H_k^((a))/k^b = H_n^((a)) H_n^((b)) + H_n^((a+b)) - sum_(k=1)^n H_k^((b))/k^a`.
  </span>
  ç‰¹åˆ«å½“ `a = b` æ—¶,
  <span class="formula">
    `sum_(k=1)^n H_k^((a))/k^a = 1/2((H_n^((a)))^2 + H_n^((2a)))`.
  </span>
</p>

<p class="example">
  åº”ç”¨ç¦»æ•£å¾®ç§¯åˆ†çš„æ–¹æ³•å¯¼å‡ºæœ±ä¸–æ°æ’ç­‰å¼:
  <span class="formula">
    `sum_(k=0)^n (k;p)`
    `= sum_(k=0)^n Delta (k; p+1)`
    `= (n+1; p+1) - (0; p+1)`
    `= (n+1; p+1)`.
  </span>
</p>

<p class="example">
  ä½¿ç”¨ä¸‹é™å¹‚çš„å·®åˆ†æ±‚ `sum_(k=1)^n k^2`, `sum_(k=1)^n k^3`.
</p>

<ol class="solution">
  <li>
    <span class="formula">
      `sum_(k=1)^(n-1) k^2`
      `= sum k + sum k (k-1)`
      `= (n(n-1))/2 + (n(n-1)(n-2))/3`
      `= (n(n-1)(2n-1))/6`.
    </span>
  </li>
  <li>
    <span class="formula">
      `sum_(k=1)^(n-1) k^3`
      `= sum k + 3sum k^(ul 2) + sum k^(ul 3)`
      `= n^(ul 2)/2 + n^(ul 3) + n^(ul 4)/4`
      `= ((n(n-1))/2)^2`.
    </span>
  </li>
</ol>

<h3>å‡ ä¸ªå…¬å¼</h3>

<p>æœ¬èŠ‚çš„æœ€åå¯¼å‡ºå‡ ä¸ªæœ‰ç”¨çš„å…¬å¼.</p>

<p class="theorem">
  <b>ç»„åˆåæ¼”å…¬å¼</b>
  å…³äºæ•°åˆ— `{x_n}, {y_n}`, è‹¥
  <span class="formula">
    `y_n = sum_(k=0)^n (n;k) x_k`,
  </span>
  åˆ™
  <span class="formula">
    `x_n = sum_(k=0)^n (n;k) (-1)^(n-k) y_k`.
  </span>
  å¦‚æœè®° `x_n = x^n`, `y_n = y^n`, ä»¥ä¸Šç»“è®ºå½¢å¼åœ°è®°ä¸º
  <span class="formula">
    `y^n = (x+1)^n` `rArr x^n = (y-1)^n`.
  </span>
  æˆ–å¯¹ç§°åœ°,
  <span class="formula">
    `y^n = (1-x)^n` `rArr x^n = (1-y)^n`.
  </span>
  ç”¨çŸ©é˜µè®°ä¸º
  <span class="formula">
    `(a_(i j))^-1 = (-1)^(i-j) (a_(i j))`,
    `quad a_(i j) = (i;j)`.
  </span>
</p>

<p class="proof">
  ä»£å…¥éªŒè¯,
  <span class="formula">
    `sum_(k=0)^n (n;k) (-1)^(n-k) sum_(j=0)^k (k;j) x_j`
    `= sum_(j=0)^n x_j sum_(k=j)^n (n;k)(k;j) (-1)^(n-k)`
    `= sum_(j=0)^n x_j A_j`.
  </span>
  å…¶ä¸­
  <span class="formula">
    `A_j = sum_(k=0)^(n-j) (n;k)(n-k;j) (-1)^k`
    `= sum_(k=0)^(n-j) (n;j)(n-j;k) (-1)^k`
    `= (n;j) (1-1)^(n-j)`
    `= {1, if j = n; 0, if j lt n:}`
  </span>
  å› æ­¤ `sum_(j=0)^n x_j A_j = x_n`.
</p>

<p class="theorem">
  <b>`k` é˜¶å·®åˆ†å…¬å¼</b>
  <span class="formula">
    `Delta^k x_n = sum_(j=0)^k (k;j) (-1)^(k-j) x_(n+j)`.
  </span>
  å¦‚æœè®° `x_n = x^n`, ä¸Šå¼å½¢å¼åœ°å†™ä¸º
  <span class="formula">
    `Delta^k x^n = (x-1)^k x^n`, äº¦å³ `Delta = x - 1`.
  </span>
  è¯¥è¡¨è¾¾å¼ä¸æŒ‡æ•°å‡½æ•°çš„ `k` é˜¶å·®åˆ†ä¸€è‡´.<br>
  åæ¼”å¾—åˆ°<b>ç¦»æ•£ Maclaurin å…¬å¼</b>:
  <span class="formula">
    `x_(n+k) = sum_(j=0)^k (k;j) Delta^j x_n`
    `= sum_(j=0)^k (Delta^j x_n)/(j!) k^(ul j)`.
  </span>
  å½¢å¼è®°ä¸º
  <span class="formula">
    `x^(n+k) = (Delta+1)^k x^n`, äº¦å³ `x = Delta + 1`.
  </span>
  å‘åå·®åˆ†ã€ä¸­å¿ƒå·®åˆ†ä¹Ÿæœ‰ç±»ä¼¼çš„è¡¨è¾¾å¼.
</p>

<p class="proof">
  `k = 0` æ—¶, `Delta^0 x_n = x_n` æˆç«‹; å‡è®¾ç­‰å¼å¯¹ `k-1` æˆç«‹, åˆ™
  <span class="formula align">
    `Delta^k x_n = Delta^(k-1) x_(n+1) - Delta^(k-1) x_n`<br>
    `= sum_(j=0)^(k-1) (k-1; j) (-1)^(k-1-j) x_(n+1+j)`
    `- sum_(j=0)^(k-1) (k-1; j) (-1)^(k-1-j) x_(n+j)`<br>
    `= x_(n+k) - (-1)^(k-1) x_n`
    `+ sum_(j=1)^(k-1) (-1)^(k-j) x_(n+j) ((k-1; j-1) + (k-1; j))`<br>
    `= sum_(j=0)^k (k;j) (-1)^(k-j) x_(n+j)`.
  </span>
</p>

<p class="theorem">
  <b>ç¦»æ•£ Maclaurin å…¬å¼</b>
  è®¾ `x_n` ä¸ºæ•°åˆ—é€šé¡¹, `m` ä¸ºéè´Ÿæ•´æ•°, ä¸”å¯¹ä»»æ„ `k gt m` æœ‰
  `Delta^k x_0 = 0`, åˆ™
  <span class="formula">
    `x_n = sum_(k=0)^m (n;k) Delta^k x_0`
    `= sum_(k=0)^m (Delta^k x_0)/(k!) n^(ul k)`.
  </span>
</p>

<p class="proof">
  é¦–å…ˆç”±å¤§äº `m` é˜¶çš„å·®åˆ†éƒ½ç­‰äºé›¶çŸ¥, `x_n` æ˜¯å…³äº `n` çš„å¤šé¡¹å¼.<br/>
  å› ä¸º `(n; k)` æ˜¯å…³äº `n` çš„ `k` æ¬¡å¤šé¡¹å¼, `k = 0, 1, cdots, m`, æ‰€ä»¥
  `(n;k)` çº¿æ€§æ— å…³, å®ƒä»¬ç»„æˆå¤šé¡¹å¼ç©ºé—´ `bbb P{::}_m[x]` çš„åŸº.<br/>
  ä¸‹é¢è®¡ç®— `(n;k)` çš„å·®åˆ†.
  å› ä¸º `Delta_n (n;k) = (n;k-1)`, æ‰€ä»¥
  <span class="formula">
    `{: Delta_n^j (n;k) |_(n=0) = {: (n; k-j) |_(n=0)`
    `= delta_(j k) = { 1, if j = k; 0, if j != k :}`.
  </span>
  ç°åœ¨å°†å¤šé¡¹å¼ `x_n` ç”¨åŸºåº•çº¿æ€§è¡¨ç¤ºä¸º
  <span class="formula">
    `x_n = sum_(k=0)^m c_k (n; k)`,
  </span>
  åˆ™ç”±å·®åˆ†çš„çº¿æ€§æ€§çŸ¥,
  <span class="formula">
    `Delta_n^j x_0 = sum_(k=0)^m c_k {:Delta_n^j (n;k)|_(n=0)`
    `= sum_(k=0)^m c_k delta_(j k)`
    `= c_j`.
  </span>
  æ‰€ä»¥å…¬å¼æˆç«‹.
</p>

<p class="theorem">
  <b>å¸¦ä½™é¡¹çš„ç¦»æ•£ Maclaurin å…¬å¼</b>
  <span class="formula">
    `x_n = sum_(k=0)^m (n;k) Delta^k x_0 + R_m(n)`,
  </span>
  å…¶ä¸­ `R_m(n) = sum_(0 le k lt n) (n-k-1; m) Delta^(m+1) x_k`.
</p>

<p class="proof">
  è®¾ `m gt 0`, å¯¹ `R_m(n)` åˆ†éƒ¨æ±‚å’Œ,
  <span class="formula">`{:
    R_m(n) ,= sum_(0 le k lt n-1) (n-k-1; m) Delta^(m+1) x_k;
    ,= [(n-k-1; m) Delta^m x_k]_(k=0)^(n-1)
    + sum_(0 le k lt n-1) (n-k-2; m-1) Delta^m x_(k+1);
    ,= -(n-1; m) Delta^m x_0 + sum_(1 le k lt n) (n-k-1; m-1)
    Delta^m x_k;
    ,= -(n-1; m) Delta^m x_0 - (n-1; m-1) Delta^m x_0 + sum_(0 le k lt
    n) (n-k-1; m-1) Delta^m x_k;
    ,= -(n; m) Delta^m x_0 + R_(m-1) (n).:}`
  </span>
  äºæ˜¯
  <span class="formula">
    `R_0(n) = sum_(1 le k le m) (R_(k-1)(n) - R_k(n)) + R_m(n)`,
  </span>
  å³
  <span class="formula">
    `x_n - x_0 = sum_(1 le k le m) (n;k) Delta^k x_0 + R_m(n)`.
  </span>
</p>

<h2>Stirling æ•°</h2>

<p class="definition">
	<b>Stirling æ•°</b>
	ä»çº¿æ€§ä»£æ•°çš„è§’åº¦, `{x^k}_(k=0)^n` ä¸ `{x^(ul k)}_(k=0)^n`
	æ˜¯æ¬¡æ•°ä¸è¶…è¿‡ `n` çš„å¤šé¡¹å¼ç»„æˆçš„çº¿æ€§ç©ºé—´ `bbb P{::}_n[x]` çš„ä¸¤ä¸ªåŸºåº•.
	ä¸ºäº†æ–¹ä¾¿ç¦»æ•£å¾®ç§¯åˆ†è¿ç®—, éœ€è¦å°†å¤šé¡¹å¼çš„åŸºç”±æ™®é€šå¹‚æ¢ä¸ºä¸‹é™å¹‚.
	ä¸‹é¢å®šä¹‰çš„ä¸¤ç±» Stirling æ•°åˆ†åˆ«ç»™å‡ºäº†ä¸¤ç»„åŸºåº•ä¹‹é—´äº’åŒ–çš„ç³»æ•°
	(å³è¿‡æ¸¡çŸ©é˜µ):
	<span class="formula">
		`x^(ul n) = sum_(k=0)^n (-1)^(n-k) s(n, k) x^k`,
		`quad x^n = sum_(k=0)^n S(n, k) x^(ul k)`.
	</span>
	å…¶ä¸­ `s(n, k)` ç§°ä¸º<b>ç¬¬ä¸€ç±» Stirling æ•°</b>, ä¹Ÿè®°ä¸º `[n;k]`,
    `S(n, k)` ç§°ä¸º<b>ç¬¬äºŒç±» Stirling æ•°</b>, ä¹Ÿè®°ä¸º `{n;k}`.
</p>

<p class="corollary">
  <b>ä¸¤ç±» Stirling æ•°çš„åæ¼”</b>
  ç”±ä¸¤ç±» Stirling æ•°æ„æˆçš„ç³»æ•°çŸ©é˜µäº’é€†çŸ¥,
  <span class="formula">
    `y_n = sum_(k=0)^n S(n, k) x_n`
    `iff`
    `x_n = sum_(k=0)^n (-1)^(n-k) s(n, k) y_n`.
  </span>
</p>

<p>æˆ‘ä»¬å…ˆè®¨è®ºç¬¬äºŒç±» Stirling æ•°.</p>

<h3>ç¬¬äºŒç±» Stirling æ•°</h3>

<pre>
          1
        0   1
      0   1   1
    0   1   3   1
  0   1   7   6   1
0   1  15  25  10   1
</pre>

<p class="proposition">
  <b>é€’æ¨å…¬å¼</b>
  <span class="formula">
    `S(n, k) = {
      1, if n = k;
      0, if n gt 0 and k = 0;
      S(n-1, k-1) + k S(n-1, k), otherwise;
    :}`
  </span>
</p>

<p class="proof">
  ä»å®šä¹‰å¼ `x^n = sum_(k=0)^n S(n, k) x^(ul k)` å‡ºå‘.
  è€ƒè™‘ä¸¤è¾¹çš„ `n` æ¬¡é¡¹ç³»æ•°å’Œå¸¸æ•°é¡¹åˆ†åˆ«å¯å¾— `S(n, n) = 1` (`n ge 0`) å’Œ
  `S(m, 0) = 0` (`m gt 0`). ç°åœ¨è®¾ `n gt 0`, ä¸¤è¾¹å¯¹ `x` å·®åˆ†å¾—åˆ°
  <span class="formula">
    `(x+1)^n - x^n = sum_(k=1)^n S(n, k) k x^(ul (k-1))`.
  </span>
  å¦ä¸€æ–¹é¢
  <span class="formula align">
    `(x+1)^n - x^n`
    `= 1/(x+1) (x+1)^(n+1) - x^n`<br>
    `= 1/(x+1) sum_(k=1)^(n+1) S(n+1, k) (x+1)^(ul k)`
    `- sum_(k=1)^n S(n, k) x^(ul k)`<br>
    `= sum_(k=1)^(n+1) S(n+1, k) x^(ul(k-1))`
    `- sum_(k=2)^(n+1) S(n, k-1) x^(ul(k-1))`<br>
    `= sum_(k=1)^n S(n+1, k) x^(ul(k-1))`
    `- sum_(k=1)^n S(n, k-1) x^(ul(k-1))`.<br>
  </span>
  æ¯”è¾ƒå¾—
  <span class="formula">
    `k S(n, k) = S(n+1, k) - S(n, k-1)`.
  </span>
</p>

<p class="proposition">
  <b>é€šé¡¹å…¬å¼</b>
  <span class="formula">
    `S(n,k) = 1/k! sum_(j=0)^k (k;j) (-1)^j (k-j)^n`.
  </span>
  ä»¤ `S_n^k = k^n`, ä¸Šå¼å½¢å¼å†™ä¸º `S(n, k) = 1/k! (S_n-1)^k`.
</p>

<p class="proof">
  åªéœ€éªŒè¯è¿™ä¸ªé€šé¡¹å…¬å¼é€‚åˆè¾¹ç•Œæ¡ä»¶å’Œé€’æ¨å…¬å¼, è¿‡ç¨‹ç•¥.
</p>

<p class="proof">
  åœ¨å®šä¹‰å¼ `x^n = sum_(k=0)^n S(n, k) x^(ul k)` ä¸­, è€ƒè™‘æ•°åˆ— `1^n, 2^n,
  3^n, cdots, n^n`, ç”±ç¦»æ•£ Maclaurin å…¬å¼å’Œ `k` é˜¶å·®åˆ†å…¬å¼
  <span class="formula">
    `S(n,k) = 1/k! {:Delta_x^k x^n|_(x=0)`
    `= 1/k! sum_(i=0)^k (k;j) (-1)^j (k-j)^n`.
  </span>
</p>

<p class="proposition">
  <b>ç»„åˆæ„ä¹‰</b>
  `n` å…ƒé›†åˆ° `k` å…ƒé›†çš„æ»¡å°„æ•°ç­‰äº `k! S(n, k)`.
  æ¢è¨€ä¹‹, å°† `n` å…ƒé›†åˆ’åˆ†ä¸º `k` ä»½, æ¯ä»½ä¸ç©ºçš„æ–¹æ³•æ•°ä¸º `S(n, k)`.
</p>

<p class="proof">
  åº”ç”¨å®¹æ–¥åŸç†, `n` å…ƒé›†åˆ° `k` å…ƒé›†çš„æ»¡å°„æ•°ç›®ç­‰äºå…¨éƒ¨æ˜ å°„ `k^n`,
  å‡å»æœ‰ä¸€ä¸ªå…ƒç´ æ— åŸåƒçš„æƒ…å½¢ `(k;1) (k-1)^n`,
  å†åŠ ä¸Šæœ‰ä¸¤ä¸ªå…ƒç´ æ— åŸåƒçš„æƒ…å½¢ `(k;2) (k-2)^n`,
  å†å‡å»æœ‰ä¸‰ä¸ªå…ƒç´ æ— åŸåƒçš„æƒ…å½¢... æœ€ç»ˆå¾—åˆ°
  <span class="formula">
    `sum_(j=0)^k (k;j) (-1)^j (k-j)^n = k! S(n, k)`.
  </span>
</p>

<ol class="proof">
  å‡è®¾å°† `n` å…ƒé›†åˆ’åˆ†ä¸º `k` ä»½, æ¯ä»½ä¸ç©ºçš„æ–¹æ³•æ•°ä¸º `T(n, k)`,
  ä¸‹è¯ `T(n, k)` å’Œ `S(n, k)` æ»¡è¶³ç›¸åŒçš„é€’æ¨å…¬å¼, ä»è€Œ `T(n, k) = S(n, k)`.
  äº‹å®ä¸Š, æ˜¾ç„¶æœ‰ `T(n, n) = 1`, `T(n, 1) = 1`.
  æ¥ä¸‹æ¥è€ƒè™‘ `n` å…ƒé›†ä¸­çš„å›ºå®šå…ƒç´  `x_0`,
  <li>è‹¥ `x_0` åœ¨åˆ’åˆ†ä¸­ç‹¬å ä¸€ä»½ (ä½å•äººé—´, æ²¡æœ‰å®¤å‹),
    åªéœ€å†å°†å‰©ä¸‹çš„ `n-1` ä¸ªå…ƒç´ åˆ†ä¸º `k-1` ä»½, æ–¹æ³•æ•°ä¸º `T(n-1, k-1)`;
  </li>
  <li>è‹¥ `x_0` åœ¨åˆ’åˆ†ä¸­ä¸æ˜¯ç‹¬å ä¸€ä»½, åªéœ€å°†å‰©ä¸‹çš„ `n-1` ä¸ªå…ƒç´ åˆ†ä¸º `k` ä»½,
    ç„¶åé€‰æ‹©ä¸€ä»½å°† `x_0` åŠ å…¥å…¶ä¸­ (é€‰æ‹©ä¸€ä¸ªæˆ¿é—´å…¥ä½), æ–¹æ³•æ•°ä¸º `k T(n-1, k)`.
  </li>
  ç»¼ä¸Š `T(n, k) = T(n-1, k-1) + k T(n-1, k)`, æ°å¥½æ»¡è¶³ `S(n, k)` çš„é€’æ¨å…¬å¼.
</ol>

<p class="proof">
  `n` å…ƒé›†åˆ° `k` å…ƒé›†çš„æ˜ å°„, ç›¸å½“äº `n` å…ƒé›†åˆ° `j` å…ƒé›†çš„æ»¡å°„æ€»å’Œ, `j = 0, 1, cdots, k`:
  <span class="formula">
    `k^n = sum_(j=0)^k (k;j) S'(n, j)`,
  </span>
  åæ¼”å¾—
  <span class="formula">
    `S'(n, k) = sum_(j=0)^k (k;j) (-1)^(k-j) j^n`,
  </span>
  å› æ­¤ `S'(n, k) = k! S(n, k)`.
</p>

<p class="proposition">
	<b>ç­‰å¹‚æ±‚å’Œ</b>
	è®° `(:n;k:) = S(n,k) k!`, `S_n(x) = sum_(i=1)^x i^n`.  åˆ™
	<span class="formula">
		`S_n(x) = sum_(k=0)^n (:n;k:) (x+1; k+1)`, `quad n ge 1`.
	</span>
	å…³äºç¬¬ä¸€ç±»å’Œç¬¬äºŒç±» Bernoulli æ•°, åˆ†åˆ«æœ‰
	<span class="formula">
		`B_n^(-) = sum_(k=0)^n (:n;k:) (-1)^k/(k+1)`, `quad n ge 0`,<br/>
		`B_n^(+) = sum_(k=0)^n (:n;k:) (-1)^(k-1)/(k(k+1))`, `quad n ge
		1`.
	</span>
</p>

<p class="proof">
	ç”±ç¬¬äºŒç±» Stirling æ•°å®šä¹‰
	<span class="formula">
		`i^n = sum_(k=0)^n (:n;k:) (i;k)`,
	</span>
	ä¸¤è¾¹ä»¤ `i` ä» `0` åˆ° `x` æ±‚å’Œå°±å¾—åˆ°ç¬¬ä¸€å¼.
	å†å’Œ Bernoulli æ•°çš„å…¬å¼
	<span class="formula">
		`S_n(x) = 1/(n+1) sum_(k=0)^n (n+1;k) B_k^(+) x^(n+1-k)`
	</span>
	æ¯”è¾ƒä¸€æ¬¡é¡¹ç³»æ•°, å°±å¾—åˆ° `B_n^(+)` çš„è¡¨è¾¾å¼.
	åŒç†æ¯”è¾ƒ
	<span class="formula">
		`S_n(x-1) = sum_(k=0)^n (:n;k:) (x;k+1)`, `quad n ge 1`,<br>
		`S_n(x-1) = 1/(n+1) sum_(k=0)^n (n+1;k) B_k^(-) x^(n+1-k)`,
		`quad n ge 1`
	</span>
	çš„ä¸€æ¬¡é¡¹ç³»æ•°å¾—
	<span class="formula">
		`B_n^(-) = sum_(k=0)^n (:n;k:) (-1)^k/(k+1)`, `quad n ge 1`.
	</span>
	å®¹æ˜“éªŒè¯ä¸Šå¼å¯¹ `n=0` ä¹Ÿæˆç«‹.
</p>

<p class="example">
  <b>Bell æ•°</b>
  `B_n` æ˜¯ `n` å…ƒé›†åˆä¸Šçš„æ‰€æœ‰ç­‰ä»·å…³ç³»æ•°, è€ƒè™‘ç¬¬äºŒç±» Stirling æ•°çš„ç»„åˆæ„ä¹‰, æœ‰
  <span class="formula">
    `B_n = sum_(k=0)^n S(n, k)`,
  </span>
  å³ Bell æ•°ç­‰äºç¬¬äºŒç±» Stirling æ•°ç³»æ•°ä¸‰è§’å½¢çš„è¡Œå’Œ.
  Bell æ•°çš„æŒ‡æ•°å‹ç”Ÿæˆå‡½æ•°æ˜¯
  <span class="formula">
    `exp("e"^x-1) = sum_(n ge 0) B_n/n! x^n`.
  </span>
  å®ƒè¿˜æ»¡è¶³ç­‰å¼
  <span class="formula">
    `B_k = 1/"e" sum_(n ge 0) n^k/n!`.
  </span>
</p>

<ol class="proof">
  <li>
    è€ƒè™‘ `n` å…ƒé›†åˆçš„ä¸€ä¸ª `k`-åˆ’åˆ†, å…¶ä¸­ç¬¬ `j` ä¸ªç­‰ä»·ç±»æœ‰ `a_j` ä¸ªå…ƒç´ , äºæ˜¯ `sum_(j=1)^k a_j = n`,
    åˆ©ç”¨å¤šé¡¹ç»„åˆæœ‰:
    <span class="formula">
      `B_n = sum_(k ge 0) 1/k! sum_(sum a_j = n) n!/(prod_j a_j!)`.
    </span>
    äºæ˜¯
    <span class="formula align">
      `sum_(n ge 0) B_n/n! x^n`<br>
      `= sum_(k ge 0) 1/k! sum_(n ge 0) sum_(sum a_j = n) prod_j x^(a_j)/{:a_j:}!`<br>
      `= sum_(k ge 0) 1/k! (sum_(i ge 1) x^i/i!)^k`<br>
      `= exp("e"^x - 1)`.
    </span>
  </li>
  <li>
    åœ¨ç”Ÿæˆå‡½æ•°ä¸¤è¾¹åŒä¹˜ `"e"`, å¾—åˆ°
    <span class="formula">
      `sum_(k ge 0) (B_k "e")/k! x^k`
      `= exp("e"^x)`
      `= sum_(n ge 0) sum_(k ge 0) (n x)^k/(n! k!)`
      `= sum_(k ge 0) x^k/k! sum_(n ge 0) n^k/n!`.
    </span> 
    æ¯”è¾ƒå³å¾—ç»“è®º.
  </li>
</ol>

<p class="remark">
  Bell æ•°ä¸ Bernoulli æ•°çš„è®°å·ç›¸è¿‘, è¯·æ³¨æ„åŒºåˆ†. å¯¹äº Bell æ•°, ä¹Ÿè®¸æ›´å¥½çš„è®°å·æ˜¯ `ğŸ””_n`.
</p>

<p class="theorem">
  [æ¥è‡ª <a href="" target="_blank">OI Wiki</a>]
  <b>exp çš„ç»„åˆæ„ä¹‰</b>
  å¦‚æœ `f_n, g_n` åˆ†åˆ«æ˜¯ä¸ `n` å…ƒé›†åˆæœ‰å…³çš„ä¸¤ä¸ªè®¡æ•°åºåˆ—, å…¶æŒ‡æ•°å‹ç”Ÿæˆå‡½æ•°ä¸º
  <span class="formula">
    `F(x) = sum_(n ge 0) f_n x^n/n!`,<br>
    `G(x) = sum_(n ge 0) g_n x^n/n!`.
  </span>
  å¦‚æœ `F, G` æ»¡è¶³
  <span class="formula">
    `F(0) = 0`, `G(0) = 1`, `G(x) = exp F(x)`,
  </span>
  åˆ™ `g_n` çš„ç»„åˆæ„ä¹‰æ˜¯:
  <span class="formula">
    å…ˆå°† `n` å…ƒé›†åˆåˆ’åˆ†æˆè‹¥å¹²ä¸ªä¸ç›¸äº¤å­é›†, å†å¯¹æ¯ä¸ªå­é›†åº”ç”¨è®¡æ•°åºåˆ— `f_n`.
  </span>
</p>

<ol class="example">
  <li>
    è¦äº§ç”Ÿ `n` å…ƒé›†åˆçš„ä¸€ä¸ªå…¨æ’åˆ—, å¯ä»¥å…ˆå°†å®ƒåˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªä¸ç›¸äº¤å­é›†, å†ç¡®å®šæ¯ä¸ªå­é›†ä¸Šçš„è½®æ¢.
    ç„¶è€Œ `n` å…ƒé›†åˆçš„å…¨æ’åˆ—æ•°ç­‰äº `g_n = n!`, è½®æ¢æ•° `f_n = (n-1)!`,
    ç›¸åº”çš„æŒ‡æ•°å‹ç”Ÿæˆå‡½æ•°åˆ†åˆ«æ˜¯ `1//(1-x)` å’Œ `ln(1//(1-x))`.
  </li>
  <li>
    åˆæ¯”å¦‚è¦äº§ç”Ÿ `n` å…ƒé›†åˆçš„ä¸€ä¸ªåˆ’åˆ†, å¯ä»¥å…ˆå°†å®ƒåˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªä¸ç›¸äº¤å­é›†, ç„¶åä»€ä¹ˆä¹Ÿä¸åš!
    äºæ˜¯ `g_n = B_n` (Bell æ•°), `f_n = 1`,
    æŒ‡æ•°å‹ç”Ÿæˆå‡½æ•°æ˜¯ `exp("e"^x - 1)` å’Œ `"e"^x - 1`. (æ³¨æ„æ¡ä»¶ `F(0) = 0`).
  </li>
  <li>é”™æ’ `sigma` æ˜¯æŒ‡æ»¡è¶³ `sigma(i) != i`, `i = 1, cdots, n` çš„æ’åˆ—.
    å°†é”™æ’åˆ†è§£ä¸ºè½®æ¢, å…¶ä¸å«æœ‰ 1-è½®æ¢. å› æ­¤é”™æ’æ•°çš„ç”Ÿæˆå‡½æ•°ä¸º
    <span class="formula">
      `exp(ln(1//(1-x)) - x)`
      `= exp(sum_(n ge 2) x^n/n)`.
    </span>
  </li>
</ol>

<h3>ç¬¬ä¸€ç±» Stirling æ•°</h3>

<pre>
          1
        0   1
      0   1   1
    0   2   3   1
  0   6   11  6   1
0   24  50  35  10   1
</pre>

<p class="remark">
éªŒç®—:
<span class="formula">
`[
  1;
  0, 1;
  0, 1, 1;
  0, 1, 3, 1;
  0, 1, 7, 6, 1;
  0, 1, 15, 25, 10, 1;
]

[
  1;
  0, 1;
  0, -1, 1;
  0, 2, -3, 1;
  0, -6, 11, -6, 1;
  0, 24, -50, 35, -10, 1;
] = bm I`
</span>
</p>

<p class="proposition">
  <b>é€’æ¨å…¬å¼</b>
  <span class="formula">
    `s(n, k) = {
      1, if n = k;
      0, if n gt 0 and k = 0;
      s(n-1, k-1) + (n-1) s(n-1, k), otherwise;
    :}`
  </span>
  ç¬¬ä¸€ç±» Stirling æ•°æ²¡æœ‰å®ç”¨çš„é€šé¡¹å…¬å¼.
</p>

<h2>Euler æ•°</h2>

<p class="definition">
  <b>Euler æ•°</b> å¯¹æ­£æ•´æ•° `n` å’Œ æ­£æ•´æ•° `k le n`,
  <span class="formula">
    `A_(n, k) = {
      1, if n = 1 or k = n;
      (n-k+1) A_(n-1,k-1) + k A_(n-1, k), otherwise;
    :}`
  </span>
  è¡¨ç¤º `1~n` çš„æ’åˆ—ä¸­, æ°æœ‰ `k-1` ä¸ªç›¸é‚»é€†åºå¯¹çš„æ’åˆ—æ•°.
  æ¯”å¦‚ `1, 3, 5, 4, 2` ä¸­, `(5, 4)`, `(4, 2)` æ˜¯ä¸¤ä¸ªç›¸é‚»é€†åºå¯¹.
  ç”±å®šä¹‰ `sum_(k=1)^n A_(n, k) = n!`.
</p>

<pre>
          1
        1   1
      1   4   1
    1  11  11   1
  1  26  66  26   1
1  57 302 302  57   1
</pre>

<p class="proposition">
  [æ¥è‡ª è¯—è®¸] å¤šé¡¹å¼çš„åŸºåº•è¡¨ç¤º
  <span class="formula">
    `x^n = sum_(k=1)^n (x+k-1; n) A_(n, k)`.
  </span>
  æ­¤å…¬å¼ä¸¤è¾¹å¯¹ `n` æ±‚å’Œå³å¾—åˆ°åˆä¸€ä¸ªç­‰å¹‚æ±‚å’Œå…¬å¼.
</p>

<p class="proof">
  å½’çº³è¯æ˜. `n = 1` æ—¶ `x = (x+1-1; 1) A_(1, k)` æˆç«‹.
  å‡è®¾å‘½é¢˜å¯¹ `n` æˆç«‹, è€ƒè™‘ `n+1` çš„æƒ…å½¢:
  <span class="formula align">
    `sum_(k=1)^(n+1) (x+k-1; n+1) A_(n+1, k)`<br>
    `= (x; n+1) + (x+n; n+1)`
    `+ sum_(k=2)^n (x+k-1; n+1)[(n-k+2) A_(n,k-1) + k A_(n, k)]`<br>
    `= (x; n+1) + (x+n; n+1)`
    `+ sum_(k=1)^(n-1) (x+k; n+1) (n-k+1) A_(n,k) + sum_(k=2)^n (x+k-1; n+1) k A_(n,k)`<br>
    `= (x; n+1) + (x+n; n+1) + (x+1; n+1) n + (x+n-1; n+1) n`
    `+ sum_(k=2)^(n-1) A_(n,k) (x+k-1; n)((x+k)(n-k+1)
    + k(x+k-n-1))/(n+1)`<br>
    `= sum_(k=1)^n A_(n, k) (x+k-1; n) x`<br>
    `= x^(n+1)`.
  </span>
</p>

<p class="proposition">
  Euler æ•°çš„æ˜¾å¼è¡¨è¾¾å¼ä¸º
  <span class="formula">
    `A_(n, k) = sum_(j=0)^k (n+1; j) (-1)^j (k-j)^n`.
  </span>
</p>

<div class="p proof">
  ç›´æ¥ä»£å…¥é€’æ¨å¼éªŒè¯:
  <span class="formula">
    `A_(n, 1) = (n+1; 0) 1^n - (n+1; 1) 0^n = 1`,<br>
    `A_(n, n) = sum_(j=0)^n (-1)^j (n+1; j) (n-j)^n = 1`.<sup>[æ³¨]</sup>
  </span>
  ä¸”
  <span class="formula align">
    `(n-k+1) A_(n-1, k-1) + k A_(n-1, k)`<br>
    `= -(n-k+1) sum_(j=1)^k (-1)^j (n; j-1) (k-j)^(n-1)`
    `+ k^n + k sum_(j=1)^k (-1)^j (n;j) (k-j)^(n-1)`<br>
    `= k^n - sum_(j=1)^k (-1)^j (n+1)(n; j-1) (k-j)^(n-1)`
    `+ sum_(j=1)^k (-1)^j k (n+1; j) (k-j)^(n-1)`<br>
    `= sum_(j=0)^k (-1)^j (n+1; j) (k-j)^n`<br>
    `= A_(n, k)`.
  </span>
  <hr>
  <b>æ³¨</b> [æ¥è‡ª ç ´å£äººäº”å·] è®° `x_k = k^n`, å› ä¸ºå®ƒæ˜¯ `n` æ¬¡å¤šé¡¹å¼,
  æ•…å®ƒåœ¨åŸç‚¹çš„ `n+1` é˜¶å·®åˆ†ä¸ºé›¶, å³
  <span class="formula">
    `Delta^(n+1) x_0 = sum_(j=0)^(n+1) (n+1;j) (-1)^j (n-j)^n = 0`,
  </span>
  ä»è€Œ `A_(n,n) = 1`.
</div>

<h2>æ‚ä¾‹</h2>

<ol class="example p">
  <b>å“¥éš†å°º (Golomb ruler)</b>
  [<a href="https://oeis.org/A004137" target="_blank">OEIS A004137</a>]
  [<a href="https://blog.sciencenet.cn/blog-420554-1198462.html" target="_blank">ç§‘å­¦ç½‘ ä¸€æŠŠæ•°å­¦çš„å°ºå­ å“¥éš†å°º</a>]<br>
  å°ºå­ä¸Šé¢æœ‰ `m` ä¸ªæ•´æ•°åˆ»åº¦ `x_1, cdots, x_m in ZZ`,
  ç°åœ¨ç»™å‡ºä¸¤ä¸ªæ¡ä»¶:
  <li>è¿™å°ºå­å¯ä»¥é‡å‡º `0` åˆ° `n` ä¹‹é—´çš„æ‰€æœ‰æ•´æ•°é•¿åº¦, å³ `[0..n] sube {|x_i - x_j|: i, j in [1..m]}`;</li>
  <li>æ¯ä¸ªæ•´æ•°é•¿åº¦æ²¡æœ‰å¤šäºä¸€ç§æµ‹é‡æ–¹æ³•, å³ `AA i, j, k, l in [1..m]`, `x_i - x_j = x_k - x_l iff i = k and j = l`;</li>
  å¦‚æœå°ºå­æ»¡è¶³æ¡ä»¶ 2, åˆ™ç§°å®ƒä¸ºå“¥éš†å°º, å¦‚æœåŒæ—¶æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶, åˆ™ç§°ä¸ºå®Œç¾å“¥éš†å°º. å°ºå­é•¿åº¦å¤§äº 6 æ—¶ä¸å­˜åœ¨å®Œç¾å“¥éš†å°º.
  <br>
  é—®é¢˜: è‹¥å°ºå­æ»¡è¶³æ¡ä»¶ 1, æ±‚å°ºå­é•¿åº¦ `n` çš„æœ€å¤§å€¼.
</ol>

<div class="solution" id="exp-golomb-solution">
è¿™æ˜¯ä¸€ä¸ªå›°éš¾çš„é—®é¢˜, é™„æš´åŠ›ç¨‹åº:
<pre>
from itertools import combinations

def check(t, n):
    s = set(abs(t[i] - t[j]) for i in range(len(t)) for j in range(i, len(t)))
    s = s.union(t)
    s = s.union(n-v for v in t)
    return len(s) == n

# è¾“å…¥å°ºå­é•¿åº¦ n, æ±‚æœ€å°çš„ k ä½¿å¾—å°ºå­èƒ½é‡å‡º [0..n] çš„æ‰€æœ‰é•¿åº¦
def golomb(n, mink=1):
    if n &lt; 3:
        return n+1
    for k in range(mink, n-1):
        for t in combinations(range(1,n), k):
            if check(t, n):
                print(0, *t, n)
                return len(t)+2
    return -1

print(golomb(6))
</pre>
å¾—åˆ°çš„å‰å‡ ä¸ªå°ºå­:
</div>

<p class="example">
  [æ¥è‡ªç¾¤å‹ å…‰ç»ªä¸‰åä¸€å¹´é’¦ç‚¹çš„æ­¦ä¸¾äºº,
  <a href="https://math.stackexchange.com/questions/3259887/distribution-of-matrix-rank-over-finite-fields" target="_blank">MSE</a>]
  æœ‰é™åŸŸ `bbb F_q` ä¸Š, `n xx n` å¯é€†çŸ©é˜µçš„æ•°ç›®æ˜¯
  <span class="formula">
    `prod_(k=0)^(n-1) (q^n - q^k)`.
  </span>
  ç§©ä¸º `k` çš„ `n xx m` çŸ©é˜µçš„æ•°ç›®è®°ä¸º `R_k(n, m)`, å®ƒæ»¡è¶³é€’æ¨å¼
  <span class="formula">
    `R_k(n, m) = R_k(n-1, m) * q^k + R_(k-1)(n-1, m) * (q^m - q^(k-1))`,
  </span>
  å’Œè¾¹ç•Œæ¡ä»¶
  <span class="formula">
    `R_k(n, m) = {1, if k = 0; 0, if k gt min(n, m):}`,
  </span>
  äºæ˜¯
  <span class="formula">
    `R_k(n, m) = [n;k]_q [m;k]_q [k]_q ! q^((k;2)) (q-1)^k`.
  </span>
  å…¬å¼æ¶‰åŠ q-binomial å’Œ q-factorial.
</p>

<ol class="proof">
  è¯æ˜è‰ç¨¿:
  <li>
    ç¬¬ä¸€è¡Œä¸ä¸ºé›¶å‘é‡å³å¯; ç¬¬äºŒè¡Œä¸èƒ½ç­‰äºç¬¬ä¸€è¡Œçš„å€æ•°, å…±æ’é™¤ `q` ä¸ªå‘é‡;
    ç¬¬ä¸‰è¡Œä¸èƒ½ç­‰äºå‰ä¸¤è¡Œçš„çº¿æ€§ç»„åˆ, å…±æ’é™¤ `q^2` ä¸ªå‘é‡â€¦â€¦
  </li>
  <li>ä¸€ä¸ªç§© `k` çš„ `n xx m` çŸ©é˜µæœ‰ä¸¤ç§æƒ…å†µ:
    ä¸€æ˜¯å‰ `n-1` è¡Œçš„ç§©ä¸º `k`, è¿™æ—¶æœ€åä¸€è¡Œæ˜¯å®ƒä»¬çš„çº¿æ€§ç»„åˆ;
    äºŒæ˜¯å‰ `n-1` çš„ç§©ä¸º `k-1`, è¿™æ—¶æœ€åä¸€è¡Œä¸å®ƒä»¬çº¿æ€§æ— å…³.
  </li>
  <hr>
  `QQ` ä¸Šçš„ `n` é˜¶å¯é€†çŸ©é˜µæ•°ç›®å‚è§ <a href="https://oeis.org/A055165" target="_blank">OEIS A055165</a>.
</ol>

<p class="example">
  <b>Goldbach å®šç†</b>
  [æ¥è‡ª <a href="https://sites.math.rutgers.edu/~zeilberg/goldbach.pdf" target="_blank">A Proof of the Celebrated Goldbach's Theorem</a>]
  è®¾ `P` æ˜¯å…¨ä½“å®Œç¾å¹‚æ•° (perfect power number) çš„é›†åˆ:
  <span class="formula">
    `P := { m^n: m, n in ZZ^+, m ge 2, n ge 2 }`.
  </span>
  è¯æ˜:
  <span class="formula">
    `sum_(x in P) 1/(x-1) = 1`.
  </span>
</p>

<p class="proof">
  è®° `R = ZZ^+ - P - {1}`. äºæ˜¯ä»»æ„ `ge 2` çš„æ­£æ•´æ•° `n` å¯ä»¥å”¯ä¸€åœ°å†™ä¸º `r^s`, (`r in R, s ge 1`),
  å…¶ä¸­ `n in P` å½“ä¸”ä»…å½“ `s ge 2`. åˆ©ç”¨å‡ ä½•çº§æ•°è®¡ç®—:
  <span class="formula">
    `sum_(x in P) 1/(x-1)`
    `= sum_(r in R) sum_(s ge 2) 1/(r^s - 1)`
    `= sum_(r in R) sum_(s ge 2) sum_(i ge 1) 1/r^(s i)`
    `= sum_(r in R) sum_(i ge 1) sum_(s ge 2) 1/r^(i s)`
    `= sum_(r in R) sum_(i ge 1) (1//r^i)^2/(1-1//r^i)`
    `= sum_(r in R) sum_(i ge 1) 1/(r^i(r^i-1))`
    `= sum_(n ge 2) 1/(n(n-1))`
    `= sum_(n ge 2) (1/(n-1) - 1/n)`
    `= 1`.
  </span>
</p>


<script src="../../js/note.js?type=math"></script>
<script src="../../js/table.js"></script>
<script>
Table.create({
  parent: document.getElementById('exp-golomb-solution'),
  data: [
    [1, '0', '0'],
    [2, 1, '0 1'],
    [3, 3, '0 1 3'],
    [4, 6, '0 1 4 6'],
    [5, 9, '0 1 2 6 9'],
    [6, 13, '0 1 2 6 10 13'],
    [7, 17, '0 1 2 3 8 13 17'],
    [8, 23, '0 1 2 11 15 18 21 23'],
    [9, 29, '0 1 2 14 18 21 24 27 29'],
    [10, 36, '0 1 3 6 13 20 27 31 35 36'],
  ],
  columns: [0, 1, 2],
  heads: ['åˆ»åº¦æ•°', 'å°ºå­é•¿åº¦', 'å¯èƒ½çš„åˆ»åº¦'],
})
</script>
</body>
</html>
