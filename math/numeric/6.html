<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <title>çŸ©é˜µä¸çº¿æ€§æ–¹ç¨‹ç»„</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" type="text/css" href="../../css/note.css" />
</head>
<body>
<script defer>
/* å…¬å…±å‡½æ•° */
var round = (x, digits) => {
  const pow = Math.pow(10, digits)
  return Math.round(x * pow) / pow
}
</script>

<h2>çŸ©é˜µèŒƒæ•°</h2>

<h2>æ¶ˆå…ƒæ³•</h2>

<ol class="algorithm">
  <b>Gauss æ¶ˆå…ƒ</b> è®¾ `bm A` æ˜¯ `n` é˜¶å¯é€†å®æ–¹é˜µ, `bm b` æ˜¯ `n` ç»´åˆ—å‘é‡.
  ç”¨å¦‚ä¸‹æ­¥éª¤æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„ `bm (A x) = bm b`:
  <li>å°†çŸ©é˜µ `bm A` ä¸ `bm b` åˆæˆä¸€ä¸ªå¢å¹¿çŸ©é˜µ `[bm A, bm b]`.</li>
  <li>ä» `bm A` çš„ç¬¬ä¸€åˆ—æ‰¾åˆ°ç»å¯¹å€¼æœ€å¤§çš„å…ƒç´  `p = a_(i 1)`, ç§°ä¸ºåˆ—ä¸»å…ƒ.
    ç”±äº `bm A` å¯é€†, `|p| gt 0`.
  </li>
  <li>å°†å¢å¹¿çŸ©é˜µçš„ç¬¬ä¸€è¡Œä¸ç¬¬ `i` è¡Œäº¤æ¢, ä½¿å¾—åˆ—ä¸»å…ƒå æ®å·¦ä¸Šè§’çš„ä½ç½®.</li>
  <li>å¯¹ç¬¬ä¸€åˆ—è¿›è¡Œ Gauss æ¶ˆå…ƒ.
    å°†å¢å¹¿çŸ©é˜µç¬¬ä¸€è¡Œçš„ `-a_(i 1)//p` å€åŠ åˆ°ç¬¬ `i` è¡Œ, `i = 2, cdots, n`, ä½¿å¾—çŸ©é˜µç¬¬ä¸€åˆ—é™¤ç¬¬ä¸€è¡Œå¤–å…¨ä¸ºé›¶, å½¢å¦‚
    <span class="formula">
      `[p, ast, ast;
      0, bm A_2, bm b_2]`.
    </span>
  </li>
  <li>ç»§ç»­å¯¹å³ä¸‹è§’çš„çŸ©é˜µ `[bm A_2, bm b_2]` ä½¿ç”¨å‰é¢çš„æ­¥éª¤, é€‰ä¸»å…ƒå¹¶æ¶ˆå…ƒ,
    æœ€ç»ˆçŸ©é˜µåŒ–ä¸º `[bm R, bm c]`, å…¶ä¸­ `bm R` æ˜¯ä¸Šä¸‰è§’çŸ©é˜µ, å¯¹è§’å…ƒéé›¶.
  </li>
  <li>ä½¿ç”¨ä»£å…¥æ³•è½»æ¾æ±‚è§£ä¸Šä¸‰è§’å½¢çš„æ–¹ç¨‹ç»„ `bm (R x) = bm c`:
    <span class="formula">
      `x_n = c_n//r_(n n)`,<br>
      `x_i = (c_i - sum_(j=i+1)^n r_(i j) x_j) // r_(i i)`,
      `quad i = n-1, cdots, 1`.
    </span>
  </li>
  æ—¶é—´å¤æ‚åº¦: `O(n^3)`.
</ol>

<div class="playground" type="textarea" value="[
  [1,2,3,4],
  [4,3,2,1],
  [1,-1,2,6]
]" value2="[
  [0.02, 0.01, 0, 0, 0.02],
  [1, 2, 1, 0, 1],
  [0, 1, 2, 1, 4],
  [0, 0, 100, 200, 800]
]">
<script type="text">
module.exports = function GaussElimination (str) {
  const mat = Playground.parse(str)
  return new Mat(mat).gaussSolve({ verbose: true }).map(v => round(v, 6))
}
</script>
</div>

<p class="algorithm">
  <b>æ±‚çŸ©é˜µçš„ç§©</b>
  æ¨¡ä»¿ Gauss æ¶ˆå…ƒçš„æµç¨‹, ä½†åªéœ€åŒ–ä¸ºä¸Šä¸‰è§’çŸ©é˜µå³å¯, ä¸éœ€è¦ä»£å…¥çš„æ­¥éª¤.
</p>

<div class="playground" type="textarea" value="[
  [1, 1],
  [1, 1],
  [1, 1]
]">
<script type="text">
module.exports = function (str) {
  const mat = Playground.parse(str)
  return new Mat(mat).rank()
}
</script>
</div>

<ol class="algorithm">
  <b>ä¸€èˆ¬æ¶ˆå…ƒæ³•</b>
  å¯¹ä»»æ„å®çŸ©é˜µ `bm A_(m xx n)` å’Œä»»æ„ `n` ç»´å‘é‡ `bm b` æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„ `bm (A x) = bm b`.
  <li>é€‰ä¸»å…ƒ. å’Œ Gauss æ¶ˆå…ƒä¸€æ ·, ä»å¢å¹¿çŸ©é˜µ `[bm A, bm b]` å¼€å§‹, éå† `bm A` çš„å„åˆ—,
    é€‰å‡ºå½“å‰åˆ—çš„ç»å¯¹å€¼æœ€å¤§è€…ä½œä¸ºåˆ—ä¸»å…ƒ (è·³è¿‡é‚£äº›å·²è¢«é€‰ä¸ºä¸»å…ƒçš„è¡Œ).
  </li>
  <li>æ¶ˆå…ƒæ­¥éª¤.
    è®°ç¬¬ `j` åˆ—çš„ä¸»å…ƒæ˜¯ `p = a_(i j)`. é¦–å…ˆå°†ç¬¬ `i` è¡ŒåŒä¹˜ä»¥ `1//p` ä½¿ä¸»å…ƒåŒ–ä¸º 1, å†å°†è¿™ä¸€è¡Œçš„
    `-a_(k j)` å€åŠ åˆ°ç¬¬ `k` è¡Œ, `k = 1, cdots, i-1, i+1, cdots, m`.
    è¿™æ ·æ“ä½œå, ç¬¬ `j` åˆ—é™¤ä¸»å…ƒæ‰€åœ¨è¡Œç­‰äº 1 ä»¥å¤–, å…¶ä½™å…ƒç´ å‡ä¸º 0.
  </li>
  <li>é€€åŒ–æƒ…å½¢. å½“ç„¶, æœ‰å¯èƒ½æŸä¸€åˆ—çš„å…ƒç´ å…¨ä¸º 0, æˆ–è€…çŸ©é˜µçš„æ¯ä¸€è¡Œéƒ½å·²ç»é€‰å‡ºä¸»å…ƒ,
    å¯¼è‡´å½“å‰åˆ—ä¸å­˜åœ¨æœ‰æ•ˆä¸»å…ƒ. åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹, ä¸èƒ½è¿›è¡Œ 2. çš„æ¶ˆå…ƒæ­¥éª¤.
    å¦‚æœæŸä¸€åˆ—é€‰ä¸å‡ºæœ‰æ•ˆä¸»å…ƒ, å°±ç§°è¿™ä¸€åˆ—å¯¹åº”çš„æœªçŸ¥æ•°ä¸ºéåŸºå˜é‡, å¦åˆ™ç§°ä¸ºåŸºå˜é‡.
  </li>
  <li>è§£çš„å­˜åœ¨.
    ç†æƒ³æƒ…å†µä¸‹, è‹¥ `bm A` è¡Œæ»¡ç§©, åˆ™æ¯ä¸€è¡Œéƒ½èƒ½é€‰å‡ºä¸€ä¸ªä¸»å…ƒ.
    å¦åˆ™, éœ€è¦æ£€æŸ¥æœªèƒ½é€‰å‡ºä¸»å…ƒçš„é‚£äº›è¡Œ, å¦‚æœè¯¥è¡Œçš„å¸¸æ•°é¡¹ä¸ä¸º 0, åˆ™æ–¹ç¨‹æ— è§£.
  </li>
  <li>æ±‚è§£æ­¥éª¤.
    è‹¥æ–¹ç¨‹æœ‰è§£, æŠŠåŸºå˜é‡ç•™åœ¨æ–¹ç¨‹å·¦è¾¹, éåŸºå˜é‡ç§»åŠ¨åˆ°æ–¹ç¨‹å³è¾¹.
    æ¯ä¸ªåŸºå˜é‡çš„ç³»æ•°æ°å¥½éƒ½æ˜¯ 1, æ–¹ç¨‹å½¢å¦‚
    <span class="formula">
      `bm (I x_1) = bm c - bm (B x_2)`,
    </span>
    å…¶ä¸­ `bm x_1, bm x_2` åˆ†åˆ«ä¸ºåŸºå˜é‡å’ŒéåŸºå˜é‡, `bm c` æ˜¯å¸¸æ•°é¡¹, `bm B` æ˜¯éåŸºå˜é‡çš„ç³»æ•°çŸ©é˜µ.
    æ–¹ç¨‹çš„è§£å·²ç»æ˜¾åŒ–å‡ºæ¥:
    <span class="formula">
      `[bm x_1; bm x_2] = [bm c - bm B bm x_2; bm x_2]`,
      `quad` å…¶ä¸­ `bm x_2` å–é `RR^(n-r)`.
    </span>
  </li>
</ol>

<div class="playground" type="textarea" value="[
  [1, -1, 1, -1, 1],
  [1, -1, -1, 1, 0],
  [1, -1, -2, 2, -0.5]
]" value2="[
  [5, 6, -2, 7, 4, 23],
  [2, 3, -1, 4, 2, 12],
  [7, 9, -3, 5, 6, 23],
  [5, 9, -3, 1, 6, 13]
]">
<p>æ³¨: è¾“å‡ºçš„ç¬¬ä¸€åˆ—æ˜¯ç‰¹è§£, åé¢å„åˆ—æ˜¯åŸºç¡€è§£ç³».</p>
<script type="text">
module.exports = function (str) {
  const mat = Playground.parse(str)
  return new Mat(mat).solve({ verbose: true }).toString(6)
}
</script>
</div>

<ol class="algorithm">
  <b>è¿½èµ¶æ³•è§£ä¸‰å¯¹è§’æ–¹ç¨‹ç»„</b> `bm (A x) = bm b`, å…¶ä¸­
  <span class="formula">
    `bm A = [d_1, u_1;
    l_1, d_2, u_2;
    , ddots, ddots, ddots;
    ,, l_(n-1), d_(n-1), u_(n-1);
    ,,, l_(n-1), d_n]`.
  </span>
  è€Œä¸” `bm A` æ˜¯è¡Œå¯¹è§’å ä¼˜çš„, å³ `|d_i|` å¤§äºåŒä¸€è¡Œå…¶å®ƒå…ƒç´ çš„ç»å¯¹å€¼ä¹‹å’Œ.
  è¿½èµ¶æ³•æ­¥éª¤å¦‚ä¸‹:
  <li>è¿½: å¯¹äº `i = 2...n`, ç¬¬ `i` è¡ŒåŠ ä¸Š `i-1` è¡Œçš„åˆé€‚å€æ•°, å°†çŸ©é˜µåŒ–ä¸ºä¸Šä¸‰è§’å½¢.</li>
  <li>èµ¶: å¯¹äº `i = n-1...1`, å°†ç¬¬ `i+1` ä¸ªå˜é‡çš„å€¼ä»£å…¥ç¬¬ `i` è¡Œçš„æ–¹ç¨‹, è§£å‡ºç¬¬ `i` ä¸ªå˜é‡.</li>
  æ—¶é—´å¤æ‚åº¦ `O(n)`.
</ol>

<div class="playground" type="textarea" value="{
  d: [0.6, ...new Array(10).fill(1)],
  u: new Array(10).fill(-0.6),
  l: new Array(10).fill(-0.4),
  b: new Array(11).fill(1),
}">
<script type="text">
module.exports = function chase (str) {
  const { d, u, l, b } = Playground.parse(str)
  const n = d.length
  for (let i = 1; i < n; ++i) {
    const k = l[i-1] / d[i-1]
    d[i] -= k * u[i-1]
    b[i] -= k * b[i-1]
  }
  b[n-1] /= d[n-1]
  for (let i = n-2; i >= 0; --i) {
    b[i] -= b[i+1] * u[i]
    b[i] /= d[i]
  }
  return b.map(v => round(v, 6))
}
</script>
</div>

<h2>è¿­ä»£æ³•</h2>

<p>æœ¬èŠ‚ä»‹ç»çº¿æ€§æ–¹ç¨‹ç»„çš„è¿­ä»£æ±‚è§£. å®ƒä»¬é€šå¸¸æ¯”æ¶ˆå…ƒæ³•æ›´å¿«.</p>

<p>ğŸš§ Jacobiã€Gauss-Seidelã€SOR</p>

<p class="algorithm">
  <b>å…±è½­æ¢¯åº¦æ³• (conjugate gradient method)</b>
  æœ€æ—©ç”±å¾·å›½çš„ Hestenes å’Œ Stiefel äº 1952 å¹´æå‡º,
  é€‚ç”¨äºç³»æ•°çŸ©é˜µå¯¹ç§°æ­£å®šçš„æƒ…å½¢, æ”¶æ•›é€Ÿåº¦è¾ƒä¸Šä¸€èŠ‚çš„ä¸‰ç§è¿­ä»£æ³•æ›´å¿«.
  å®ƒçš„æ€æƒ³åŸºäºæ•°å­¦ç‰©ç†ä¸­çš„<b>å˜åˆ†åŸç†</b>.
  <br>
  ç†ŸçŸ¥äºŒæ¬¡å‡½æ•° `1/2 ax^2 - bx` åœ¨ `x = b/a` å¤„å–å¾—æå°å€¼.
  å°†è¿™ä¸€ç»“æœæ¨å¹¿è‡³ `n` å…ƒå‡½æ•°, æœ‰:
</p>

<p class="theorem">
  è®¾ `bm A` ä¸ºå¯¹ç§°æ­£å®šçŸ©é˜µ. åˆ™æ–¹ç¨‹ç»„ `bm (Ax) = bm b` çš„æ±‚è§£ç­‰ä»·äºæ±‚ä¸‹é¢çš„äºŒæ¬¡æ³›å‡½ (äºŒæ¬¡å‹)
  åœ¨ `RR^n` ä¸Šçš„æå°å€¼:
  <span class="formula">
    `varphi(bm x) = 1/2 (bm (Ax), bm x) - (bm b, bm x)`.
  </span>
</p>

<p class="proof">
  è®¾ `bm x_0` æ˜¯æ–¹ç¨‹ç»„ `bm (Ax) = bm b` çš„è§£, åˆ™æœ‰
  <span class="formula">
    ` varphi(bm x_0) = 1/2 (bm (Ax_0), bm x_0) - (bm b, bm x_0)
    = -1/2 (bm (Ax_0), bm x_0)`.
  </span>
  å¯¹ `AA bm x in RR^n`,
  <span class="formula">
    ` varphi(bm x) - varphi(bm x_0)
    = 1/2 (bm (Ax), bm x) - (bm b, bm x) + 1/2 (bm (Ax_0), bm x_0)`
    `= 1/2 [(bm (Ax, bm x))-2(bm (Ax_0, bm x)) + (bm (Ax_0), bm x_0)]`
    `= 1/2 (bm (A(x - x_0)), bm (x-x_0))
    = 1/2 ||bm x - bm x_0||_(bm A)^2 ge 0`.
  </span>
  ç”± `bm A` çš„æ­£å®šæ€§çŸ¥, `bm x_0` ä¸º `varphi(bm x)` çš„å”¯ä¸€æå°å€¼ç‚¹.
</p>

<h2>çŸ©é˜µåˆ†è§£</h2>

<h3>QR åˆ†è§£</h3>

<p class="algorithm">
  <b>QR åˆ†è§£</b>
  [æ¥è‡ª <a href="https://zhuanlan.zhihu.com/p/362248020" target="_blank">çŸ¥ä¹@Iterator</a>]
  è®¾ `bm A` æ˜¯ `m xx n` å®çŸ©é˜µ, ä¸” `bm A` çš„å„åˆ—å‘é‡çº¿æ€§æ— å…³, åˆ™å­˜åœ¨å”¯ä¸€åˆ†è§£
  <span class="formula">
    `bm A_(m xx n) = bm Q_(m xx n) bm R_(n xx n)`.
  </span>
  å…¶ä¸­ `bm Q` æ»¡è¶³å„åˆ—å‘é‡å•ä½æ­£äº¤, `bm R` æ˜¯ä¸»å¯¹è§’çº¿å…¨ä¸ºæ­£æ•°çš„ä¸Šä¸‰è§’çŸ©é˜µ.
  QR åˆ†è§£ä»¥çŸ©é˜µçš„å½¢å¼, ç¼–ç äº† Schmidt æ­£äº¤åŒ–çš„è®¡ç®—è¿‡ç¨‹.
</p>

<ol class="proof">
  <li>å­˜åœ¨æ€§.
    å¯¹ `bm A` çš„å„åˆ—è¿›è¡Œ Schmidt æ­£äº¤åŒ–, å…¶ä¸­ `k_(i,j) = ((bm a_i, bm b_j))/((bm b_j, bm b_j))`:
    <span class="formula align">
      `bm b_1 = bm a_1`,<br class="noindent">
      `bm b_2 = bm a_2 - k_(2,1) bm b_1`,<br class="noindent">
      `cdots`<br class="noindent">
      `bm b_n = bm a_n - k_(n,1) bm b_1 - k_(n,2) bm b_2 - cdots - k_(n,n-1) bm b_(n-1)`.
    </span>
    å†å•ä½åŒ–,
    <span class="formula">
      `hat bm b_j = bm b_j/|bm b_j|`, `quad j = 1, cdots, n`.
    </span>
    å†™ä¸ºçŸ©é˜µå½¢å¼å°±æ˜¯
    <span class="formula">
      `bm A = (hat bm b_1, cdots, hat bm b_n)[
        |bm b_1|, k_(2,1)|bm b_1|, cdots, k_(n,1)|bm b_1|;
        , |bm b_2|, cdots, k_(n,2)|bm b_2|;
        ,,ddots,vdots;
        ,,,|bm b_n|
      ]`.
    </span>
  </li>
  <li>å”¯ä¸€æ€§.
    è®¾ `bm A` æœ‰ QR åˆ†è§£ `bm A = bm Q_1 bm R_1 = bm Q_2 bm R_2`, ä¸‹è¯ `bm R_1 = bm R_2`.<br>
    ç”±äº `bm Q_1, bm Q_2` çš„å„åˆ—å‘é‡å•ä½æ­£äº¤, æœ‰ `bm Q_1^T bm Q_1 = bm Q_2^T bm Q_2 = bm I`, äºæ˜¯
    <span class="formula">
      `bm R_1^T bm R_1`
      `= bm R_1^T bm Q_1^T bm Q_1 bm R_1`
      `= bm A^T bm A`
      `= bm R_2^T bm Q_2^T bm Q_2 bm R_2`
      `= bm R_2^T bm R_2`.
    </span>
    ä¸Šå¼ä¸¤è¾¹å·¦ä¹˜ `(bm R_2^T)^-1`, å³ä¹˜ `bm R_1^-1` å¾—
    <span class="formula">
      `(bm R_2^T)^-1 bm R_1^T = bm R_2 bm R_1^-1`.
    </span>
    ä¸Šå¼å·¦è¾¹æ˜¯ä¸‹ä¸‰è§’çŸ©é˜µ, å³è¾¹æ˜¯ä¸Šä¸‰è§’çŸ©é˜µ, ä½†ä¸¤è¾¹ç›¸ç­‰, ä»è€Œåªèƒ½æ˜¯å¯¹è§’å½¢çŸ©é˜µ, è®°ä¸º `bm D`. åˆ™ `bm R_2 = bm D bm R_1`.  äºæ˜¯
    <span class="formula">
      `bm R_1^T bm R_1`
      `= bm R_2^T bm R_2`
      `= bm R_1^T bm D^T bm D bm R_1`,
    </span>
    å³ `bm D^T bm D = bm I`.
    æ˜¾ç„¶ `bm D` çš„ä¸»å¯¹è§’çº¿å…¨ä¸ºæ­£, æ•… `bm D = bm I`, å³ `bm R_1 = bm R_2`.
    ä»è€Œ `bm Q_1 = bm A bm R_1^-1 = bm A bm R_2^-1 = bm Q_2`.
  </li>
</ol>

<p class="remark">
  QR åˆ†è§£çš„ Q æºäº orthogonal çš„ O, ä¸ºé¿å…æ··æ·†è€Œå†™ä½œ Q;
  è€Œ R æºäº right triangular matrices.
</p>

<pre>
# sympy æ±‚ QR åˆ†è§£
A.QRdecomposition()
</pre>

<div class="playground" type="textarea" value="[
  [1,1,2],
  [3,4,5],
  [6,7,8]
]" value2="[
  [0,1,2],
  [3,4,5],
  [6,7,8]
]">
<p>æ³¨: è‹¥ `bm A` çš„åˆ—å‘é‡çº¿æ€§ç›¸å…³, åˆ™ `bm Q` å«æœ‰é›¶åˆ—, `bm R` å«æœ‰é›¶è¡Œ.</p>
<script type="text">
module.exports = function QR (str) {
  const mat = Playground.parse(str)
  const [Q, R] = new Mat(mat).QR()
  return Q.toString(6) + '\n\n' + R.toString(6)
}
</script>
</div>

<p class="example">
  åœ¨æœ€å°äºŒä¹˜æ³•ä¸­, å¯¹äºå¯èƒ½æ— è§£çš„å®ç³»æ•°æ–¹ç¨‹ç»„ `bm (A x) = bm b`, ä¸¤è¾¹å·¦ä¹˜ `bm A^T`, è½¬åŒ–ä¸º
  `bm A^T bm A x = bm A^T bm  b`, æˆ‘ä»¬éœ€è¦è®¡ç®—
  <span class="formula">
    `bm x = (bm A^T bm A)^-1 bm A^T bm b`.
  </span>
  å¦‚æœå…ˆå°† `bm A` åˆ†è§£ä¸º `bm A = bm (Q R)`,
  åˆ™ä¸Šå¼åŒ–ä¸º
  <span class="formula">
    `bm x`
    `= (bm R^T bm Q^T bm Q bm R)^-1 bm R^T bm Q^T bm b`
    `= (bm R^T bm R)^-1 bm R^T bm Q^T bm b`
    `= bm R^-1 bm Q^T bm b`.
  </span>
  ä»è€Œå°†å¤æ‚åº¦è¾ƒé«˜çš„çŸ©é˜µæ±‚é€†è¿ç®—, åŒ–ä¸ºè¾ƒå®¹æ˜“çš„ä¸Šä¸‰è§’çŸ©é˜µ `bm R` çš„æ±‚é€†è¿ç®—.
</p>

<p class="algorithm">
  <b>QR åˆ†è§£ (åŸºäº Householder å˜æ¢)</b>
  Householder å˜æ¢æ˜¯æŒ‡é•œé¢åå°„, æˆ–ç§°åå‘æ­£äº¤å˜æ¢.
  å®ƒå¯ä»¥å†™ä¸º `bm H(bm u) = bm I - 2 bm u bm u^T` çš„å½¢å¼, å…¶ä¸­ `bm u` ä¸ºå•ä½å‘é‡.
  ç”±<a href="1.html#exp-householder">è¿™é‡Œ</a>çŸ¥é“, 
  å·²çŸ¥å‘é‡ `bm x` å’Œå•ä½å‘é‡ `bm y`, è¦ä½¿ `bm (H x)` å¹³è¡Œäº `bm y`,
  åªéœ€å– `bm H = bm H(hat bm u)`, å…¶ä¸­
  <span class="formula">
    `bm u = bm x - |bm x| bm y`,
    `quad hat bm u = bm u //|bm u|`.
  </span>
  è®°å®çŸ©é˜µ `bm A` çš„ç¬¬ `j` åˆ—ä¸º `bm a_j`,
  åˆè®° `bm e_i` æ˜¯ç¬¬ `i` ä¸ªåˆ†é‡ä¸º 1, å…¶ä½™åˆ†é‡ä¸º 0 çš„å•ä½å‘é‡.
  å…ˆä½œ Householder å˜æ¢ `bm H_1` ä½¿å¾— `bm (H_1 bm a_1)` å¹³è¡Œäº `bm e_1`,
  å¾—åˆ°
  <span class="formula">
    `bm (H_1 A)`
    `= [|bm a_1|, ast;
    0, bm A_2]`.
  </span>
  å¯¹äºå³ä¸‹è§’çš„ `bm A_2`, ç»§ç»­ä»¥ Householder å˜æ¢ `bm H_2` å°†å®ƒçš„ç¬¬ä¸€åˆ—é™¤ç¬¬ä¸€è¡Œå¤–çš„æ‰€æœ‰å…ƒç´ åŒ–ä¸ºé›¶.
  æœ€ç»ˆå¾—åˆ°ä¸Šä¸‰è§’çŸ©é˜µ `bm R = bm H_n cdots bm H_1 bm A`,
  å…¶ä¸­ `bm Q = bm H_n cdots bm H_1` æ˜¯æ­£äº¤çŸ©é˜µ.
</p>

<h2>ç‰¹å¾å€¼é—®é¢˜</h2>

<p>ä¸‹é¢è¿™ä¸ªå®šç†å¯ä»¥å¸®åŠ©æˆ‘ä»¬ä¼°è®¡ç‰¹å¾å€¼çš„èŒƒå›´:</p>

<p class="theorem">
	<b>Gerschgorin (ç›–å°”) åœ†ç›˜å®šç†</b>
	è®¾ `bm A in CC^(n xx n)`, åˆ†åˆ«å®šä¹‰
	<span class="formula">
		è¡Œç›–å°”åœ†ç›˜: `S_i := {z in CC: |z-a_(i i)| le sum_(j!=i) |a_(i j)|}`,<br/>
		åˆ—ç›–å°”åœ†ç›˜: `G_i := {z in CC: |z-a_(i i)| le sum_(j!=i) |a_(j i)|}`.
	</span>
	è¡Œ (åˆ—) ç›–å°”åœ†ç›˜çš„åŠå¾„åˆ†åˆ«å«åšå»å¿ƒè¡Œ (åˆ—) å’Œ.
	`bm A` çš„ä»»ä¸€ç‰¹å¾å€¼ `lambda` å¿…ç„¶è½åœ¨æŸä¸ªè¡Œç›–å°”åœ†ç›˜ä¸­,
	ä¹Ÿå¿…ç„¶è½åœ¨æŸä¸ªåˆ—ç›–å°”åœ†ç›˜ä¸­:
	<span class="formula">
		`lambda in (uuu_(i=1)^n S_i) nn (uuu_(i=1)^n G_i)`.
	</span>
</p>

<p class="proof">
	ä»¥è¡Œç›–å°”åœ†ç›˜ä¸ºä¾‹, ä»»å– `bm A` çš„ç‰¹å¾å€¼ `lambda` å’Œç‰¹å¾å‘é‡ `bm x !=
	0`, åˆè®¾ `x_i` æ˜¯ `bm x` çš„å„åˆ†é‡ä¸­æ¨¡æœ€å¤§çš„ä¸€ä¸ª, åˆ™ç”± `bm (A x)
	= lambda bm x` çŸ¥,
	<span class="formula">
		`sum_(j=1)^n a_(i j) x_j = lambda x_i`,
	</span>
	äºæ˜¯
	<span class="formula">
		`|x_i(a_(i i) - lambda)|`
		`= |sum_(j!=i) a_(i j) x_j|`
		`le |x_i| sum_(j!=i) |a_(i j)|`.
	</span>
	è¿™è¯´æ˜ `lambda` è½åœ¨ä¸€ä¸ªè¡Œç›–å°”åœ†ç›˜ä¸­.
</p>

<ol class="algorithm">
  <b>Jacobi è¿­ä»£æ³•</b> é€‚ç”¨äºæ±‚<b>å®å¯¹ç§°</b>çŸ©é˜µ `bm A` çš„ç‰¹å¾å€¼ä¸ç‰¹å¾å‘é‡.
  æ€æƒ³æ˜¯ä½œç›¸ä¼¼å˜æ¢ `bm T^-1 bm A bm T`, ä½¿å¾—å˜æ¢åçš„çŸ©é˜µæ¥è¿‘å¯¹è§’çŸ©é˜µ.
  å…¶ä¸­, `bm T = bm T(i, j, theta)` æ˜¯ä¸€ä¸ª Givens æ—‹è½¬çŸ©é˜µ, æ»¡è¶³
  <span class="formula">
    `[T_(i i), T_(i j);
    T_(j i), T_(j j)]`
    `= [cos theta, -sin theta; sin theta, cos theta]`,
    å…¶å®ƒå…ƒç´ ä¸å•ä½çŸ©é˜µ `bm I` ç›¸åŒ.
  </span>
  `i, j` å…ƒçš„é€‰æ‹©åº”å½“ä½¿å¾— `|A_(i j)|` åœ¨éå¯¹è§’å…ƒä¸Šå–å¾—æœ€å¤§å€¼, ç§°ä¸ºä¸»å…ƒ (pivot).
  `theta` çš„é€‰æ‹©åº”å½“ä½¿å¾— `bm A^((1)) = bm T^-1 bm A bm T` çš„ `i j` å…ƒç­‰äºé›¶, å³
  <span class="formula">
    `A^((1))_(i j) = A_(i j) cos 2 theta + (A_(i i) - A_(j j))/2 sin 2 theta = 0`.
  </span>
  äºæ˜¯
  <span class="formula">
    `theta = {1/2 arctan((2 A_(i j))/(A_(i i) - A_(j j))), if A_(i i) != A_(j j);
    pi/4, otherwise:}`.
  </span>
  è‹¥å¹²æ¬¡è¿­ä»£å, å¾—åˆ°ä¸€ä¸ªè¿‘ä¼¼å¯¹è§’é˜µ `bm Lambda = bm T^-1 bm A bm T`,
  `bm Lambda` çš„å¯¹è§’å…ƒå³ä¸º `bm A` çš„ç‰¹å¾å€¼.
  è€Œ `bm T = bm T_1 bm T_2 cdots bm T_n` çš„æ¯ä¸€åˆ—éƒ½æ˜¯ `bm A` çš„ä¸€ä¸ªç‰¹å¾å‘é‡.
  ç”±äº `bm T` ä¸ºæ­£äº¤çŸ©é˜µ, è¿™äº›ç‰¹å¾å‘é‡æ°å¥½æ˜¯å•ä½å‘é‡.
</ol>

<pre>
# numpy æ±‚ç‰¹å¾å‘é‡
np.linalg.eig(A)
</pre>

<div class="playground" type="textarea" value="[
  [3,2,1],
  [2,3,2],
  [1,2,3]
]">
  <p>è¾“å‡º eigvecs çš„æ¯ä¸€åˆ—è¡¨ç¤ºä¸€ä¸ªç‰¹å¾å‘é‡.</p>
<script type="text">
module.exports = function jacobi (str) {
  const m = Playground.parse(str)
  const [eigvals, eigvecs] = new Mat(m).jacobi()
  return 'eigvals: ' + JSON.stringify(eigvals.map(v => round(v, 6))) +
    '\neigvecs:\n' + eigvecs.toString(6)
}
</script>
</div>

<ol class="algorithm">
  <b>QR è¿­ä»£æ³•</b> é€‚ç”¨äºæ±‚è§£ä¸€èˆ¬å®æ–¹é˜µ `bm A` çš„ç‰¹å¾å€¼;
  å¦‚æœ `bm A` æ˜¯å¯¹ç§°çš„å¯é€†çŸ©é˜µ, é‚£ä¹ˆè¿˜èƒ½æ±‚å‡ºç‰¹å¾å‘é‡.
  æ­¥éª¤å¦‚ä¸‹:
  <li>å…ˆè®° `bm A_1 = bm A`, å°†å®ƒåˆ†è§£ä¸ºæ­£äº¤çŸ©é˜µä¹˜ä»¥ä¸Šä¸‰è§’é˜µ: `bm A_1 = bm Q_1 bm R_1`.</li>
  <li>ç„¶åè®° `bm A_2 = bm R_1 bm Q_1 = bm Q_1^-1 bm A bm Q_1`, äºæ˜¯ `bm A_2` ä¸ `bm A_1` ç›¸ä¼¼.</li>
  <li>åå¤è¿­ä»£ä½¿ `bm A_n` æ”¶æ•›äºä¸Šä¸‰è§’é˜µ, æ­¤æ—¶ä¸»å¯¹è§’å…ƒä¸º `bm A` çš„ç‰¹å¾å€¼.</li>
  <li>ç‰¹åˆ«å½“ `bm A` å¯¹ç§°æ—¶, `bm A_n` æ”¶æ•›äºå¯¹è§’é˜µ, æ­¤æ—¶ `bm Q = bm Q_1 cdots bm Q_(n-1)`
    çš„æ¯ä¸€åˆ—æ˜¯ `bm A` çš„ç‰¹å¾å‘é‡.
  </li>
  <li>`bm A` ä¸å¯¹ç§°æˆ–ä¸å¯é€†æ—¶, ä¸Šè¿°æ–¹æ³•æ— æ³•æ±‚å‡ºç‰¹å¾å‘é‡. æ­¤æ—¶å¯ä»¥å°†ç‰¹å¾å€¼ä»£å…¥åˆ°ç‰¹å¾æ–¹ç¨‹
    `(bm A - lambda bm I) bm x = bb 0` æ¥æ±‚è§£ç‰¹å¾å‘é‡.
  </li>
</ol>

<div class="playground" type="textarea" value="[
  [3,2,1],
  [2,3,2],
  [1,2,3]
]" value2="[
  [1,1],
  [1,1]
]" value3="[
  [1,1,0],
  [0,1,0],
  [0,0,2]
]">
<p>è¾“å‡º eigvecs çš„æ¯ä¸€åˆ—è¡¨ç¤ºä¸€ä¸ªç‰¹å¾å‘é‡, é‡æ•°å¤§äº 1 çš„ç‰¹å¾å€¼å¯èƒ½å¯¹åº”ç›¸åŒçš„ç‰¹å¾å‘é‡ (è§ä¾‹3).
</p>
<script type="text">
module.exports = function eig (str) {
  const m = Playground.parse(str)
  const [eigvals, eigvecs] = new Mat(m).eig()
  return 'eigvals: ' + JSON.stringify(eigvals.map(v => round(v, 6))) +
    '\neigvecs:\n' + (eigvecs?.toString(6) || '')
}
</script>
</div>

<script src="../../js/note.js?type=math"></script>
<script src="../../js/playground.js"></script>
<script src="../../code/mat.js"></script>
</body>
</html>
