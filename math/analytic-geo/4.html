<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <title>平面代数曲线</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" type="text/css" href="../../css/note.css" />
</head>
<body>

<p class="remark">
  阅读本篇的时候, 可以尝试 <a href="https://www.geogebra.org/calculator" target="_blank">geogebra 在线绘图</a>.
</p>

<p class="definition">
  隐方程形如 `f(x, y) = 0` 的曲线称为平面代数曲线, 其中 `f` 是二元多项式.
</p>

<p class="example">
  <b>叶形线</b>
  平面上原点关于抛物线 `y = -ax^2` 在 `x=t` 处的切线
  `y + a t^2 = -2a t(x-t)`
  的对称点为
  <span class="formula">
    `(2at^2)/(1+4a^2 t^2) (2a t, 1)`.
  </span>
  利用 `y = (2at^2)/(1+4a^2 t^2)` 解出 `t^2`, 代入 `x^2` 的表达式,
  就可以消去参数 `t`, 得到:
  <span class="formula">
    `y^3 = x^2(1-2a y)`.
  </span>
</p>

<div class="img sm">
  <canvas id="exp-parabola-cubic" width="400" height="150"></canvas>
</div>

<p class="example">
  <b>`alpha` 曲线</b>
</p>

<div class="img" title="`y^2 = x^2(x+a)`">
  <canvas id="img-cubic2" width="300" height="300"></canvas>
  <div id="img-cubic2-range"></div>
</div>

<p class="example">
  <b>Descartes 卵形线</b> 是平面上到两个焦点距离 `r_1, r_2` 满足 `m r_1
  + n r_2 = b` 的点的轨迹.
</p>

<p class="example">
  <b>Cassini 卵形线</b>
  是平面上到两个焦点 `(+-c, 0)` 距离之积为定值 `a^2` 的点的轨迹.
  当 `a = c` 时, 称为<b>Bernoulli 双纽线</b>. Cassini 卵形线的方程为
  <span class="formula">
    `((x-c)^2 + y^2)((x+c)^2+y^2) = a^4`,<br>
    或 `(x^2+y^2)^2 - 2c^2(x^2-y^2) = a^4-c^4`,<br>
    或 `r^4 - 2c^2 r^2 cos 2 theta = a^4 - c^4`.
  </span>
  特别, 双纽线的极坐标方程为
  <span class="formula">
    `r^2 = 2 a^2 cos 2 theta`.
  </span>
</p>

<div class="img md">
  <canvas id="exp-cassini" width="300" height="200"></canvas>
</div>

<p class="example">
  <b>玫瑰线</b> 极坐标方程为 `r = cos n theta`, `theta in RR`, `n in ZZ^+`.<br>
  `n` 为奇数时有 `n` 片花瓣, 周期是 `pi`; 偶数时有 `2n` 片花瓣, 周期是 `2pi`.<br>
  玫瑰线的第一片花瓣总是朝向 `x` 轴正方向; 如果把极坐标方程的 `cos` 换成 `sin`, 则图像整体旋转 90 度,
  第一片花瓣朝向 `y` 轴正方向.<br>
  利用 De Moivre 公式,
  <span class="formula">
    `r^n cos n theta = "Re"(r cos theta + "i" r sin theta)^n`,
  </span>
  于是玫瑰线的直角坐标方程为
  <span class="formula">
    `(x^2+y^2)^(n+1) = ("Re"(x + "i"y)^n)^2`.
  </span>
</p>

<div class="img" title="`r = cos n theta`">
  <canvas id="img-rose" width="300" height="300"></canvas>
  <div id="img-rose-range"></div>
</div>

<p class="example">
  <b>极坐标下的切线方程</b>
  曲线 `r(theta)` 在点 `(theta_0, r_0)` 处的切线方程为
  <span class="formula">
    `(1/r("d"r)/("d"theta))(theta_0, r_0)`
    `= (r cos(theta-theta_0)-r_0)/(r sin(theta-theta_0))`.
  </span>
  如果记切线与 `Ox` 轴夹角为 `varphi`, 又有
  <span class="formula">
    `1/r("d"r)/("d"theta) = cot(varphi - theta)`.
  </span>
</p>

<p class="proof">
  由于
  <span class="formula">
    `dy/dx = "d"/dt (r sin theta) // "d"/dt (r cos theta)`
    `= (r' sin theta + r theta' cos theta)/(r' cos theta - r theta' sin theta)`
    `= (("d"r)/("d"theta) sin theta + r cos theta)/(("d"r)/("d"theta) cos theta - r sin theta)`,
  </span>
  故
  <span class="formula">
    `("d"r)/("d"theta) = (dy/dx r sin theta + r cos theta)/(dy/dx cos theta - sin theta)`.
    <span class="label" id="for-dr-dtheta"></span>
  </span>
  如果记 `dy/dx = tan varphi`, 则
  <span class="formula">
    `1/r("d"r)/("d"theta)`
    `= (tan varphi tan theta + 1)/(tan varphi - tan theta)`
    `= cot(varphi - theta)`.
  </span>
  现在把曲线在直角坐标下的切线方程
  <span class="formula">
    `dy/dx(x_0, y_0) = (y-y_0)/(x-x_0)`
  </span>
  代入 <a href="#for-dr-dtheta" class="ref"></a> 得
  <span class="formula">
    `("d"r)/("d"theta)(theta_0, r_0)`
    `= (r_0 sin theta_0(r sin theta-r_0 sin theta_0) + r_0 cos theta_0(r cos theta - r_0 cos theta_0))
    / (cos theta_0 (r sin theta - r_0 sin theta_0) - sin theta_0 (r cos theta - r_0 cos theta_0))`
    `= (r_0 r cos(theta-theta_0)-r_0^2)/(r sin(theta-theta_0))`.
  </span>
  整理即得结论.
</p>

<p class="proof">
  以原点为一个顶点, 三边分别为 `r_0, r_0 + "d"r, r_0"d"theta` 作曲边三角形.
  设 `P_0(theta_0, r_0)` 处的切线与 `P_0` 点处向径的垂线夹角为 `alpha`, 则
  <span class="formula">
    `(("d"r)/(r "d"theta))(theta_0, r_0) = tan alpha`.
  </span>
  延长向径 `r_0 + "d"r` 与切线交于 `(theta, r)`. 由几何关系又得到
  <span class="formula">
    `tan alpha = (r cos(theta-theta_0) - r_0)/(r sin(theta-theta_0))`.
  </span>
</p>

<ol class="example">
  <b>切线与渐近线</b>
  <li>`f(x, y)` 的最低次项刻画了它在原点附近的形态. 例如双纽线
    `(x^2+y^2)^2 - 2(x^2-y^2) = 0` 的最低次项 `x^2 - y^2 = 0` 恰好是它在原点的切线.
    同样 `alpha` 曲线 `y^2 = x^2(x + a)` (`a gt 0`) 的最低次项 `y^2 = a x^2` 也是它在原点的切线.
    最后, 若 `f(x, y)` 的常数项不为零, 则曲线不过原点.
  </li>
  <li>`f(x, y)` 的最高次项刻画了它在无穷远点附近的形态 (即渐近线).
    例如双曲线 `x y = 1` 的最高次项 `x y = 0` 就给出它的渐近线.
    又如, 曲线 `x(y-x)(y-2x) = x + y + 1` 的渐近线是 `x=0`, `y=x` 和 `y=2x`.
    最后, 若 `f(x, y)` 的最高次项没有零点, 比如 `(x^2+y^2)^m`, 则曲线是有界的.
  </li>
</ol>

<p class="example">
  <b>渐开线</b>
  直线 `l` 在半径为 `R` 的圆 `O` 上滚动, 初始时刻直线上一点 `P` 位于 `A(R, 0)`,
  正好是直线与圆的切点. 当直线转过一定角度后, 设新的切点为 `Q`, 记 `alpha = /_ POQ`.
  则 `arc(AQ) = PQ = R tan alpha`, 点 `P` 的极坐标为
  <span class="formula">
    `{r = R // cos alpha; theta = tan alpha - alpha:}`
  </span>
  渐开线常见于齿轮的设计中.
</p>

<div class="img lg" title="渐开线">
  <img src="../img/involute.svg" alt="">
</div>

<script src="../../js/note.js?type=math"></script>
<script src="../../js/plot.js"></script>
<script src="../../js/ui.js"></script>
<script>
new Plot('exp-parabola-cubic')
  .geometry({ xmin: -3, xmax: 3, ymin: -0.5, ymax: 1.5 }).axis()
  .plot(t => t**3/(1+t**2), t => t**2/(1+t**2), { min: -5, max: 5})

// r^2 = 2 cos 2theta
const { cos, sin, sqrt, abs, PI } = Math
const f = t => sqrt(2*cos(2*t))
new Plot('exp-cassini')
  .geometry({ xmin: -1.5, xmax: 1.5, ymin: -1, ymax: 1}).axis()
  .plot(t => f(t)*cos(t), t => f(t)*sin(t), { min: -PI/4, max: PI/4+0.1 }) // 右支
  .plot(t => f(t)*cos(t), t => f(t)*sin(t), { min: 3*PI/4-0.1, max: 5*PI/4+0.1 }) // 左支

const plotCubic2 = new Plot('img-cubic2')
const rangeCubic2 = new Range('img-cubic2-range', {
  min: -3,
  max: 3,
  step: 0.1,
  defaultValue: 1.5,
  onChange: a => {
    rangeCubic2.setLabel('a = ' + a)
    plotCubic2.clear()
      .geometry({ xmin: -4, xmax: 4, ymin: -4, ymax: 4 }).axis()
      .plot(x => Math.sqrt(x * x * (x + a)))
      .plot(x => -Math.sqrt(x * x * (x + a)))
  },
})

const plotRose = new Plot('img-rose')
const rangeRose = new Range('img-rose-range', {
  min: 1,
  max: 10,
  step: 1,
  defaultValue: 3,
  onChange: n => {
    rangeRose.setLabel('n = ' + n)
    plotRose.clear()
      .geometry({ xmin: -1, xmax: 1, ymin: -1, ymax: 1 }).axis()
      .plot(t => cos(n*t)*cos(t), t => cos(n*t)*sin(t), { min: 0, max: (2-n%2)*PI })
  }
})
</script>
</body>
</html>
