<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8" />
  <title>微积分不等式</title>
  <link rel="stylesheet" href="../../css/note.css"/>
</head>

<body>

<h2>曲边梯形不等式</h2>

<p class="lemma">
	<b>Hadamard 不等式 (曲边梯形不等式)</b>
	设 `f` 是 `[a, b]` 上可积的下凸函数, 则
	<span class="formula">
		`f((a+b)/2) le 1/(b-a) int_a^b f(x) dx le (f(a)+f(b))/2`.
	</span>
	当 `f` 严格凸且 `a lt b` 时, 不等号严格成立.
	这个不等式的几何意义是, `f` 的图像在 `[a,b]` 上围成的曲边梯形面积
	大于它在 `x = (a+b)/2` 处的内切梯形面积, 但小于它的外接梯形面积.
</p>
<div class="img sm">
  <img src="../img/trapeziod-with-curve-side-inequality.svg">
</div>

<p class="proof">
	记 `I = 1/(b-a) int_a^b f(x) dx`,
	令 `x = a + t(b-a) = (1-t)a + t b`, 则
	<span class="formula">
		`I = int_0^1 f[(1-t)a+t b] dt`
		`le int_0^1 [(1-t) f(a) + t f(b)] dt`
		`= (f(a)+f(b))/2`.
	</span>
	另一方面, 令 `x = a+b-s`,
	<span class="formula">
		`(b-a) I = int_a^b f(a+b-s) "d"s`
		`= 1/2 int_a^b [f(x) + f(a+b-x)] dx`
		`ge int_a^b f((x+a+b-x)/2) dx`
		`= (b-a)f((a+b)/2)`.
	</span>
</p>

<p class="theorem">
	<b>对数均值不等式 (ALG 不等式, <del>奥利给不等式</del>)</b>
	设 `a, b` 是不相等的正数, 则
	<span class="formula">
		`sqrt(a b) lt (a-b)/(ln a - ln b) lt (a+b)/2`,
	</span>
	即 `A gt L gt G`. 这一不等式刻画了 `ln {:a/b:}` 的上下界.
</p>

<p class="proof">
	积分学的证明.
	在 `[u,v]` 上对 `f(x) = "e"^x` 应用 Hadamard 不等式,
	得到对数均值不等式的指数形式:
	<span class="formula">
		`"e"^((u+v)/2) lt ("e"^v-"e"^u)/(v-u) lt ("e"^u+"e"^v)/2`,
	</span>
	令 `"e"^u = a`, `"e"^v = b` 即得证.
</p>

<p class="proof">
	又一积分学的证明.
	分别在 `[a, b]` 和 `[a, sqrt(a b)]` 上对 `f(x) = 1/x`
	应用 Hadamard 不等式, 有
	<span class="formula">
		`2/(a+b) lt (ln b - ln a)/(b-a)`,<br/>
		`(ln sqrt(a b) - ln a)/(sqrt(a b) - a) lt (a^-1 + (a b)^(-1/2))/2`.
	</span>
	整理即得结论.
</p>

<p class="proof">
	(比值法) 微分学的证明. 先证明 `b = 1` 的情形:
	<span class="formula">
		`sqrt x lt (x-1)/(ln x) lt (x+1)/2`,
		<span class="label" id="for-lnx-estimate"></span>
	</span>
	即证
	<span class="formula">
		`sqrt x - 1/sqrt x lt ln x lt 2(x-1)/(x+1)`, `quad 0 lt x lt 1`,<br/>
		`2(x-1)/(x+1) lt ln x lt sqrt x - 1/sqrt x`, `quad x gt 1`.
	</span>
	换言之, `ln x` 的值介于 `sqrt x - 1/sqrt x` 和 `2(x-1)/(x+1)` 之间,
	且三者的函数图像在 `x=1` 时相交.  设
	<span class="formula">
		`f(x) = sqrt x - 1/sqrt x - ln x`,
		`quad g(x) = 2 (x-1)/(x+1) - ln x`.
	</span>
	计算知 `f(1) = g(1) = 0`, 且在 `(0, +oo)` 上
	`f'(x) gt 0`, `g'(x) lt 0`.
	于是 <a class="ref" href="#for-lnx-estimate"></a> 成立.<br/>
	取 `x = a/b`, 再在不等号两边同乘 `b` 即得证.
</p>

<p class="example">
  [来自 我是完全的無法理解] `sum_(k=1)^n 1/(n+k) gt ln 2 - 1/(4n)`.
</p>

<p class="proof">
  由于左边 `xx 2 = sum_(k=1)^n(1/(n+k) + 1/(n+k-1)) - 1/(2n)`,
  只需证
  <span class="formula">
    `sum_(k=1)^n (1/(n+k) + 1/(n+k-1)) gt 2 ln 2`.
  </span>
  这只需由对数均值不等式
  <span class="formula">
    `1/2(1/(n+k) + 1/(n+k-1)) gt ln(n+k) - ln(n+k-1)`
  </span>
  求和即得.
</p>

<p class="example">
  <b>Stirling 公式青春版</b>
  [来自 崔尚斌《数学分析》]
  <span class="formula">
    `sqrt n (n/"e")^n * "e"^(7//8) lt n! lt sqrt n (n/"e")^n * "e"`.
  </span>
  注: 标配版的 Stirling 公式是指 `n! ~ sqrt(2pi n) (n/"e")^n`,
  我们有 `7/8 lt ln sqrt(2pi) lt 1`.
</p>

<p class="proof">
  运用曲边梯形不等式估计积分 `int_1^n ln x dx`.
  一方面
  <span class="formula">
    `int_1^n ln x dx`
    `gt sum_(k=1)^(n-1) (ln k + ln(k+1))/2`
    `= ln(n!) - 1/2 ln n`,
  </span>
  另一方面,
  <span class="formula">
    `int_1^n ln x dx`
    `= int_1^(3//2) + int_(3//2)^(n-1//2) + int_(n-1//2)^n`
  </span>
  对于中间一项有
  <span class="formula">
    `int_(3//2)^(n-1//2) ln x dx`
    `lt sum_(k=2)^(n-1) ln k`
    `= ln(n!) - ln n`.
  </span>
  左右两项分别用 `x=1` 和 `x=n` 处的切线近似, 有
  <span class="formula">
    `int_1^(3//2) ln x dx`
    `lt 1/2 * 底 * 高`
    `= 1/2 * 1/2 * 1/2`
    `= 1/8`,<br>
    `int_(n-1//2)^n ln x dx`
    `lt 1/2 * 高 * (上底 + 下底)`
    `= 1/2 * 1/2 * (ln n + ln n - 1/(2n))`
    `= 1/2 ln n - 1/(8n)`.
  </span>
  以上三式相加得
  <span class="formula">
    `int_1^n ln x dx`
    `lt ln(n!) - 1/2 ln n - 1/(8n) + 1/8`.
  </span>
  整理得
  <span class="formula">
    `-1/8 lt ln(n!) - int_1^n ln x dx - 1/2 ln n lt 0`.
  </span>
  代入 `int_1^n ln x dx` `= n (ln n - 1) + 1` 得到
  <span class="formula">
    `7/8 lt ln(n!) - n ln n + n - 1/2 ln n lt 1`.
  </span>
  取指数即得结论.
</p>

<h2>一阶估计</h2>

<h3>幂函数的一阶估计</h3>

<p class="theorem">
  <b>Bernoulli 不等式</b>
  设实数 `x gt -1`, `a ge 0`, 则
  <span class="formula">
    `(1+x)^a ge 1 + a x`, `quad a ge 1`,<br>
    `(1+x)^a le 1 + a x`, `quad 0 le a le 1`.
  </span>
  等号成立当且仅当 `a = 0, 1` (曲线与直线重合) 或
  `x = 0` (曲线与直线相切).
</p>

<p class="proof">
  在 `0` 到 `x` 的区间上 Taylor 展开
  <span class="formula">
    `(1+x)^a = 1 + a x + (a(a-1))/2 xi^2`
  </span>
  即得结论.
</p>

<p class="proof">
  Bernoulli 不等式是很基础的不等式, 这里就 `a` 等于正整数 `n`
  的情形给出归纳法证明: `n = 1` 时 `(1+x)^1 = 1 + 1*x` 成立.
  假设结论对正整数 `n-1` 成立, 则
  <span class="formula">
    `(1+x)^n`
    `ge (1+x) (1 + (n-1) x)`
    `= 1 + n x + (n-1)x^2`
    `ge 1 + n x`.
  </span>
  等号成立当且仅当 `n = 1` 或 `x = 0`.
</p>

<div class="img" title="Bernoulli 不等式">
  <canvas id="img-bernoulli" width="300" height="300"></canvas>
  <div id="img-bernoulli-range"></div>
</div>

<p class="example">
  设 `a, b gt 0`, `r gt 1`, 证明 `(a+b)^r gt a^r + b^r`.
</p>

<p class="proof">
  (比值法) 设 `x = a/b`, 只需证 `x gt 0` 时 `(1+x)^r - x^r gt 1`.
  设 `f(x) = (1+x)^r - x^r`, 则 `f(0) = 1`, 且 `x gt 0` 时 `f'(x)
  = r(1+x)^(r-1) - r x^(r-1) gt 0`, 因此不等式成立.
</p>

<h3>指对数函数的一阶估计</h3>

<p class="theorem">
  <b>指对数函数的一阶估计</b>
  在 `0` 到 `x` 的区间上 Taylor 展开,
  <span class="formula">
    `"e"^x = 1 + x + xi^2/2 ge 1 + x`,<br>
    `ln(1+x) = x - eta^2/2 le x`.
  </span>
</p>

<ol class="corollary">
  <li>`1 + x le "e"^x le 1//(1-x)`, 等号成立当且仅当 `x = 0`
    (右半不等式只对 `x lt 1` 成立);</li>
  <li>`1-1//x le ln x le x-1`, 等号成立当且仅当 `x = 1`;</li>
  <li>`x gt 0` 时, `1/(x+1) lt ln (1+1/x) lt 1/x`, 即 `(1+1/x)^x lt "e" lt (1+1/x)^(x+1)`.</li>
</ol>

<ol class="proof">
  <li>设 `f(x) = "e"^x - x - 1`, 则 `f(0) = 0`, 且
    <span class="formula">
      `f'(x) = "e"^x - 1 {
        lt 0, if x lt 0;
        gt 0, if x gt 0;
      :}`
    </span>
    于是 `f(x) ge 0`. 换元 `x mapsto -x` 得 `"e"^-x ge 1 - x`,
    当 `x lt 1` 时两边取倒数即得结论.
  </li>
  <li>由 1. 取对数得 `x ge ln(1+x)`, 换元 `x mapsto x-1`,
    得 `x - 1 ge ln x`; 再换元 `x mapsto 1//x`, 得 `1//x - 1 ge -ln x`.
  </li>
</ol>

<div class="flex">
  <div class="img" title="指数函数的估计">
    <canvas id="img-exp-approx" width="300" height="300"></canvas>
  </div>
  <div class="img" title="对数函数的估计">
    <canvas id="img-log-approx" width="300" height="300"></canvas>
  </div>
</div>

<p class="remark">
  注意, 要证的不等式中含有分式时, 一般要将其线性化为整式, 再求导证明.
  如 `"e"^x le 1//(1-x)` 直接求导只会越求越繁.
</p>

<ol class="corollary">
  <b>`x^x` 的两个估计</b> `x gt 0` 时有
  <li>`x^x ge "e"^(x-1)`, 等号成立当且仅当 `x = 1`;</li>
  <li>`x ln x gt x "e"^-x - 2//"e"`.</li>
</ol>

<ol class="proof">
  <li>取对数, 两边同除以 `x`, 就化为对数函数的一阶估计;</li>
  <li>(过渡法) 这是因为左边的最小值等于右边的最大值.
    这相当于以常数函数作为证明的过渡.
  </li>
</ol>

<div class="img" title='`x^x` 的估计. 蓝色曲线是 `x ln x`, 下方红色曲线是 `x "e"^-x - 2//"e"`.'>
  <canvas id="img-x-pow-x-approx" width="300" height="300"></canvas>
</div>

<ol class="example">
  <li>`prod_(n ge 1) (1 + 1/3^n) le sqrt "e"`;</li>
  <li>`1/2 3/4 5/6 cdots = 0`.</li>
</ol>

<ol class="proof">
  利用不等式 `1 + x le "e"^x`,
  <li>
    <span class="formula">
      `prod_(n ge 1) (1 + 1/3^n)`
      `le prod_(n ge 1) "e"^(3^-n)`
      `= exp(sum_(n ge 1) 3^-n)`
      `= sqrt "e"`.
    </span>
  </li>
  <li>
    原式等于 `(1-1/2)(1-1/4)(1-1/6)`
    `le "e"^(-1/2-1/4-1/6 cdots)`
    `to "e"^-oo = 0`.
  </li>
</ol>

<ol class="example">
  <li>`x gt 1` 时, `x^2-1 gt 2 x ln x`;</li>
  <li>`x gt 0` 时, `ln(1+x) gt (2x)/(x+2)`.</li>
</ol>

<ol class="proof">
  <li>令 `f(x) = x^2 - 1 - 2x ln x`, 则 `f(1) = 0`,
    而 `f'(x) = 2x - 2 - 2 ln x` `= 2(x-1 - ln x) gt 0`, 故结论成立.
    也可以在对数均值不等式中取 `a = x^2`, `b = 1`, 则
    <span class="formula">
      `sqrt(x^2) lt (x^2 - 1)/(ln x^2)`,
    </span>
    整理即得结果.
  <li>
  <li>只需说明 `x = 0` 时两边都等于 `0`, 而 `x gt 0` 时
    `ln(1+x) - (2x)/(x+2)` 的导数大于零即可.
    也可以对 `a = 1+x`, `b = 1` 使用对数均值不等式.
  </li>
</ol>

<p class="example">
  `2x "e"^(x-1) ge (x^2+1)(ln x+1)`.
</p>

<ol class="proof">
  `x = 1` 时, 等号成立.  使用多项式过渡, 只需证:
  <span class="formula">
    左边 `gt 2x^2 gt` 右边, `quad 0 lt x lt 1`;<br/>
    左边 `gt x^3 + x gt` 右边, `quad x gt 1`.
  </span>
  <li>先设 `0 lt x lt 1`, 显然 `2x "e"^(x-1) gt 2x^2`. 令
    `f(x) = 2x^2 - (x^2+1)(ln x+1)`, 则 `f(1) = 0`,
    `f'(x) = x - 1/x - 2x ln x` `= x(1-1/x^2 - ln x^2) le 0`.
  </li>
  <li>再设 `x gt 1`, 显然 `x^3 + x gt (x^2+1)(ln x+1)`. 令
    `g(x) = 2"e"^(x-1) - x^2 - 1`, 则 `g(1) = 0`, `g'(x)
    = 2"e"^(x-1) - 2x gt 0`.
  </li>
</ol>

<p class="example">
  `"e"^x gt ln x + 2x + 1/sqrt 2`.
</p>

<p class="proof">
  ??
</p>

<h3>Lambert W 函数</h3>

<ol class="example">
  <b>Lambert W 函数</b>: `x "e"^x` 的反函数.
  <li>
    在不等式 `"e"^t ge t+1` 中令 `t = a x + ln x` (`a != 0`) 得
    <span class="formula">
      `x "e"^(a x) ge a x + ln x + 1`, 等号成立当且仅当 `t = 0`.
    </span>
    从而得到:
    不等式 `x"e"^(a x) ge b x + ln x + 1` 对所有 `x gt 0`
    成立当且仅当 `a ge b`.
  </li>
  <li>现在考虑等号成立的条件
    <span class="formula">
      `a x + ln x = 0`, 或 `x "e"^(a x) = 1`.
    </span>
    记 `x "e"^x` 的反函数为 Lambert W 函数 `W(x)`,
    即 `W(x) "e"^(W(x)) = x`.
    于是原方程化为 `a x"e"^(a x) = a`, 得到 `x = W(a)//a`.
  </li>
  <li>用 Lambert W 函数求解
    <span class="formula">
      `a/x + ln x = 0`, 或 `x "e"^(a/x) = 1`.
    </span>
    两边取倒数再同乘 `-a` 得 `-a/x "e"^(-a/x) = -a`,
    于是 `-a/x = W(-a)`, `x = -a // W(-a)`.
  </li>
  <li>用 Lambert W 函数求解
    <span class="formula">
      `x^x = a`, 或 `x ln x = ln a`.
    </span>
    方程化为 `"e"^(ln x) ln x = ln a`,
    于是 `ln x = W(ln a)`, `x = "e"^(W(ln a))`.
  </li>
</ol>

<div class="img" title="Lambert W 函数以 `y = -1` 为界有两个分支">
  <canvas id="img-lambert-w" width="300" height="300"></canvas>
</div>

<p class="example">
  由 Lagrange 反演得到 Lambert W 函数的级数形式.
</p>

<p class="solution">
  令 `f(x) = x "e"^x`, 则
  <span class="formula">
    `W(x) = f^-1(x)`
    `= sum_(n ge 1) x^n/n [x^(n-1)] (x/(f(x)))^n`
    `= sum_(n ge 1) x^n/n [x^(n-1)] "e"^(-n x)`
    `= sum_(n ge 1) x^n/n (-n x)^(n-1)/(n-1)!`
    `= sum_(n ge 1) x^(2n-1) (-n)^(n-1)/n!`.
  </span>
  收敛半径为
  <span class="formula">
    `lim_(n to oo) (n/(n+1))^(n-1) = "e"^-1`.
  </span>
</p>

<h3>极值点偏移</h3>

[<a href="http://www.360doc.cn/mip/759704114.html" target="_blank">高中数学：极值点偏移问题有什么好的解决办法？</a>]

<p class="definition">
  <b>极值点偏移</b>
  设函数 `f` 有两个零点 `a lt b`, 且在开区间 `(a, b)`
  上有唯一的极值点 `x_0`. 考虑区间中点 `(a+b)//2`, 若 `x_0`
  位于中点左侧 (右侧), 则称 `f` 在 `(a, b)` 上极值点左偏 (右偏).
</p>

<div class="img sm" title="极值点左偏">
  <img src="../img/extreme-point-shift.png" alt="极值点左偏">
</div>

<p>
  为研究极值点偏移, 构造奇函数
  <span class="formula">
    `F(x) = f(x_0 + x) - f(x_0 - x)`,
  </span>
  其中 `F(0) = 0`. 如果 `f` 关于 `x_0` 对称, 则 `F` 应该恒等于零.
  若 `F` 单调 (如单增), 则对任意 `x gt 0` 有 `F(x) ge 0`.
  特别地 `F(x_0-a) ge 0`, 即
  <span class="formula">
    `f(2x_0-a) = f(2x_0-a) - f(a) ge 0 = f(b)`
  </span>
  由极值点 `x_0` 的唯一性知道,
  `f` 在 `[x_0, b]` 上单调. 进一步假定存在充分大的数 `M`, 使得
  `f` 在 `[x_0, M]` 上单调 (如单增), 则上式推出
  <span class="formula">
    `2 x_0 - a ge b`, 即 `x_0 ge (a+b)//2`,
  </span>
  因此极值点右偏.
</p>

<p class="remark">
  判定 `F(x)` 单调性的常用方法是考察其导数的正负:
  <span class="formula">
    `F'(x) = f'(x_0 + x) color(red)(+) f'(x_0 - x)`,
  </span>
  注意中间的加号.
</p>

<div class="p remark">
  我们将极值点偏移情况总结为下表, 它的规律和乘法法则一致, 应该是容易记忆的:
<table>
  <tr>
    <th>`x_0` 是 `f` 的</th>
    <th>`f` 在 `[x_0, M]` 上</th>
    <th>`F` 的单调性</th>
    <th>极值点偏移情况</th>
  </tr>
  <tr>
    <td>极小值点</td>
    <td>单增 (+)</td>
    <td>单增 (+)</td>
    <td>右偏 (+)</td>
  </tr>
  <tr>
    <td>极小值点</td>
    <td>单增 (+)</td>
    <td>单减 (-)</td>
    <td>左偏 (-)</td>
  </tr>
  <tr>
    <td>极大值点</td>
    <td>单减 (-)</td>
    <td>单增 (+)</td>
    <td>左偏 (-)</td>
  </tr>
  <tr>
    <td>极大值点</td>
    <td>单减 (-)</td>
    <td>单减 (-)</td>
    <td>右偏 (+)</td>
  </tr>
</table>
</div>

<p class="example">
	若 `f(x) = "e"^x - a x` 有两个不同的零点 `x_1`, `x_2`, 则
	<span class="formula">
		`x_1 x_2 lt 1`, `quad 2 lt x_1 + x_2 lt 2 ln a`.
	</span>
</p>

<p class="proof">
	使用对数均值不等式.  由题意
	<span class="formula">
		`"e"^(x_1) = a x_1`, `quad "e"^(x_2) = a x_2`,
	</span>
	取对数得
	<span class="formula">
		`x_1 = ln a + ln x_1`, `quad x_2 = ln a + ln x_2`.
		<span class="label" id="for-zeros-e^x-ax"></span>
	</span>
	因此 `x_1 - x_2 = ln x_1 - ln x_2`. 由对数均值不等式有
	<span class="formula">
		`sqrt(x_1 x_2) lt 1 lt (x_1+x_2)/2`,
	</span>
	从而得 `x_1 x_2 lt 1`, `x_1 + x_2 gt 2`.
	再由 <a class="ref" href="#for-zeros-e^x-ax"></a> 得到
	`x_1 + x_2 = 2 ln a + ln x_1 x_2 lt 2 ln a`.
</p>

<ol class="proof">
  下面我们运用标准的极值点偏移方法证明 `x_1 + x_2 lt 2 ln a`.
  <li><b>求极值点</b>
    不妨设 `x_1 lt x_2`, 由题意知 `f` 在 `[x_1, x_2]` 上有唯一极小值点 `x_0`,
    它满足 `f'(x_0) = "e"^(x_0) - a = 0`, 即 `x_0 = ln a`.
  </li>
  <li><b>构造对称函数, 并利用单调性</b>
    令 `F(x) = f(x_0 + x) - f(x_0 - x)`, 有
    <span class="formula">
      `F'(x) = "e"^(x_0+x) + "e"^(x_0-x) - 2 a`
      `ge 2("e"^(x_0) - a) = 0`.
    </span>
    上式等号只在 `x = 0` 时成立, 故 `F` 严格单调增.
    由 `F` 的单调性有 `F(x_0 - x_1) gt 0`, 即
    `f(2x_0 - x_1) gt f(x_2)`;
    又 `f` 在 `(x_0, x_2)` 上严格单调增, 由 `f` 的单调性有
    `x_1 + x_2 lt 2 x_0 = 2 ln a`.
  </li>
  <li>
    <b>适当的换元, 或对方程变形</b>
    我们再证明 `x_1 x_2 lt 1`, 即证 `ln x_1 + ln x_2 lt 0`.<br>
    `f(x)` 的零点满足方程 `"e"^x = a x`, 即 `x = ln x + ln a`.
    换元 `y = ln x`, 则 `"e"^y = y + ln a`.
    令 `g(y) = "e"^y - y - ln a` 的两个零点为 `y_1, y_2`, 则 `g(y)` 有极小值点 `y_0 = 0`.
    下证 `g'(y_0+y) + g'(y_0-y) ge 0`, 即证
    <span class="formula">
      `"e"^(y_0+y) + "e"^(y_0-y) ge 2`,
    </span>
    上式由均值不等式即可得到.
    因此由极值点偏移的结论知 `y_1 + y_2 lt 0`, 即 `x_1 x_2 lt 1`.
  </li>
  <li>我们再证明 `x_1 + x_2 gt 2`,
    为此令 `h(x) = x - ln x - ln a`, 它有极小值点 `x_0 = 1`.
    下证 `h'(x_0+x) + h'(x_0-x) le 0`, 即证
    <span class="formula">
      `1/(x_0+x) + 1/(x_0-x) ge 2`.
    </span>
    上式用均值不等式 `2/(1//a+1//b) le (a+b)/2` 即得证.
  </li>
</ol>

<p class="example">
	若 `f(x) = ln x + 2/x - a` 有两个不同的零点 `x_1, x_2`, 则
	<span class="formula">
		`x_1 + x_2 gt 4`, `quad x_1 x_2 gt 4`.
	</span>
</p>

<p class="proof">
	由题意
	<span class="formula">
		`ln x_1 = a - 2/x_1`, `quad ln x_2 = a - 2/x_2`,
	</span>
	因此
	<span class="formula">
		`ln x_1^-1 = 2 x_1^-1 - a`, `quad ln x_2^-1 = 2 x_2^-1 - a`.
	</span>
	应用对数均值不等式,
	<span class="formula">
		`2/(x_1+x_2) lt sqrt(x_1^-1 x_2^-1)`
		`lt (x_1^-1 - x_2^-1)/(ln x_1^-1 - ln x_2^-1) = 1/2`,
	</span>
	即 `x_1 + x_2 gt 4`, `x_1 x_2 gt 4`.
</p>

<div class="proof p">
  使用极值点偏移法证明 `x_1 x_2 gt 4`.<br>
  换元 `y = ln x`, 令 `g(y) = f(x) = y + 2 "e"^-y - a`,
  令 `y_1, y_2` 是 `g(y)` 的两个零点, 原问题化为证明 `y_1 + y_2 gt 2 ln 2`.<br>
  `g(y)` 有极小值点 `y_0 = ln 2`. 下证 `g'(y_0+y) + g'(y_0-y) le 0`, 即证
  <span class="formula">
    `"e"^(-y_0-y) + "e"^(-y_0+y) le 1`.
  </span>
  上式由均值不等式即可得到.
  最后由极值点偏移的结论有 `y_1 + y_2 gt 2 ln 2`.
  有了 `x_1 x_2 gt 4`, 自然就有 `x_1 + x_2 ge 2 sqrt(x_1 x_2) gt 4`.
  <hr>
  我们也可以直接应用极值点偏移证明 `x_1 + x_2 gt 4`.
  这是因为 `f` 有极小值点 `x_0 = 2`. 且
  <span class="formula">
    `f'(x_0+x) + f'(x_0-x) = (2x_0)/((x_0+x)(x_0-x)) - 2/(x_0+x)^2 - 2/(x_0+x)^2`,
  </span>
  利用均值不等式可证上式 `le 0`.
</div>

<p class="example">
  [来自群友 Lucifer 成都2023高二月考]
  已知函数 `f(x) = ln x - a x` 存在两个不同的零点 `x_1, x_2`, 求证
  <span class="formula">
    `1/sqrt x_1 + 1/sqrt x_2 lt 2/sqrt "e"`.
  </span>
</p>

<ol class="proof">
  使用极值点偏移法.
  <li>
    换元 `y = 1//sqrt x`, 即 `x = 1//y^2`, 于是 `f(x) = ln x - a x = -2 ln y - a//y^2`,
    令 `y_1, y_2` 是这个新函数的两个零点, 原问题化为证明 `y_1 + y_2 lt 2//sqrt"e"`.
  </li>
  <li>
    如果直接令 `g(y) = -2 ln y - a//y^2`, 则它的极值点是 `sqrt a`, 而不是我们期待的 `1//sqrt"e"`.
    强行做下去只能得出下界 `y_1 + y_2 gt 2 sqrt a`, 这不是我们想要的.
    因此我们对方程 `-2 ln y - a//y^2 = 0` 变形得到 `y^2 ln y = -a/2`, 再令 `g(y) = y^2 ln y`.
    此时 `g'(y) = 2y ln y + y`, `g(y)` 有极小值点 `y_0 = 1//sqrt "e"`.
  </li>
  <li>
    下证 `g'(y_0+y) + g'(y_0-y) ge 0`, 即证
    <span class="formula">
      `h(y) = (y_0+y) ln(y_0+y) + (y_0-y)ln(y_0-y) + y_0 ge 0`.
    </span>
    注意到 `h(0) = g'(y_0) = 0`, 因此只需证明 `h(y)` 在 `y=0` 处取得最小值.
    为此求得 `h'(y) = ln(y_0+y) - ln(y_0-y)`, 发现 `h'(y)` 在 `y gt 0` 时为正, `y lt 0` 时为负, 因而
    `h(0)` 确实是 `h` 的唯一极小值, 不等式成立.
  </li>
  <li>由极值点偏移的结论知 `y_1 + y_2 lt 2 y_0 = 2//sqrt"e"`.</li>
</ol>

<h2>Gronwall 不等式</h2>

<p>这是一类在数理方程中常用的积分不等式
  [参见 <a href="../pde/2.html#for-gronwall-inequality-cond">Gronwall 不等式</a>], 其形式非常灵活多变, 我们只介绍最基本的情形.
</p>

<ol class="example">
  <b>微分不等式</b>
  设 `f` 在 `x ge 0` 时连续,
  <li>若 `f` 在 `x gt 0` 时可微, 给定初值条件 `f(0) = 1`, 解微分不等式 `f' lt f`;</li>
  <li>若 `f` 在 `x gt 0` 时二阶可微, 给定初值条件 `f(0) = 1` 和 `f'(0) le 1`, 解微分不等式 `f'' lt f`.
  </li>
</ol>

<ol class="solution">
  <li>`f' lt f` 两边同乘积分因子 `"e"^-x`, 有
    `f' "e"^-x - f "e"^-x lt 0`, 即 `"d"/dx (f "e"^-x) lt 0`.
    令 `g(x) = f(x) "e"^-x`, 则 `g(0) = 1`, `g' lt 0`, 因此 `g le 1`,
    即 `f le "e"^x`.
  </li>
  <li>设 `g = "e"^-x f`, 则
    <span class="formula">
      `g' = "e"^-x (f' - f)`,<br/>
      `g'' = "e"^-x (f - 2f' + f'')`
      `lt 2 "e"^-x(f - f') = -2 g'`.
    </span>
    下面解不等式 `g'' lt -2 g'`. 设 `h = "e"^(2x) g'`, 则
    <span class="formula">
      `h' = "e"^(2x) (2g' + g'') lt 0`,
    </span>
    故 `h lt h(0) = g'(0) = f'(0) - f(0) le 0`. 这推出 `g' lt 0`,
    故 `g le g(0) = f(0) = 1`, 即 `f le "e"^x`.
  </li>
</ol>

<p class="lemma">
  <b>Gronwall 引理</b>
  设函数 `g in L[a, b]`, `p in C[a, b]`, 函数 `y` 满足微分不等式
  <span class="formula">
    `y'(t) le g(t) + p(t) y(t)`, `quad AA t in [a, b]`,
  </span>
  则
  <span class="formula">
    `y(t) le y(a) P(t) + int_a^t g(s) P(t) // P(s) "d"s`.
  </span>
  其中 `P(t) = exp(int_a^t p(u) "d"u)`, 因此 `P(t) // P(s) = exp(int_s^t
  p(u) "d"u)`.
</p>

<p class="proof">
  在微分不等式两边同乘积分因子
  `Phi(t) = 1/(P(t)) = exp(-int_a^t p(u) "d"u)` 得
  <span class="formula">
    `"d"/dt (y(t) Phi(t)) le g(t) Phi(t)`.
  </span>
  上式两边在 `[a, t]` 上积分得
  <span class="formula">
    `y(t) Phi(t) - y(a) le int_a^t g(s) Phi(s) "d"s`,
  </span>
  整理即得结论.
</p>

<ol class="theorem">
  <b>(Gronwall 不等式, 1919)</b>
  设 `g in L[a,b]`, `f, p in C[a, b]`, `p(t) ge 0`, 且
  <span class="formula">
    `f(t) le g(t) + int_a^t p(s) f(s) "d"s`, `quad AA t in [a,b]`,
  </span>
  则
  <li>`f(t) le g(t) + int_a^t p(s) g(s) P(t) // P(s) "d"s`, `P(t)` 的含义同上.</li>
  <li>
    若 `g` 连续可微, 上式分部积分可得 `f(t) le g(a) P(t) + int_a^t g'(s) P(t) // P(s) "d"s`.
  </li>
  <li>若 `g` 单调增, 结论简化为 `f(t) le g(t) P(t)`.</li>
</ol>

<p class="proof">
  1.  记 `y(t) = int_a^t p(s) f(s) "d"s`, 由已知 `f(t) le g(t) + y(t)`, 于是由
  `p` 非负有
  <span class="formula">
    `y'(t) = p(t) f(t) le p(t) g(t) + p(t) y(t)`.
  </span>
  由引理,
  <span class="formula">
    `y(t) le int_a^t p(s) g(s) P(t)//P(s) "d"s`.
  </span>
  再由 `f(t) le g(t) + y(t)` 即得结论.
  <br>
  3. 把 1. 中的 `g(s)` 放大为 `g(t)` 再化简即可. 注意 `int_a^t p(s)//P(s) "d"s = 1 - 1//P(t)`.
</p>

<h2>Jensen 不等式 (积分形式)</h2>

<p class="theorem">
	<b>Jensen 不等式的积分形式</b>
	设 `x(t)` 在 `[a, b]` 上可积, 值域含于区间 `I`;
	`f` 是区间 `I` 上连续的下凸函数;
	`w(t)` 在 `[a, b]` 上可积, `w(t) gt 0`, 且 `int_a^b w(t) dt = 1`, 则
	<span class="formula">
		`f(int_a^b w(t) x(t) dt)`
		`le int_a^b w(t) f(x(t)) dt`.
	</span>
	特别取 `w(t) -= 1/(b-a)` 得,
	<span class="formula">
		`f(1/(b-a) int_a^b x(t) dt)`
		`le 1/(b-a) int_a^b f(x(t)) dt`.
	</span>
	取 `g = -f` 知, 对上凸函数成立反向的不等号.<br/>
	[<a href="https://wenku.baidu.com/view/ea9c16d649649b6648d7471a.html" target="_blank">欧阳资考.  2011. 利用凸函数证明积分不等式. 高等教育, 第 107 期</a>]
</p>

<p class="proof">
	易知不等式中出现的积分都有意义.
	将 `[a, b]` `n` 等分, 记 `h = (b-a)//n`, `t_k = a+k h`,
	`x_k = x(t_k)`, `w_k = w(t_k)`,
	`y_k = w_k/(sum_(k=1)^n w_k)`, `k = 1, 2, cdots, n`.
	因为 `f` 为上凸函数, 由 Jensen 不等式,
	<span class="formula">
		`f(sum_(k=1)^n x_k y_k)`
		`le sum_(k=1)^n f(x_k) y_k`,
	</span>
	即
	<span class="formula">
		`f((sum_(k=1)^n w_k x_k h)/(sum_(k=1)^n w_k h))`
		`le (sum_(k=1)^n w_k f(x_k) h)/(sum_(k=1)^n w_k h)`.
	</span>
	令 `n to oo`, 注意 `f` 的连续性, 极限符号可转移到 `f` 的括号内.
	从而由定积分的定义即得结果.
</p>

<p class="remark">
	假设定理中的 `x(t)` 在 `[a,b]` 上单调增, 于是 `f @ x` 仍是 `[a,b]`
	上的下凸函数, 类比 Hadamard 不等式的证明方法可以得到,
	<span class="formula">
		`1/(b-a) int_a^b f(x(t)) dt le (f(x(a)) + f(x(b)))/2`.
	</span>
</p>

<p class="definition">
	<b>`bm p` 方可积</b>
	设 `p ge 1`, 函数 `f` 在定义域 `[a,b]` 上只有有限个瑕点, 且 `f`
	在任意不含这些瑕点的闭子区间上都 Riemann 可积. 如果 `|f(x)|^p` 在
	`[a,b]` 上广义 Riemann 可积, 即瑕积分
	<span class="formula">
		`int_a^b |f(x)|^p dx lt oo`,
	</span>
	则称 `f` 在 `[a,b]` 上 <b>`bm p` 方可积</b>. 特别当 `p = 1` 时,
	称 `f` 在 `[a,b]` 上<b>绝对可积</b>, `p = 2` 时, 称 `f` 在 `[a,b]`
	上<b>平方可积</b>.
</p>

<p class="corollary">
	`p` 方可积函数的任意线性组合也 `p` 方可积.
</p>

<p class="proof">
	设 `f,g` 在 `[a,b]` 上 `p` 方可积, 显然对任意常数 `c`,
	函数 `c f` 也在 `[a,b]` 上 `p` 方可积. 下证函数 `f+-g` 在 `[a,b]` 上
	`p` 方可积. 只需注意对 `AA x in [a,b]` 有
	<span class="formula">
		`|f(x) +- g(x)|^p`
		`le (|f(x)|+|g(x)|)^p`
		`le (2 max{|f(x)|, |g(x)|})^p`
		`= 2^p max{|f(x)|^p, |g(x)|^p}`
		`le 2^p (|f(x)|^p + |g(x)|^p)`,
	</span>
	据此立得结论.
</p>

<p class="corollary">
	设 `1 le p lt q`, 若函数 `f` 在 `[a,b]` 上 `q` 方可积, 则它也在
	`[a,b]` 上 `p` 方可积.
</p>

<p class="theorem">
	<b>Hölder 不等式</b>
	设 `p, q gt 1` 且 `1/p+1/q = 1`. 如果 `f` 在 `[a,b]` 上 `p` 方可积,
	`g` 在 `[a,b]` 上 `q` 方可积, 则乘积 `f g` 在 `[a,b]` 上绝对可积,
	且
	<span class="formula">
		`int_a^b |f(x)g(x)| dx`
		`le (int_a^b |f(x)|^p dx)^(1/p) (int_a^b |g(x)|^q dx)^(1/q)`.
	</span>
	特别取 `p = q = 2`, 得到 Cauchy 不等式
	<span class="formula">
		`int_a^b |f(x) g(x)| dx`
		`le sqrt(int_a^b |f(x)|^2 dx) sqrt(int_a^b |g(x)|^2 dx)`.
	</span>
</p>

<p class="proof">
	记 `int_a^b |f(x)|^p dx = A`, `int_a^b |g(x)|^q dx = B`. 使用 Young
	不等式, 对 `AA x in [a,b]` 有
	<span class="formula">
		`(|f(x)|^p/A)^(1/p) (|g(x)|^q/B)^(1/q)`
		`le 1/p |f(x)|^p/A + 1/q |g(x)|^q/B`.
	</span>
	因为不等式右端函数在 `[a,b]` 上广义可积, 所以左端也可以. 积分得
	<span class="formula">
		`1/(A^(1/p) B^(1/q)) int_a^b |f(x) g(x)| dx`
		`le 1/p + 1/q = 1`.
	</span>
	所以原不等式成立.
</p>

<p>	下面两个不等式可以仿照<a href="3.html">上一章</a>对应不等式来证明.</p>

<p class="theorem">
	<b>Minkowski 不等式</b>
	设 `p ge 1`, `f, g` 都在 `[a,b]` 上 `p` 方可积, 则
	<span class="formula">
		`(int_a^b |f(x) +- g(x)|^p dx)^(1/p)`
		`le (int_a^b |f(x)|^p dx)^(1/p) + (int_a^b |g(x)|^p dx)^(1/p)`.
	</span>
</p>

<p class="theorem">
	<b>幂平均值不等式</b>
	设 `f` 在 `[a,b]` 上 `p` 方可积, `p ge 1`, 则函数
	<span class="formula">
		`(1/(b-a)int_a^b|f(x)|^alpha dx)^(1/alpha)`
	</span>
	关于参数 `alpha` 单调递增.
</p>

<p class="example">
  `f` 是 `[a, b]` 上的非负可积函数, 证明:
  <span class="formula">
    `(int_a^b f(x) sin lambda x dx)^2`
    `+ (int_a^b f(x) cos lambda x dx)^2`
    `le (int_a^b f(x) dx)^2`.
  </span>
</p>

<p class="proof">
  应用 Cauchy 不等式,
  <span class="formula">
    `(int_a^b f(x) dx)^2 - (int_a^b f(x) cos lambda x dx)^2`
    `= int_a^b f(x) (1 + cos lambda x) dx int_a^b f(x) (1 - cos lambda x) dx`
    `ge (int_a^b f(x) sqrt((1+cos lambda x)(1-cos lambda x)) dx)^2`
    `ge (int_a^b f(x) sin lambda x dx)^2`.
  </span>
</p>

<p class="example">
  设 `f in C[0, 1]`, 且 `AA x in [0, 1]`, `int_x^1 f(t) dt ge (1-x^2)/2`.
  证明: `int_0^1 f(x)^2 dx ge 1/3`.
</p>

<ol class="proof">
  1, 2 是两个较松的下界, 3 是正解.
  <li>在 `[0, 1]` 上应用 Cauchy 不等式,
    <span class="formula">
      `int_0^1 f(x)^2 dx int_0^1 1^2 dx`
      `ge (int_0^1 f(x) dx)^2`
      `ge (int_0^1 (1-0^2)/2 dx)^2 = 1/4`.
    </span>
  </li>
  <li>在 `[x, 1]` 上应用 Cauchy 不等式,
    <span class="formula">
      `((1-x^2)/2)^2`
      `le (int_x^1 f(t) dt)^2`
      `le int_x^1 1^2 dt int_x^1 f(t)^2 dt`
      `le (1-x) int_0^1 f(t)^2 dt`.
    </span>
    于是 `int_0^1 f(t)^2 dt ge "sup" (1-x^2)(1+x)//4 = 8//27`.
  </li>
  <li>
    [群友 我是卑微不敢说话的飞矢不动]
    将已知的不等式在 `[0, 1]` 上积分,
    <span class="formula">
      `1/3 = int_0^1 (1-x^2)/2 dx`
      `le int_0^1 int_x^1 f(t) dt dx`
      `= int_0^1 int_0^t f(t) dx dt`
      `= int_0^1 t f(t) dt`,
    </span>
    从而
    <span class="formula">
      `int_0^1 f(x)^2 dx int_0^1 x^2 dx`
      `ge (int_0^1 x f(x) dx)^2`
      `ge 1/9`,
    </span>
    即 `int_0^1 f(x)^2 dx ge 1//3`.
    注意 `f(x) -= x` 时等号成立, 故 `1//3` 是最优下界.
  </li>
</ol>

<p class="example">
  [来自群友 千帆过尽，勿忘初心]
  设 `f` 在 `[0, 1]` 上有二阶连续导数, 且 `f(0) = f(1) = f'(0) = 0`, `f'(1) = 1`.
  证明: `int_0^1 f''(x)^2 dx ge 4`.
</p>

<p class="proof">
  失败的尝试. 直接使用 Cauchy 不等式只能得到一个松的下界:
  <span class="formula">
    `int_0^1 f''(x)^2 dx`
    `ge (int_0^1 f''(x) dx)^2/(int_0^1 1^2 dx)`
    `= (f'(1) - f'(0))^2 = 1`.
  </span>
</p>

<div class="proof">
  将 `f''(x)` 与一个待定的函数作内积:
  <span class="formula">
    `int_0^1 f''(x)(x+a) dx`
    `= (1+a) - int_0^1 f'(x) dx`
    `= 1+a`,<br>
    `int_0^1 (x+a)^2 dx`
    `= 1/3 + a + a^2`.
  </span>
  这时使用 Cauchy 不等式:
  <span class="formula">
    `int_0^1 f''(x)^2 dx`
    `ge (int_0^1 f''(x)(x+a) dx)^2/(int_0^1 (x+a)^2 dx)`
    `= (1+a)^2/(1/3 + a + a^2)`.
  </span>
  我们希望上式的右端是 4, 于是
  <span class="formula">
    `(1+a)^2 = 4(1/3 + a + a^2)`,
  </span>
  解得 (重根) `a = -1/3`, 证毕.
  <hr>
  这种方法未免有些投机取巧, 而且待定函数的形式 `x+a` 不是一下能猜到的.
</div>

<div class="proof">
  [来自群友 乐正垂星]
  这是经典变分问题, 极值条件是 `f'''(x) = 0`.
  使用二阶导的 Euler-Lagrange 方程,
  代入边界条件知 `f(x) = x^3 - x^2` 时, 积分式取得最小值 `4`.
  这时将 `f''(x) = 6x-2` 代入 Cauchy 不等式就得到:
  <span class="formula">
    `int_0^1 f''(x)^2 dx`
    `ge (int_0^1 f''(x)(6x-2) dx)^2/(int_0^1 (6x-2)^2 dx)`
    `= 4`.
  </span>
  <hr>
  家人们看懂了吗??
</div>

<p class="example">
  [来自 stack exchange]
  设 `f in L[a, b]`, `0 lt m le f(x) le M`. 则
  <span class="formula">
    `(int_a^b f(x) dx) (int_a^b dx/(f(x))) le (M+m)^2 / (4 M m) * (b-a)^2`.
  </span>
  注: Cauchy 不等式给出
  <span class="formula">
    `(int_a^b f(x) dx) (int_a^b dx/(f(x))) ge (b-a)^2`.
  </span>
</p>

<p class="proof">
  因为 `m le f le M`, 有
  <span class="formula">
    `(f - M)(f - m) le 0`
    `rArr f + M m // f le M+m`.
  </span>
  两边积分,
  <span class="formula">
    `int_a^b (f(x) + (M m)/(f(x))) dx`
    `le (b-a)(M+m)`.
  </span>
  用均值不等式,
  <span class="formula">
    `2 sqrt((int_a^b f(x) dx) (M m int_a^b dx/(f(x))))`
    `le int_a^b (f(x) + (M m)/(f(x))) dx`
    `le (b-a)(M+m)`.
  </span>
  整理即得结论.
</p>

<p class="example">
  <b>Wirtinger-Poincaré 不等式</b>
  [来自群友 西伯利亚的猫猫, <a href="https://zhuanlan.zhihu.com/p/592486710" target="_blank">布丁阿茗@知乎</a>]
  设 `f in C^1[0, 1]`, 且存在 `a in [0, 1]` 使得 `f(a) = 0`, 则
  <span class="formula">
    `int_0^1 f(x)^2 dx le 1/2 int_0^1 f'(x)^2 dx`.
  </span>
  注: 根据积分中值定理, `f(a) = 0` 的条件也可以换成 `int_0^1 f(x) dx = 0`.
</p>

<p class="proof">
  [来自群友 Egregium, 澄]
  由 Newton-Leibniz 公式有
  <span class="formula">
    `int_a^x f'(t) dt = f(x)`, `quad x in [0, 1]`.
  </span>
  而 `x in [a, 1]` 时, Cauchy 不等式告诉我们
  <span class="formula">
    `f(x)^2`
    `= (int_a^x f'(t) dt)^2`
    `le int_a^x 1^2 dt int_a^x f'(t)^2 dt`
    `le |x-a| int_0^1 f'(t)^2 dt`.
  </span>
  `x in [0, a]` 时, 把上式积分限中的 `x` 和 `a` 对调, 结论不变.
  最后两边对 `x` 在 `[0, 1]` 上积分即得结论.
</p>

<p class="remark">
  假如 `f` 满足齐次边界条件 `f(0) = f(2pi) = 0`,
  记 `L(f, f', x) = f(x)^2 - f'(x)^2`,
  则 `int_0^(2pi) L(f, f', x) dx` 的极值可以由 Euler-Lagrange 方程求解:
  极值条件是 `L = f'(del L)/(del f') = c`,
  即 `f(x)^2 + f'(x)^2 = c^2`.
  通解为 `f(x) = c sin(x + varphi)`,
  代入边界条件知道 `f(x) = c sin x`.
</p>

<script src="../../js/note.js?type="></script>
<script src="../../js/plot.js"></script>
<script src="../../js/ui.js"></script>
<script>
const { exp, log } = Math

new Plot('img-exp-approx')
  .geometry({xmin: -2, xmax: 2, ymin: -0.1, ymax: 5}).axis()
  .plot(exp)
  .plot(x => 1+x, { color: 'grey' })
  .plot(x => 1/(1-x), { color: 'grey' })

new Plot('img-log-approx')
  .geometry({xmin: -0.1, xmax: 5, ymin: -2, ymax: 2}).axis()
  .plot(log, { continuity: 1e5 })
  .plot(x => 1-1/x, { color: 'grey' })
  .plot(x => x-1, { color: 'grey' })

new Plot('img-lambert-w')
  .geometry({xmin: -0.5, xmax: 5, ymin: -5, ymax: 2}).axis()
  .plot(t => t*exp(t), t => t, {min:-5.5, max:2})
  .plot(t => -1, {color: 'grey'})

const plotBernoulli = new Plot('img-bernoulli')
const range = new Range('img-bernoulli-range', {
  min: 0,
  max: 3,
  step: 0.05,
  defaultValue: 0.5,
  onChange: a => {
    range.setLabel('a = ' + a)
    plotBernoulli.clear()
      .geometry({ xmin: -1, xmax: 5, ymin: -1, ymax: 5 }).axis()
      .plot(x => (1+x)**a)
      .plot(x => 1+a*x, {color: 'grey'})
  }
})

new Plot('img-x-pow-x-approx')
  .geometry({xmin: -0.5, xmax: 4, ymin: -2, ymax: 2}).axis()
  .plot(x => x*log(x))
  .plot(x => x-1, {color: 'grey'})
  .plot(x => x * exp(-x) - 2 * exp(-1), {color: 'red'})
</script>
</body>
</html>
