<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>å¤å…¸å¯†ç </title>
  <link rel="stylesheet" href="../../css/note.css">
<style>
body {
  max-width: unset;
}
/* é€šç”¨ */
.align-center {
  display: flex;
  align-items: center;
  gap: 8px;
}
.inline-block {
  display: inline-block;
}

/* ç›²æ–‡ */
.braille-input {
  display: inline-block;
  width: 4.5em;
}
.braille-dot {
  display: inline-block;
  height: 2em;
  width: 2em;
  border-radius: 50%;
  border: 1px solid #aaa;
  cursor: pointer;
  transition: 0.2s background;
}
.braille-display {
  text-align: center;
  font-size: 1.5em;
}
.braille-dot.filled {
  background: #555;
}

/* æ——è¯­ */
.flag-input {
  display: inline-block;
  width: 8em;
}
.flag-direction,
.flag-center {
  display: inline-block;
  height: 2em;
  width: 2em;
  vertical-align: middle;
  margin: 0.2em;
}
.flag-direction {
  border-radius: 0.2em;
  border: 1px solid #333;
  cursor: pointer;
  transition: 0.2s background;
  text-align: center;
  line-height: 2em;
}
.flag-direction.filled {
  background: #555;
}
/* çŒªåœˆ */
@font-face {
  font-family: "hogpen";
  src: url("../../font/pigpass-font.woff") format("woff");
}
#hogpen-playground textarea,
#table-hogpen td:nth-child(2n) {
  font-family: "hogpen";
}

/* tabs */
.tabs {
  background: #181818;
}
.tabs .tabs-body {
  height: 700px;
}
.tabs .tabs-footer {
  border-left-color: #181818;
}
.tabs .tabs-body-item pre {
  background-color: rgba(0,0,0,0.2);
}

/* lens */
#lens-canvas {
  width: 100%;
  height: calc(100% - 40px);
  background: #333;
}
</style>
</head>
<body class="dark">

<div class="tabs">
  <div class="tabs-body">
    <div id="tabs-a1z26" class="tabs-body-item">
      <table id="table-a1z26" class="col2"></table>

      <div class="playground" type="textarea" value="sleep" value2="19 12 5 5 16">

      <p>è¯´æ˜: è¾“å…¥è‹±æ–‡, è½¬ä¸ºæ•°å­—; è¾“å…¥ç©ºæ ¼åˆ†éš”çš„æ•°å­—, è½¬ä¸ºè‹±æ–‡.</p>
      <script type="text">
      module.exports = function a1z26 (str) {
        if (/[a-zA-Z]/.test(str)) {
          return [...str].map(c => puzzle.convert(c, { from: 'char', to: 'number' })).join(' ')
        }
        return str.split(/[^0-9]/).map(n => puzzle.convert(Number(n), { from: 'number', to: 'char' })).join('')
      }
      </script>
      </div>
      <p class="remark">äºŒè¿›åˆ¶å­—æ¯åºç¼–ç åˆå«åŸ¹æ ¹å¯†ç , ä½¿ç”¨ 5 ä¸ª bit è¡¨ç¤ºä¸€ä¸ªå­—æ¯.</p>
    </div>
    <div id="tabs-morse" class="tabs-body-item">
      <table id="table-morse" class="col2"></table>

      <div class="playground" type="textarea" value="-- --- .-. ... .
-.-. --- -.. ." value2="morse code">

      <p>è¯´æ˜: è¾“å…¥è‹±æ–‡, è½¬ä¸ºæ‘©æ–¯ç ; è¾“å…¥æ‘©æ–¯ç , è½¬ä¸ºè‹±æ–‡.</p>
      <script type="text">
      module.exports = function morse (str) {
        if (/[a-zA-Z]/.test(str)) {
          return str.split(/\s+/).map(line => [...line].filter(c => /[a-zA-Z]/.test(c)).map(c => puzzle.convert(c, { from: 'char', to: 'morse' })).join('/')).join('\n')
        }
        return str.split('\n').map(line => line.split(/[^-_.]+/).map(m => puzzle.convert(m, { from: 'morse', to: 'char' })).join('')).join(' ')
      }
      </script>
      </div>
    </div>
    <div id="tabs-nato" class="tabs-body-item">
      <table id="table-nato" class="col2"></table>
    </div>
    <div id="tabs-cellphone" class="tabs-body-item">
      <table id="table-cellphone" class="col2">
        <caption>æ‰‹æœºä¹é”®ç¼–ç </caption>
        <tr>
          <td><p>1</p><p>-</p></td>
          <td><p>2</p><p>ABC</p></td>
          <td><p>3</p><p>DEF</p></td>
        </tr>
        <tr>
          <td><p>4</p><p>GHI</p></td>
          <td><p>5</p><p>JKL</p></td>
          <td><p>6</p><p>MNO</p></td>
        </tr>
        <tr>
          <td><p>7</p><p>PQRS</p></td>
          <td><p>8</p><p>TUV</p></td>
          <td><p>9</p><p>WXYZ</p></td>
        </tr>
      </table>

      <div class="playground" type="textarea" value="233253537142636232" value2="cellphone">

      <p>è¯´æ˜: è¾“å…¥è‹±æ–‡, è½¬ä¸ºæ‰‹æœºä¹é”®ç¼–ç ; è¾“å…¥æ‰‹æœºä¹é”®ç¼–ç , è½¬ä¸ºè‹±æ–‡.</p>
      <script type="text">
      module.exports = function cellphone (str) {
        if (/[a-zA-Z]/.test(str)) {
          return [...str].map(c => puzzle.convert(c, { from: 'char', to: 'cellphone' })).join('')
        }

        // split into 2-chunks
        const buf = puzzle.utils.chunk(str.replace(/\s/g, ''), 2)
        return buf.map(c => puzzle.convert(c, { from: 'cellphone', to: 'char' })).join('')
      }
      </script>
      </div>
    </div>
    <div id="tabs-flag" class="tabs-body-item">
      <table id="table-flag" class="col2"></table>

      <div class="playground" type="textarea" value="â†“â†’â†™â†—â†™â†“â†“â†˜" value2="flag">

      <p>è¯´æ˜: è¾“å…¥è‹±æ–‡, è½¬ä¸ºæ——è¯­; è¾“å…¥æ——è¯­, è½¬ä¸ºè‹±æ–‡</p>
      <div class="flag-input">
        <div class="flag-direction">â†–</div>
        <div class="flag-direction">â†‘</div>
        <div class="flag-direction">â†—</div>
        <div class="flag-direction">â†</div>
        <div class="flag-center"></div>
        <div class="flag-direction">â†’</div>
        <div class="flag-direction">â†™</div>
        <div class="flag-direction">â†“</div>
        <div class="flag-direction">â†˜</div>
      </div>
      <div class="inline-block">
        <p class="flag-display"></p>
        <input class="flag-input-btn" type="button" value="æ’å…¥" />
      </div>
      <script type="text">
      const $input = container.querySelector('.flag-input')
      const $btn = container.querySelector('.flag-input-btn')
      const $display = container.querySelector('.flag-display')
      const $textarea = container.querySelector('textarea')
      $input.char = ''
      $input.value = []
      $input.onclick = e => {
        if (!e.target.classList.contains('flag-direction')) return
        if ($input.value.length === 2) {
          [...container.querySelectorAll('.flag-direction')].forEach(el => el.classList.remove('filled'))
          $input.value.length = 0
        }
        e.target.classList.toggle('filled')
        const char = e.target.textContent
        $input.char = char
        $input.value.push(char)
        $display.textContent = flag($input.value.join(''))
      }
      $btn.onclick = () => {
        const helper = new puzzle.InputHelper($textarea)
        helper.insert($input.value.join(''))
      }
      function flag (str) {
        if (/[\u2190-\u2193\u2196-\u2199]/.test(str)) {
          const buf = puzzle.utils.chunk(str, 2)
          return buf.map(c => puzzle.convert(c, { from: 'flag', to: 'char' })).join('')
        }
        return [...str].map(c => puzzle.convert(c, { from: 'char', to: 'flag' })).join('')
      }
      module.exports = flag
      </script>
      </div>
    </div>
    <div id="tabs-braille" class="tabs-body-item">
      <table id="table-braille" class="col2"></table>

      <div class="playground" type="textarea" value="â ƒâ —â â Šâ ‡â ‡â ‘" value2="braille">

      <p>è¯´æ˜: è¾“å…¥è‹±æ–‡, è½¬ä¸ºç›²æ–‡; è¾“å…¥ç›²æ–‡, è½¬ä¸ºè‹±æ–‡</p>
      <div class="braille-input">
        <div class="braille-dot" data-index="0"></div>
        <div class="braille-dot" data-index="3"></div>
        <div class="braille-dot" data-index="1"></div>
        <div class="braille-dot" data-index="4"></div>
        <div class="braille-dot" data-index="2"></div>
        <div class="braille-dot" data-index="5"></div>
      </div>
      <div class="inline-block">
        <p class="braille-display"></p>
        <input class="braille-input-btn" type="button" value="æ’å…¥" />
      </div>
      <script type="text">
      const $input = container.querySelector('.braille-input')
      const $btn = container.querySelector('.braille-input-btn')
      const $display = container.querySelector('.braille-display')
      const $textarea = container.querySelector('textarea')
      $input.value = 0
      $input.onclick = e => {
        const { chr } = puzzle.utils
        if (!e.target.classList.contains('braille-dot')) return
        e.target.classList.toggle('filled')
        const index = e.target.getAttribute('data-index')
        $input.value ^= 1 << Number(index)
        const code = chr(0x2800 + $input.value)
        $display.textContent = braille(code)
      }
      $btn.onclick = () => {
        const { chr } = puzzle.utils
        const helper = new puzzle.InputHelper($textarea)
        const code = chr(0x2800 + $input.value)
        helper.insert(code)
      }
      function braille (str) {
        if (/[\u2800-\u28ff]/.test(str)) {
          return [...str].map(c => puzzle.convert(c, { from: 'braille', to: 'char' })).join('')
        }
        return [...str].map(c => puzzle.convert(c, { from: 'char', to: 'braille' })).join('')
      }
      module.exports = braille
      </script>
      </div>
    </div>
    <div id="tabs-hogpen" class="tabs-body-item">
      <table id="table-hogpen" class="col2"></table>

      [å‚è€ƒ <a href="https://blog.csdn.net/weixin_47869330/article/details/111396033" target="_blank">CSDN</a>]
      <div id="hogpen-playground" class="playground" type="textarea" value="hogpen">
      <script type="text">
      module.exports = function hogpen (str) {
        return str
      }
      </script>
      </div>
    </div>
    <div id="tabs-caesar" class="tabs-body-item">
      <div class="playground" type="textarea" value="Sleep">

      <p>è¯´æ˜: å¯¹æ‰€æœ‰è‹±æ–‡å­—æ¯è¿›è¡Œç›¸åŒçš„å¹³ç§». æ¯”å¦‚ A â†’ C, B â†’ D, ..., Y â†’ A, Z â†’ B.</p>
      <script type="text">
      module.exports = function caesar (str) {
        const { chr, ord } = puzzle.utils
        return Array.from({ length: 25 }).map((_, i) => {
          return String(i + 1).padStart(2, '0') + '. ' + [...str].map(c => {
            if (/[a-z]/.test(c)) return chr((ord(c) - 96 + i) % 26 + 97)
            if (/[A-Z]/.test(c)) return chr((ord(c) - 64 + i) % 26 + 65)
            return c
          }).join('')
        }).join('\n')
      }
      </script>
      </div>
    </div>
    <div id="tabs-fence" class="tabs-body-item">
      <div class="playground" type="textarea" value="tlrreelcntoattwsheee">
      <p>è¯´æ˜: æŠŠæ–‡å­—å†™æˆçŸ©é˜µ, ç„¶åå¯¹çŸ©é˜µè¿›è¡Œè½¬ç½®. å˜æ¢çš„ç»“æœå–å†³äºçŸ©é˜µçš„å®½åº¦.</p>
      <div class="align-center">
        <span>å®½åº¦:</span>
        <input class="input" type="number" value="4" min="1" />
      </div>
      <script type="text">
      const $input = container.querySelector('.input')
      const $run = container.querySelector('input[type=button]')
      $input.oninput = e => {
        $run.click()
      }
      module.exports = function fence (str) {
        const arr = [...str]
        const buf = []
        const width = $input.value
        const lines = arr.length / width
        for (let j = 0; j < width; ++j) {
           for (let i = 0; i < lines; ++i) {
              const c = arr[i * width + j]
              if (c) buf.push(c)
           }
           buf.push('\n')
        }
        return buf.join('')
      }
      </script>
      </div>
    </div>
    <div id="tabs-reverse" class="tabs-body-item">
      <div class="playground" type="textarea" value="Able was I ere I saw Elba">
      <p>è¯´æ˜: åè½¬æ–‡æœ¬
      </p>
      <script type="text">
      module.exports = function reverse (str) {
        return [...str].reverse().join('')
      }
      </script>
      </div>
    </div>
    <div id="tabs-vigenere" class="tabs-body-item">
      <p>ç”¨ P è¡¨ç¤ºæ˜æ–‡ (plaintext), C è¡¨ç¤ºå¯†æ–‡ (cipher text), E è¡¨ç¤ºåŠ å¯† (encrypt), D è¡¨ç¤ºè§£å¯† (decrypt),
        K è¡¨ç¤ºå¯†é’¥ (key). ç»´å‰å°¼äºšå¯†ç æ˜¯ä¸€ç§å¯¹ç§°åŠ å¯†, å¯ä»¥è¡¨ç¤ºä¸º
        <span class="formula">
          `C = E(P, K)`,<br>
          `P = D(C, K)`.
        </span>
        å…¶ä¸­æ˜æ–‡ã€å¯†æ–‡ä¸å¯†é’¥éƒ½åªå« 26 ä¸ªè‹±æ–‡å­—æ¯, ä»¥ `A mapsto 0`, `Z mapsto 25` çš„æ–¹å¼å¯¹åº”åˆ°æ•°å­—.
        æˆ‘ä»¬å‡å®šå¯†é’¥ä¸æ˜æ–‡æ˜¯ä¸€æ ·é•¿çš„, å¦‚æœå¯†é’¥å¤ªçŸ­, åˆ™é€šè¿‡é‡å¤çš„æ–¹å¼ä½¿å®ƒä»¬ä¸€æ ·é•¿.
        ç»´å‰å°¼äºšçš„åŠ å¯†ã€è§£å¯†ç®—æ³•å®šä¹‰ä¸º:
        <span class="formula">
          `C_i = E(P_i, K_i) = (P_i + K_i) mod 26`,<br>
          `P_i = D(C_i, K_i) = (C_i - K_i) mod 26`.
        </span>
      </p>

      <div class="playground" type="textarea" value="vpxz giaxiv wpubtt mj pwi zitwzt">
      <div class="align-center">
        <span>å¯†é’¥:</span>
        <input id="input-vigenere" class="input" type="text" value="cipher"/>
        <label class="align-center">è§£å¯†
          <input id="decode-vigenere" name="radio-vigenere" type="radio" value="decode" checked />
        </label>
        <label class="align-center">åŠ å¯†
          <input id="encode-vigenere" name="radio-vigenere" type="radio" value="encode" />
        </label>
      </div>
      <script type="text">
      module.exports = function vigenere (plaintext) {
        const { chr, ord } = puzzle.utils
        const $input = $('#input-vigenere')
        const isDecode = $('#decode-vigenere').checked
        const key = [...$input.value.toLowerCase()].map(c => ord(c) - 97)
        let i = 0
        return [...plaintext.toLowerCase()].map(c => {
          const code = ord(c)
          if (code >= 97 && code <= 122) {
            let k = key[i]
            if (isDecode) k = -k
            i = (i + 1) % key.length
            return chr((code + 26 - 97 + k) % 26 + 97)
          } else {
            return c
          }
        }).join('')
      }
      </script>
      </div>
    </div>
    <div id="tabs-lens" class="tabs-body-item">
      <canvas id="lens-canvas"></canvas>
      <label>
        <input type="radio" name="lens-radio" value="0" checked> R
      </label>
      <label>
        <input type="radio" name="lens-radio" value="1"> G
      </label>
      <label>
        <input type="radio" name="lens-radio" value="2"> B
      </label>
      <input id="lens-file" type="file" accept="image/*" />
      <script type="module" defer>
      const canvas = $('#lens-canvas')
      const ctx = canvas.getContext('2d', { willReadFrequently: true })
      const image = {}
      const lens = { x: 0, y: 0, w: 550, h: 400 }
      const mouse = { x: 0, y: 0 }
      let channel = 0

      const updateLens = (x, y) => {
      }

      const init = (img) => {
        const draggable = draggableCanvas({
          canvas,
          ctx,
          onMouseDown ({ x, y }) {
            mouse.x = x
            mouse.y = y
            lens.x0 = lens.x
            lens.y0 = lens.y
          },
          onMouseMove ({ x, y }) {
            lens.x = lens.x0 + x - mouse.x
            lens.y = lens.y0 + y - mouse.y
            update()
          },
        })

        const r1 = img.width / img.height
        const r2 = canvas.width / canvas.height
        let x, y, w, h
        if (r1 < r2) { // å›¾ç‰‡æ¯”è¾ƒç˜¦
          h = canvas.height | 0
          w = h * r1 | 0
          y = 0
          x = (canvas.width - w) / 2 | 0
        } else { // å›¾ç‰‡æ¯”è¾ƒèƒ–
          w = canvas.width | 0
          h = w / r1 | 0
          x = 0
          y = (canvas.height - h) / 2 | 0
        }
        Object.assign(image, { img, x, y, w, h })

        lens.w = w
        lens.h = h
        lens.x = (canvas.width / 2 - lens.w / 2) | 0
        lens.y = (canvas.height / 2 - lens.h / 2) | 0
        update()
      }

      const update = () => {
        ctx.drawImage(image.img, image.x, image.y, image.w, image.h)
        const imageData = ctx.getImageData(lens.x, lens.y, lens.w, lens.h)
        const { data } = imageData
        for (let i = 0; i < data.length; i += 4) {
          if (channel !== 0) data[i] = 0
          if (channel !== 1) data[i+1] = 0
          if (channel !== 2) data[i+2] = 0
        }
        ctx.putImageData(imageData, lens.x, lens.y)
      }

      document.querySelector('#lens-file').onchange = (e) => {
        const file = e.target.files[0]
        if (!file) return
        const reader = new FileReader()
        const img = new Image()
        reader.readAsDataURL(file)
        reader.onload = function () {
          img.src = this.result
        }
        img.onload = () => {
          init(img)
        }
      }

      ;[...document.querySelectorAll('input[name=lens-radio]')].forEach(radio => {
        radio.onchange = (e) => {
          channel = parseInt(e.target.value)
          update()
        }
      })
      </script>
    </div>
  </div>
  <div class="tabs-footer">
    <a class="tabs-footer-item active" href="#tabs-a1z26">å­—æ¯åº A1Z26</a>
    <a class="tabs-footer-item" href="#tabs-morse">æ‘©æ–¯ morse</a>
    <a class="tabs-footer-item" href="#tabs-nato">åŒ—çº¦å­—æ¯ nato</a>
    <a class="tabs-footer-item" href="#tabs-cellphone">æ‰‹æœºé”®ç›˜ cellphone</a>
    <a class="tabs-footer-item" href="#tabs-flag">æ——è¯­ flag</a>
    <a class="tabs-footer-item" href="#tabs-braille">ç›²æ–‡ braille</a>
    <a class="tabs-footer-item" href="#tabs-hogpen">çŒªåœˆ hogpen</a>
    <a class="tabs-footer-item" href="#tabs-caesar">å‡¯æ’’ caesar</a>
    <a class="tabs-footer-item" href="#tabs-fence">æ …æ  fence</a>
    <a class="tabs-footer-item" href="#tabs-reverse">å€’åº reverse</a>
    <a class="tabs-footer-item" href="#tabs-vigenere">ç»´å‰å°¼äºš VigenÃ¨re</a>
    <a class="tabs-footer-item" href="#tabs-lens">é€é•œ lens</a>

    <!-- å®ç”¨å·¥å…· -->

    <a class="tabs-footer-item" href="http://nutrimatic.org/" target="_blank" title="è§£å­—æ¯ä¹±åº anagram">nutrimaticğŸ”—</a>
    <a class="tabs-footer-item" href="http://quipqiup.com/" target="_blank" title="è§£å•è¡¨å¯†ç ">quipqiupğŸ”—</a>
    <a class="tabs-footer-item" href="https://www.guballa.de/vigenere-solver" target="_blank" title="æ— å¯†é’¥è§£ç»´å‰å°¼äºš">vigenere-solverğŸ”—</a>
  </div>
</div>

<script src="../../js/note.js"></script>
<script src="../../js/playground.js"></script>
<script src="../../js/puzzle/classic.js"></script>
<script src="../../js/drag-canvas.js"></script>
<script>
function $ (...args) {
  return document.querySelector(...args)
}

const init = () => {
  const { chr } = puzzle.utils
  puzzle.renderTable($('#table-a1z26'), puzzle.makeTable(i => i + 1), 'å­—æ¯åº')
  puzzle.renderTable($('#table-braille'), puzzle.makeTable(i => puzzle.data.brailleStr[i]), 'ç›²æ–‡')
  puzzle.renderTable($('#table-morse'), puzzle.makeTable(i => puzzle.data.morseArr[i]), 'æ‘©æ–¯')
  puzzle.renderTable($('#table-nato'), puzzle.makeTable(i => puzzle.data.natoArr[i]), 'åŒ—çº¦å­—æ¯')
  puzzle.renderTable($('#table-flag'), puzzle.makeTable(i => puzzle.data.flagArr[i]), 'æ——è¯­')
  puzzle.renderTable($('#table-hogpen'), puzzle.makeTable(i => chr(97 + i)), 'çŒªåœˆå¯†ç ')
}

init()
</script>
</body>
</html>
